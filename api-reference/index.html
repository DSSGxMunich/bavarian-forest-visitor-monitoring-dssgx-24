
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dssgxmunich.github.io/bavarian-forest-visitor-monitoring-dssgx-24/api-reference/">
      
      
        <link rel="prev" href="../open-issues/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.35">
    
    
      
        <title>API Reference - Docs for the Bavarian Forest National Park Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Docs for the Bavarian Forest National Park Project" class="md-header__button md-logo" aria-label="Docs for the Bavarian Forest National Park Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docs for the Bavarian Forest National Park Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Docs for the Bavarian Forest National Park Project" class="md-nav__button md-logo" aria-label="Docs for the Bavarian Forest National Park Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Docs for the Bavarian Forest National Park Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-factsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Factsheet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../approach/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Our Approach
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Our Approach
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../approach/data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 1: Data Sourcing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../approach/prediction-pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 2: Building the Prediction Pipeline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../approach/user-frontends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 3: Building the User Frontends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../findings-and-results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Findings and Final Product
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations-and-challenges/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discussion and Recommendations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Dashboard.create_dashboard_main_page" class="md-nav__link">
    <span class="md-ellipsis">
      create_dashboard_main_page
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Dashboard.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“" class="md-nav__link">
    <span class="md-ellipsis">
      Admin_ðŸ”“
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“.get_latest_parking_data_and_visualize_it" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_parking_data_and_visualize_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“.get_visitor_predictions_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_predictions_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.add_spatial_info_to_parking_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      add_spatial_info_to_parking_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.merge_all_df_from_list" class="md-nav__link">
    <span class="md-ellipsis">
      merge_all_df_from_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_and_preprocess_forecasted_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_preprocess_forecasted_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_and_preprocess_realtime_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_preprocess_realtime_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_parking_data_from_cloud" class="md-nav__link">
    <span class="md-ellipsis">
      source_parking_data_from_cloud
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_forecast_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data.process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data.impute_missing_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data.process_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check" class="md-nav__link">
    <span class="md-ellipsis">
      data_quality_check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.convert_sensor_dictionary_to_excel_file" class="md-nav__link">
    <span class="md-ellipsis">
      convert_sensor_dictionary_to_excel_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.convert_sensor_excel_file_to_dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      convert_sensor_excel_file_to_dictionary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.int_for_all_counts" class="md-nav__link">
    <span class="md-ellipsis">
      int_for_all_counts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.parse_german_dates" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking" class="md-nav__link">
    <span class="md-ellipsis">
      parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.calculate_color" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_color
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.get_fixed_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_fixed_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.get_parking_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.password" class="md-nav__link">
    <span class="md-ellipsis">
      password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.password.check_password" class="md-nav__link">
    <span class="md-ellipsis">
      check_password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.visitor_count.visitor_prediction_graph" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_prediction_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      data_retrieval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.convert_number_to_month_name" class="md-nav__link">
    <span class="md-ellipsis">
      convert_number_to_month_name
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.create_temporal_columns" class="md-nav__link">
    <span class="md-ellipsis">
      create_temporal_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.extract_values_according_to_type" class="md-nav__link">
    <span class="md-ellipsis">
      extract_values_according_to_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_data_from_query" class="md-nav__link">
    <span class="md-ellipsis">
      get_data_from_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_parking_data_for_selected_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_data_for_selected_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_queried_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_queried_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_sensors_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensors_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_visitor_centers_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_centers_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.parse_german_dates_regex" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates_regex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download" class="md-nav__link">
    <span class="md-ellipsis">
      download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download.list_files_in_s3" class="md-nav__link">
    <span class="md-ellipsis">
      list_files_in_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.pandas_profiling_styling" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_profiling_styling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box" class="md-nav__link">
    <span class="md-ellipsis">
      query_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.generate_queries" class="md-nav__link">
    <span class="md-ellipsis">
      generate_queries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_parking" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_centers" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_visitor_centers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_visitor_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_query_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_query_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_category" class="md-nav__link">
    <span class="md-ellipsis">
      select_category
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_date" class="md-nav__link">
    <span class="md-ellipsis">
      select_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_filters" class="md-nav__link">
    <span class="md-ellipsis">
      select_filters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download" class="md-nav__link">
    <span class="md-ellipsis">
      query_viz_and_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download.get_visualization_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visualization_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload.generate_file_name" class="md-nav__link">
    <span class="md-ellipsis">
      generate_file_name
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.language_selection_menu" class="md-nav__link">
    <span class="md-ellipsis">
      language_selection_menu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.other_information" class="md-nav__link">
    <span class="md-ellipsis">
      other_information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.other_information.get_other_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_other_information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.page_layout_config" class="md-nav__link">
    <span class="md-ellipsis">
      page_layout_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.page_layout_config.get_page_layout" class="md-nav__link">
    <span class="md-ellipsis">
      get_page_layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking" class="md-nav__link">
    <span class="md-ellipsis">
      parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.calculate_color_based_on_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_color_based_on_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_fixed_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_fixed_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_occupancy_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_occupancy_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_parking_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.render_occupancy_bar" class="md-nav__link">
    <span class="md-ellipsis">
      render_occupancy_bar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.recreational_activities" class="md-nav__link">
    <span class="md-ellipsis">
      recreational_activities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.recreational_activities.get_recreation_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_recreation_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.visitor_count.get_visitor_counts_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_counts_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather" class="md-nav__link">
    <span class="md-ellipsis">
      weather
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.find_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      find_peaks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.get_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.get_weather_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_weather_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_historical_data_for_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="md-nav__link">
    <span class="md-ellipsis">
      process_all_locations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_visitor_count.source_historic_visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_preprocessed_hourly_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_preprocessed_hourly_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.get_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.process_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays" class="md-nav__link">
    <span class="md-ellipsis">
      features_zscoreweather_distanceholidays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_daily_max_values" class="md-nav__link">
    <span class="md-ellipsis">
      add_daily_max_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_moving_z_scores" class="md-nav__link">
    <span class="md-ellipsis">
      add_moving_z_scores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_nearest_holiday_distance" class="md-nav__link">
    <span class="md-ellipsis">
      add_nearest_holiday_distance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.slice_at_first_non_null" class="md-nav__link">
    <span class="md-ellipsis">
      slice_at_first_non_null
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      check_missing_data_per_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_occupancy_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      save_higher_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter" class="md-nav__link">
    <span class="md-ellipsis">
      join_sensor_weather_visitorcenter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="md-nav__link">
    <span class="md-ellipsis">
      create_datetimeindex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.get_joined_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_joined_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.join_dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      join_dataframes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_historic_visitor_count_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.calculate_traffic_metrics_abs" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_traffic_metrics_abs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_and_impute_times" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_impute_times
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_non_replaced_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      correct_non_replaced_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_overlapping_sensor_data" class="md-nav__link">
    <span class="md-ellipsis">
      correct_overlapping_sensor_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.fix_columns_names" class="md-nav__link">
    <span class="md-ellipsis">
      fix_columns_names
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.merge_columns" class="md-nav__link">
    <span class="md-ellipsis">
      merge_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.parse_german_dates" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data.process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_center_processing_script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      create_inference_dfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs.load_latest_models" class="md-nav__link">
    <span class="md-ellipsis">
      load_latest_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs.predict_with_models" class="md-nav__link">
    <span class="md-ellipsis">
      predict_with_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_inference_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features.join_inference_data" class="md-nav__link">
    <span class="md-ellipsis">
      join_inference_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features.source_preprocess_inference_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_preprocess_inference_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.run_inference" class="md-nav__link">
    <span class="md-ellipsis">
      run_inference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.run_inference.run_inference" class="md-nav__link">
    <span class="md-ellipsis">
      run_inference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_feature_selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.change_datatypes" class="md-nav__link">
    <span class="md-ellipsis">
      change_datatypes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.filter_features_for_modelling" class="md-nav__link">
    <span class="md-ellipsis">
      filter_features_for_modelling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.get_regionwise_IN_and_OUT_columns" class="md-nav__link">
    <span class="md-ellipsis">
      get_regionwise_IN_and_OUT_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.merge_new_features" class="md-nav__link">
    <span class="md-ellipsis">
      merge_new_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.process_transformations" class="md-nav__link">
    <span class="md-ellipsis">
      process_transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm" class="md-nav__link">
    <span class="md-ellipsis">
      train_lstm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.build_lstm_model" class="md-nav__link">
    <span class="md-ellipsis">
      build_lstm_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.create_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      create_sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.save_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.split_features_targets" class="md-nav__link">
    <span class="md-ellipsis">
      split_features_targets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.split_train_test" class="md-nav__link">
    <span class="md-ellipsis">
      split_train_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      train_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.training_pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      training_pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor" class="md-nav__link">
    <span class="md-ellipsis">
      train_regressor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.create_uuid" class="md-nav__link">
    <span class="md-ellipsis">
      create_uuid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.save_models_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      save_models_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.save_predictions_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      save_predictions_to_aws_s3
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Dashboard.create_dashboard_main_page" class="md-nav__link">
    <span class="md-ellipsis">
      create_dashboard_main_page
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Dashboard.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“" class="md-nav__link">
    <span class="md-ellipsis">
      Admin_ðŸ”“
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“.get_latest_parking_data_and_visualize_it" class="md-nav__link">
    <span class="md-ellipsis">
      get_latest_parking_data_and_visualize_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pages.Admin_ðŸ”“.get_visitor_predictions_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_predictions_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.add_spatial_info_to_parking_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      add_spatial_info_to_parking_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.merge_all_df_from_list" class="md-nav__link">
    <span class="md-ellipsis">
      merge_all_df_from_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_and_preprocess_forecasted_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_preprocess_forecasted_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_and_preprocess_realtime_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_preprocess_realtime_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_parking_data_from_cloud" class="md-nav__link">
    <span class="md-ellipsis">
      source_parking_data_from_cloud
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.source_data.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_forecast_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_forecast_weather_data.process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data.impute_missing_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.process_real_time_parking_data.process_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check" class="md-nav__link">
    <span class="md-ellipsis">
      data_quality_check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.convert_sensor_dictionary_to_excel_file" class="md-nav__link">
    <span class="md-ellipsis">
      convert_sensor_dictionary_to_excel_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.convert_sensor_excel_file_to_dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      convert_sensor_excel_file_to_dictionary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.int_for_all_counts" class="md-nav__link">
    <span class="md-ellipsis">
      int_for_all_counts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pre_processing.data_quality_check.parse_german_dates" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking" class="md-nav__link">
    <span class="md-ellipsis">
      parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.calculate_color" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_color
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.get_fixed_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_fixed_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.parking.get_parking_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.password" class="md-nav__link">
    <span class="md-ellipsis">
      password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.password.check_password" class="md-nav__link">
    <span class="md-ellipsis">
      check_password
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.admin.visitor_count.visitor_prediction_graph" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_prediction_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      data_retrieval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.convert_number_to_month_name" class="md-nav__link">
    <span class="md-ellipsis">
      convert_number_to_month_name
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.create_temporal_columns" class="md-nav__link">
    <span class="md-ellipsis">
      create_temporal_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.extract_values_according_to_type" class="md-nav__link">
    <span class="md-ellipsis">
      extract_values_according_to_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_data_from_query" class="md-nav__link">
    <span class="md-ellipsis">
      get_data_from_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_parking_data_for_selected_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_data_for_selected_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_queried_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_queried_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_sensors_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensors_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_visitor_centers_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_centers_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.parse_german_dates_regex" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates_regex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download" class="md-nav__link">
    <span class="md-ellipsis">
      download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download.list_files_in_s3" class="md-nav__link">
    <span class="md-ellipsis">
      list_files_in_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.download.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.pandas_profiling_styling" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_profiling_styling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box" class="md-nav__link">
    <span class="md-ellipsis">
      query_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.generate_queries" class="md-nav__link">
    <span class="md-ellipsis">
      generate_queries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_parking" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_centers" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_visitor_centers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      get_queries_for_visitor_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_query_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_query_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_category" class="md-nav__link">
    <span class="md-ellipsis">
      select_category
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_date" class="md-nav__link">
    <span class="md-ellipsis">
      select_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_filters" class="md-nav__link">
    <span class="md-ellipsis">
      select_filters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download" class="md-nav__link">
    <span class="md-ellipsis">
      query_viz_and_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download.get_visualization_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visualization_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload" class="md-nav__link">
    <span class="md-ellipsis">
      upload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload.generate_file_name" class="md-nav__link">
    <span class="md-ellipsis">
      generate_file_name
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.data_accessibility.upload.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.language_selection_menu" class="md-nav__link">
    <span class="md-ellipsis">
      language_selection_menu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.other_information" class="md-nav__link">
    <span class="md-ellipsis">
      other_information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.other_information.get_other_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_other_information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.page_layout_config" class="md-nav__link">
    <span class="md-ellipsis">
      page_layout_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.page_layout_config.get_page_layout" class="md-nav__link">
    <span class="md-ellipsis">
      get_page_layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking" class="md-nav__link">
    <span class="md-ellipsis">
      parking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.calculate_color_based_on_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_color_based_on_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_fixed_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_fixed_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_occupancy_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_occupancy_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.get_parking_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_parking_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.parking.render_occupancy_bar" class="md-nav__link">
    <span class="md-ellipsis">
      render_occupancy_bar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.recreational_activities" class="md-nav__link">
    <span class="md-ellipsis">
      recreational_activities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.recreational_activities.get_recreation_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_recreation_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.visitor_count.get_visitor_counts_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_visitor_counts_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather" class="md-nav__link">
    <span class="md-ellipsis">
      weather
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.find_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      find_peaks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.get_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.streamlit_app.pages_in_dashboard.visitors.weather.get_weather_section" class="md-nav__link">
    <span class="md-ellipsis">
      get_weather_section
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_historical_data_for_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="md-nav__link">
    <span class="md-ellipsis">
      process_all_locations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_visitor_count.source_historic_visitor_count" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_visitor_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_real_time_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_preprocessed_hourly_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_preprocessed_hourly_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.get_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.process_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_weather.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays" class="md-nav__link">
    <span class="md-ellipsis">
      features_zscoreweather_distanceholidays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_daily_max_values" class="md-nav__link">
    <span class="md-ellipsis">
      add_daily_max_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_moving_z_scores" class="md-nav__link">
    <span class="md-ellipsis">
      add_moving_z_scores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_nearest_holiday_distance" class="md-nav__link">
    <span class="md-ellipsis">
      add_nearest_holiday_distance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.slice_at_first_non_null" class="md-nav__link">
    <span class="md-ellipsis">
      slice_at_first_non_null
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      check_missing_data_per_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_occupancy_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      save_higher_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter" class="md-nav__link">
    <span class="md-ellipsis">
      join_sensor_weather_visitorcenter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="md-nav__link">
    <span class="md-ellipsis">
      create_datetimeindex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.get_joined_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_joined_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.join_dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      join_dataframes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_historic_visitor_count_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.calculate_traffic_metrics_abs" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_traffic_metrics_abs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_and_impute_times" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_impute_times
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_non_replaced_sensors" class="md-nav__link">
    <span class="md-ellipsis">
      correct_non_replaced_sensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_overlapping_sensor_data" class="md-nav__link">
    <span class="md-ellipsis">
      correct_overlapping_sensor_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.fix_columns_names" class="md-nav__link">
    <span class="md-ellipsis">
      fix_columns_names
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.merge_columns" class="md-nav__link">
    <span class="md-ellipsis">
      merge_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.parse_german_dates" class="md-nav__link">
    <span class="md-ellipsis">
      parse_german_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_visitor_center_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.preprocess_weather_data.process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_center_processing_script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      create_inference_dfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs.load_latest_models" class="md-nav__link">
    <span class="md-ellipsis">
      load_latest_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.create_inference_dfs.predict_with_models" class="md-nav__link">
    <span class="md-ellipsis">
      predict_with_models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_inference_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features.join_inference_data" class="md-nav__link">
    <span class="md-ellipsis">
      join_inference_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.preprocess_inference_features.source_preprocess_inference_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_preprocess_inference_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.run_inference" class="md-nav__link">
    <span class="md-ellipsis">
      run_inference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.run_inference.run_inference" class="md-nav__link">
    <span class="md-ellipsis">
      run_inference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_feature_selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.change_datatypes" class="md-nav__link">
    <span class="md-ellipsis">
      change_datatypes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.filter_features_for_modelling" class="md-nav__link">
    <span class="md-ellipsis">
      filter_features_for_modelling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.get_regionwise_IN_and_OUT_columns" class="md-nav__link">
    <span class="md-ellipsis">
      get_regionwise_IN_and_OUT_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.merge_new_features" class="md-nav__link">
    <span class="md-ellipsis">
      merge_new_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.source_and_feature_selection.process_transformations" class="md-nav__link">
    <span class="md-ellipsis">
      process_transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm" class="md-nav__link">
    <span class="md-ellipsis">
      train_lstm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.build_lstm_model" class="md-nav__link">
    <span class="md-ellipsis">
      build_lstm_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.create_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      create_sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.save_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.split_features_targets" class="md-nav__link">
    <span class="md-ellipsis">
      split_features_targets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.split_train_test" class="md-nav__link">
    <span class="md-ellipsis">
      split_train_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      train_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_lstm.training_pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      training_pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor" class="md-nav__link">
    <span class="md-ellipsis">
      train_regressor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.create_uuid" class="md-nav__link">
    <span class="md-ellipsis">
      create_uuid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.save_models_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      save_models_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.modeling.train_regressor.save_predictions_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      save_predictions_to_aws_s3
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api-reference">API Reference</h1>
<!-- Code in General -->

<!-- Streamlit Dashboard -->



<div class="doc doc-object doc-module">



<a id="Dashboard"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="Dashboard.create_dashboard_main_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_dashboard_main_page</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates the dashboard page for the Bavarian Forest National Park visitor information. This includes the visitor count, parking, weather, recreation, and other information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>inference_predictions</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inference predictions for region-wise visitor counts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>Dashboard.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_dashboard_main_page</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the dashboard page for the Bavarian Forest National Park visitor information. This includes the visitor count, parking, weather, recreation, and other information.</span>

<span class="sd">    Args:</span>
<span class="sd">        inference_predictions (pd.DataFrame): The inference predictions for region-wise visitor counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>

        <span class="c1"># Display the logo and title of the column</span>
        <span class="n">logo</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;src/streamlit_app/assets/logo-bavarian-forest-national-park.png&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>

        <span class="c1"># Get the visitor count section</span>
        <span class="n">visitor_count</span><span class="o">.</span><span class="n">get_visitor_counts_section</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">)</span>

        <span class="c1"># get the parking section</span>
        <span class="n">parking</span><span class="o">.</span><span class="n">get_parking_section</span><span class="p">()</span>


    <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
        <span class="c1"># get the language selection menu</span>
        <span class="n">lang_sel_menu</span><span class="o">.</span><span class="n">get_language_selection_menu</span><span class="p">()</span>

        <span class="c1"># get the weather section</span>
        <span class="n">weather</span><span class="o">.</span><span class="n">get_weather_section</span><span class="p">()</span>


        <span class="c1"># create recreational section</span>
        <span class="n">recreation</span><span class="o">.</span><span class="n">get_recreation_section</span><span class="p">()</span>

        <span class="c1"># Get the other information section</span>
        <span class="n">other_info</span><span class="o">.</span><span class="n">get_other_information</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="Dashboard.run_training" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_training</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Runs the training pipeline. This includes sourcing and preprocessing the data, training the model, and saving the model.</p>

            <details class="quote">
              <summary>Source code in <code>Dashboard.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_training</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the training pipeline. This includes sourcing and preprocessing the data, training the model, and saving the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># source and preprocess the historic visitor count data</span>
    <span class="n">sourced_visitor_count_df</span> <span class="o">=</span> <span class="n">source_historic_visitor_count</span><span class="p">()</span>
    <span class="n">processed_visitor_count_df</span> <span class="o">=</span> <span class="n">preprocess_visitor_count_data</span><span class="p">(</span><span class="n">sourced_visitor_count_df</span><span class="p">)</span>

    <span class="c1"># source and preprocess the visitor center data</span>
    <span class="n">sourced_vc_data_df</span> <span class="o">=</span> <span class="n">source_visitor_center_data</span><span class="p">()</span>
    <span class="n">processed_vc_df_hourly</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">process_visitor_center_data</span><span class="p">(</span><span class="n">sourced_vc_data_df</span><span class="p">)</span>

     <span class="c1"># get the weather data for training and inference</span>
    <span class="c1"># training data</span>
    <span class="n">train_start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">train_end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
    <span class="n">weather_data</span> <span class="o">=</span> <span class="n">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="n">train_start_date</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">train_end_date</span><span class="p">)</span>
    <span class="n">processed_weather_df</span> <span class="o">=</span> <span class="n">process_weather_data</span><span class="p">(</span><span class="n">weather_data</span><span class="p">)</span>

    <span class="c1"># join the dataframes</span>
    <span class="n">joined_df</span> <span class="o">=</span> <span class="n">get_joined_dataframe</span><span class="p">(</span><span class="n">processed_weather_df</span><span class="p">,</span> <span class="n">processed_visitor_count_df</span><span class="p">,</span> <span class="n">processed_vc_df_hourly</span><span class="p">)</span>

    <span class="c1"># Feature engineering: add features such as zscore weather features and nearest holidays</span>
    <span class="n">weather_columns_for_zscores</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;Temperature (Â°C)&#39;</span><span class="p">,</span><span class="s1">&#39;Relative Humidity (%)&#39;</span><span class="p">,</span><span class="s1">&#39;Wind Speed (km/h)&#39;</span><span class="p">]</span>
    <span class="n">with_zscores_and_nearest_holidays_df</span> <span class="o">=</span> <span class="n">get_zscores_and_nearest_holidays</span><span class="p">(</span><span class="n">joined_df</span><span class="p">,</span> <span class="n">weather_columns_for_zscores</span><span class="p">)</span>

    <span class="c1"># get the features for training</span>
    <span class="n">feature_df</span> <span class="o">=</span> <span class="n">get_features</span><span class="p">(</span><span class="n">with_zscores_and_nearest_holidays_df</span><span class="p">,</span><span class="n">train_start_date</span><span class="p">,</span> <span class="n">train_end_date</span><span class="p">)</span>

    <span class="c1"># train the model</span>
    <span class="n">train_regressor</span><span class="p">(</span><span class="n">feature_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="pages.Admin_ðŸ”“"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="pages.Admin_ðŸ”“.get_latest_parking_data_and_visualize_it" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_latest_parking_data_and_visualize_it</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Display the parking section of the dashboard with a map showing the real-time parking occupancy 
and interactive metrics with actual numbers of visitors. It will update every 15 minutes.</p>

            <details class="quote">
              <summary>Source code in <code>pages/Admin_ðŸ”“.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="s2">&quot;15min&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_latest_parking_data_and_visualize_it</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display the parking section of the dashboard with a map showing the real-time parking occupancy </span>
<span class="sd">    and interactive metrics with actual numbers of visitors. It will update every 15 minutes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rendering parking section for the visitor dashboard...&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_current_15min_interval</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current 15-minute interval in the format &quot;HH:MM:00&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The current 15-minute interval in the format &quot;HH:MM:00&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Europe/Berlin&#39;</span><span class="p">))</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_time</span><span class="o">.</span><span class="n">minute</span> <span class="o">//</span> <span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="mi">15</span>

        <span class="c1"># Replace the minute value with the truncated value and set seconds and microseconds to 0</span>
        <span class="n">timestamp_latest_parking_data_fetch</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="n">minutes</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># If you want to format it as a string in the &quot;%Y-%m-%d %H:%M:%S&quot; format</span>
        <span class="n">timestamp_latest_parking_data_fetch_str</span> <span class="o">=</span> <span class="n">timestamp_latest_parking_data_fetch</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">timestamp_latest_parking_data_fetch_str</span>

    <span class="n">timestamp_latest_parking_data_fetch</span> <span class="o">=</span> <span class="n">get_current_15min_interval</span><span class="p">()</span>

    <span class="c1"># Source and preprocess the parking data</span>
    <span class="n">processed_parking_data</span> <span class="o">=</span> <span class="n">source_and_preprocess_realtime_parking_data</span><span class="p">(</span><span class="n">timestamp_latest_parking_data_fetch</span><span class="p">)</span>

    <span class="n">get_parking_section</span><span class="p">(</span><span class="n">processed_parking_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pages.Admin_ðŸ”“.get_visitor_predictions_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_visitor_predictions_section</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Build the visitor predictions section by running/loading the inference pipeline and displaying the predictions in actual number of visitors.</p>

            <details class="quote">
              <summary>Source code in <code>pages/Admin_ðŸ”“.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_visitor_predictions_section</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build the visitor predictions section by running/loading the inference pipeline and displaying the predictions in actual number of visitors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">preprocessed_hourly_visitor_center_data</span> <span class="o">=</span> <span class="n">source_preprocessed_hourly_visitor_center_data</span><span class="p">()</span>

    <span class="n">inference_predictions</span> <span class="o">=</span> <span class="n">run_inference</span><span class="p">(</span><span class="n">preprocessed_hourly_visitor_center_data</span><span class="p">)</span>

    <span class="n">visitor_prediction_graph</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Streamlit: Sourcing & Preprocessing -->



<div class="doc doc-object doc-module">



<a id="src.streamlit_app.source_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.add_spatial_info_to_parking_sensors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_spatial_info_to_parking_sensors</span><span class="p">(</span><span class="n">parking_data_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add spatial information to the parking dataframe.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>parking_data_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing parking sensor data (occupancy, capacity, occupancy rate).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>parking_data_df</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing parking sensor data with spatial information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_spatial_info_to_parking_sensors</span><span class="p">(</span><span class="n">parking_data_df</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add spatial information to the parking dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        parking_data_df (pd.DataFrame): DataFrame containing parking sensor data (occupancy, capacity, occupancy rate).</span>

<span class="sd">    Returns:</span>
<span class="sd">        parking_data_df (pd.DataFrame): DataFrame containing parking sensor data with spatial information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">location_slug</span> <span class="ow">in</span> <span class="n">parking_sensors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">location_slug</span> <span class="ow">in</span> <span class="n">parking_data_df</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">parking_data_df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parking_sensors</span><span class="p">[</span><span class="n">location_slug</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">parking_data_df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parking_sensors</span><span class="p">[</span><span class="n">location_slug</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">parking_data_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.merge_all_df_from_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_all_df_from_list</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Merge all the dataframes in the list into a single dataframe.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df_list</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of pandas DataFrames to merge.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>merged_dataframe</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The merged DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_all_df_from_list</span><span class="p">(</span><span class="n">df_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge all the dataframes in the list into a single dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_list (list): A list of pandas DataFrames to merge.</span>

<span class="sd">    Returns:</span>
<span class="sd">        merged_dataframe (pd.DataFrame): The merged DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Merge all the dataframes in the list with the &#39;time&#39; column as index</span>
    <span class="n">merged_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">merged_dataframe</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.source_and_preprocess_forecasted_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_and_preprocess_forecasted_weather_data</span><span class="p">(</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source and preprocess the forecasted weather data for the Bavarian Forest National Park.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>timestamp_latest_weather_data_fetch</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timestamp of the latest weather data fetch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>sourced_and_preprocessed_weather_data</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed forecasted weather dataframe</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">source_and_preprocess_forecasted_weather_data</span><span class="p">(</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="p">:</span> <span class="n">datetime</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source and preprocess the forecasted weather data for the Bavarian Forest National Park.</span>

<span class="sd">    Args:</span>
<span class="sd">        timestamp_latest_weather_data_fetch (datetime): The timestamp of the latest weather data fetch.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sourced_and_preprocessed_weather_data (pd.DataFrame): Processed forecasted weather dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sourcing and preprocessing weather data from Meteostat API at </span><span class="si">{</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="c1"># Source the weather data</span>
    <span class="n">weather_data_df</span> <span class="o">=</span> <span class="n">source_weather_data</span><span class="p">(</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="p">)</span>

    <span class="c1"># Preprocess the weather data</span>
    <span class="n">sourced_and_preprocessed_weather_data</span> <span class="o">=</span> <span class="n">prfwd</span><span class="o">.</span><span class="n">process_weather_data</span><span class="p">(</span><span class="n">weather_data_df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sourced_and_preprocessed_weather_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.source_and_preprocess_realtime_parking_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_and_preprocess_realtime_parking_data</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source and preprocess the real-time parking data. Returns the timestamp of when the function was run.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>current_timestamp</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timestamp of when the function was run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>processed_parking_data</code></td>            <td>
                  <code><span title="pandas.DataFram">DataFram</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessed real-time parking data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">source_and_preprocess_realtime_parking_data</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source and preprocess the real-time parking data. Returns the timestamp of when the function was run.</span>

<span class="sd">    Args:</span>
<span class="sd">        current_timestamp (datetime): The timestamp of when the function was run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        processed_parking_data (pd.DataFram): Preprocessed real-time parking data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetching and saving real-time parking occupancy data at &#39;</span><span class="si">{</span><span class="n">current_timestamp</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>

    <span class="c1"># Source the parking data from bayern cloud</span>
    <span class="n">all_parking_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">location_slug</span> <span class="ow">in</span> <span class="n">parking_sensors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetching and saving real-time occupancy data for location &#39;</span><span class="si">{</span><span class="n">location_slug</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">parking_df</span> <span class="o">=</span> <span class="n">source_parking_data_from_cloud</span><span class="p">(</span><span class="n">location_slug</span><span class="p">)</span>
        <span class="n">all_parking_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parking_df</span><span class="p">)</span>

    <span class="n">all_parking_data</span> <span class="o">=</span> <span class="n">merge_all_df_from_list</span><span class="p">(</span><span class="n">all_parking_dataframes</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parking data sourced successfully!&quot;</span><span class="p">)</span>

    <span class="c1"># Preprocess the parking data</span>
    <span class="n">processed_parking_data</span> <span class="o">=</span> <span class="n">prtpd</span><span class="o">.</span><span class="n">process_real_time_parking_data</span><span class="p">(</span><span class="n">all_parking_data</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parking data processed and cleaned!&quot;</span><span class="p">)</span>

    <span class="c1"># Return the timestamp in German time indicating the time zone Berlin</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parking data processed and cleaned at </span><span class="si">{</span><span class="n">current_timestamp</span><span class="si">}</span><span class="s2">, Europe/Berlin time.&quot;</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;parking_data_last_updated&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">current_timestamp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">processed_parking_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.source_parking_data_from_cloud" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_parking_data_from_cloud</span><span class="p">(</span><span class="n">location_slug</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Sources the current occupancy data from the Bayern Cloud API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>location_slug</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The location slug of the parking sensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>parking_df_with_spatial_info</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing the current occupancy data, occupancy rate, capacity and spatial coordinates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_parking_data_from_cloud</span><span class="p">(</span><span class="n">location_slug</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sources the current occupancy data from the Bayern Cloud API.</span>

<span class="sd">    Args:</span>
<span class="sd">        location_slug (str): The location slug of the parking sensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        parking_df_with_spatial_info (pd.DataFrame): A DataFrame containing the current occupancy data, occupancy rate, capacity and spatial coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">API_endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://data.bayerncloud.digital/api/v4/endpoints/list_occupancy/</span><span class="si">{</span><span class="n">location_slug</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="n">request_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">BAYERN_CLOUD_API_KEY</span>
    <span class="p">}</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">API_endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_params</span><span class="p">)</span>
    <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="c1"># Access the first item in the @graph list</span>
    <span class="n">graph_item</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s2">&quot;@graph&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Extract the current occupancy and capacity</span>
    <span class="n">current_occupancy</span> <span class="o">=</span> <span class="n">graph_item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dcls:currentOccupancy&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">current_capacity</span> <span class="o">=</span> <span class="n">graph_item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dcls:currentCapacity&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">current_occupancy_rate</span> <span class="o">=</span> <span class="n">graph_item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dcls:currentOccupancyRate&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Make a dataframe with the three values and the current time stamp in the datetime format</span>
    <span class="n">parking_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> 
        <span class="s2">&quot;location&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">location_slug</span><span class="p">],</span>
        <span class="s2">&quot;current_occupancy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">current_occupancy</span><span class="p">],</span>
        <span class="s2">&quot;current_capacity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">current_capacity</span><span class="p">],</span>
        <span class="s2">&quot;current_occupancy_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">current_occupancy_rate</span><span class="p">],</span>
    <span class="p">})</span>

    <span class="n">parking_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># adding spatial information to the dataframe</span>
    <span class="n">parking_df_with_spatial_info</span> <span class="o">=</span> <span class="n">add_spatial_info_to_parking_sensors</span><span class="p">(</span><span class="n">parking_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parking_df_with_spatial_info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.source_data.source_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source forecasted weather data from the Meteostat API for the Bavarian Forest National Park in the next 7 days in hourly intervals.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>start_time</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start time of the weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>weather_hourly</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hourly weather data for the Bavarian Forest National Park for the next 7 days</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/source_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source forecasted weather data from the Meteostat API for the Bavarian Forest National Park in the next 7 days in hourly intervals.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time (datetime): The start time of the weather data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        weather_hourly (pd.DataFrame): Hourly weather data for the Bavarian Forest National Park for the next 7 days</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create a Point object for the Bavarian Forest National Park entry</span>
    <span class="n">bavarian_forest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">LATITUDE</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">LONGITUDE</span><span class="p">)</span>

    <span class="c1"># Convert start_time to datetime format in utc</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">pytz</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Add 7 days to start_time</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

    <span class="c1"># Fetch hourly data for the location</span>
    <span class="n">weather_hourly</span> <span class="o">=</span> <span class="n">get_hourly_data</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

    <span class="c1"># Drop unnecessary columns</span>
    <span class="n">weather_hourly</span> <span class="o">=</span> <span class="n">weather_hourly</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">,</span> <span class="s1">&#39;snow&#39;</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">,</span> <span class="s1">&#39;wpgt&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="s1">&#39;coco&#39;</span><span class="p">,</span><span class="s1">&#39;prcp&#39;</span><span class="p">,</span> <span class="s1">&#39;tsun&#39;</span><span class="p">])</span>

    <span class="c1"># Convert the &#39;Time&#39; column to datetime format again in Europe/Berlin time</span>
    <span class="n">weather_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">weather_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;Europe/Berlin&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">weather_hourly</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pre_processing.process_forecast_weather_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.process_forecast_weather_data.fill_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill missing values in the weather data using linear interpolation or zero values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>parameters</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>data</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with missing values filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/process_forecast_weather_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill missing values in the weather data using linear interpolation or zero values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame): Processed hourly weather data.</span>
<span class="sd">        parameters (list): List of column names to process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        data (pd.DataFrame): DataFrame with missing values filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
        <span class="c1"># Calculate missing values and their percentage</span>
        <span class="n">missing_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">missing_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Calculate zero values and their percentage</span>
        <span class="n">zero_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">zero_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">zero_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Check for missing values in the &#39;Time&#39; column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">and</span> <span class="n">missing_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in Time column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please check the missing values in the Time column&#39;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">missing_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">zero_percentage</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                <span class="c1"># Fill missing values with 0.0 if zero values are significant</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zero values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">zero_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled with 0.0&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use linear interpolation to fill missing values</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># Round the interpolated values to 2 decimal places</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled using linear interpolation&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.process_forecast_weather_data.process_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_weather_data</span><span class="p">(</span><span class="n">weather_data_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process the hourly weather data by filling missing values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>weather_data_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>imputed_data</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed weather data with missing values filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/process_forecast_weather_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_weather_data</span><span class="p">(</span><span class="n">weather_data_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the hourly weather data by filling missing values.</span>

<span class="sd">    Args:</span>
<span class="sd">        weather_data_df (pandas.DataFrame): Hourly weather data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        imputed_data (pandas.DataFrame): Processed weather data with missing values filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># Get the list of columns to process</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">weather_data_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Processing weather data with the following columns: </span><span class="si">{</span><span class="n">parameters</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Fill missing values in the weather data</span>
    <span class="n">imputed_data</span> <span class="o">=</span> <span class="n">fill_missing_values</span><span class="p">(</span><span class="n">weather_data_df</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">imputed_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pre_processing.process_real_time_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.process_real_time_parking_data.impute_missing_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">impute_missing_data</span><span class="p">(</span><span class="n">all_parking_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Impute missing values in the parking data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>all_parking_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw parking data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>all_parking_data</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed parking data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/process_real_time_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">impute_missing_data</span><span class="p">(</span><span class="n">all_parking_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impute missing values in the parking data.</span>

<span class="sd">    Args:</span>
<span class="sd">        all_parking_data (pandas.DataFrame): Raw parking data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        all_parking_data (pandas.DataFrame): Processed parking data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Fill missing values in the parking data</span>

    <span class="c1"># if there are null values in the capacity column, fill them with the with 40 (it is the lowest capacity value from all the sensors)</span>
    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># if there are null values in the occupancy column, fill them with the corresponding capacity value</span>
    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># if there are null values in the occupancy rate column, fill them with the occupancy divided by the capacity   </span>
    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1"># Convert to data type int</span>

    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># add a column called &#39;current availability&#39; that is the difference between the capacity and the occupancy</span>

    <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_availability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">all_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">all_parking_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.process_real_time_parking_data.process_real_time_parking_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_real_time_parking_data</span><span class="p">(</span><span class="n">parking_data_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process the real-time parking data by imputing missing values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>parking_data_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw real-time parking data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>clean_parking_data</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed real-time parking data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/process_real_time_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_real_time_parking_data</span><span class="p">(</span><span class="n">parking_data_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the real-time parking data by imputing missing values.</span>

<span class="sd">    Args:</span>
<span class="sd">        parking_data_df (pandas.DataFrame): Raw real-time parking data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        clean_parking_data (pandas.DataFrame): Processed real-time parking data.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">clean_parking_data</span> <span class="o">=</span> <span class="n">impute_missing_data</span><span class="p">(</span><span class="n">parking_data_df</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parking data processed and cleaned!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">clean_parking_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pre_processing.data_quality_check"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.data_quality_check.convert_sensor_dictionary_to_excel_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_sensor_dictionary_to_excel_file</span><span class="p">(</span><span class="n">sensor_dict</span><span class="p">,</span> <span class="n">output_file_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert sensor dictionary to a Pandas Dataframe and save it as an Excel file.</p>
<p>Info: This function is not used as of now, but might be useful in the future for handling changes to the sensor configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sensor_dict</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing sensor data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the output Excel file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/data_quality_check.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_sensor_dictionary_to_excel_file</span><span class="p">(</span>
        <span class="n">sensor_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">output_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert sensor dictionary to a Pandas Dataframe and save it as an Excel file.</span>

<span class="sd">    Info: This function is not used as of now, but might be useful in the future for handling changes to the sensor configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        sensor_dict (dict): A dictionary containing sensor data.</span>
<span class="sd">        output_file_path (str): The path to the output Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sensor_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sensor_directions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">possible_sensor_ids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">sensors</span> <span class="ow">in</span> <span class="n">sensor_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">sensor_name</span><span class="p">,</span> <span class="n">directions</span> <span class="ow">in</span> <span class="n">sensors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sensor_ids</span> <span class="ow">in</span> <span class="n">directions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
                <span class="n">sensor_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sensor_name</span><span class="p">)</span>
                <span class="n">sensor_directions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
                <span class="c1"># Join the list into a comma-separated string</span>
                <span class="n">possible_sensor_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sensor_ids</span><span class="p">))</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">regions</span><span class="p">,</span>
        <span class="s2">&quot;sensor_name&quot;</span><span class="p">:</span> <span class="n">sensor_names</span><span class="p">,</span>
        <span class="s2">&quot;sensor_direction&quot;</span><span class="p">:</span> <span class="n">sensor_directions</span><span class="p">,</span>
        <span class="s2">&quot;possible_sensor_ids&quot;</span><span class="p">:</span> <span class="n">possible_sensor_ids</span>
    <span class="p">})</span>

    <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.data_quality_check.convert_sensor_excel_file_to_dictionary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_sensor_excel_file_to_dictionary</span><span class="p">(</span><span class="n">sensor_file_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert Excel file containing sensor configuration data to a dictionary.</p>
<p>Info: This function is not used as of now, but might be useful in the future for handling changes to the sensor configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sensor_file_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the Excel file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing sensor configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/data_quality_check.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_sensor_excel_file_to_dictionary</span><span class="p">(</span>
        <span class="n">sensor_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert Excel file containing sensor configuration data to a dictionary.</span>

<span class="sd">    Info: This function is not used as of now, but might be useful in the future for handling changes to the sensor configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        sensor_file_path (str): The path to the Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing sensor configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">sensor_file_path</span><span class="p">)</span>

    <span class="n">sensor_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span>
        <span class="n">sensor_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sensor_name&quot;</span><span class="p">]</span>
        <span class="n">sensor_direction</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sensor_direction&quot;</span><span class="p">]</span>
        <span class="n">possible_sensor_ids</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;possible_sensor_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">region</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sensor_dict</span><span class="p">:</span>
            <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">sensor_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">]:</span>
            <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">sensor_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">sensor_direction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">sensor_name</span><span class="p">]:</span>
            <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">sensor_name</span><span class="p">][</span><span class="n">sensor_direction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">sensor_dict</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">sensor_name</span><span class="p">][</span><span class="n">sensor_direction</span><span class="p">]</span> <span class="o">=</span> <span class="n">possible_sensor_ids</span>

    <span class="k">return</span> <span class="n">sensor_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.data_quality_check.int_for_all_counts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">int_for_all_counts</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert all numeric columns in the DataFrame to integer type. Round float values that are not integers,
and replace NaN values with 0 to allow conversion to integers.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/data_quality_check.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">int_for_all_counts</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert all numeric columns in the DataFrame to integer type. Round float values that are not integers,</span>
<span class="sd">    and replace NaN values with 0 to allow conversion to integers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Loop through each column in the dataframe</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="c1"># Check if the column is of float type</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;float64&quot;</span><span class="p">:</span>
            <span class="c1"># Apply the transformation only to non-NaN values</span>
            <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
            <span class="c1"># Replace NaN values with 0 or another placeholder, then convert to integer</span>
            <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pre_processing.data_quality_check.parse_german_dates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_german_dates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">date_column_name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses German dates in the specified date column of the DataFrame using regex,
including hours and minutes if available.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>date_column_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame with parsed German dates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pre_processing/data_quality_check.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_german_dates</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses German dates in the specified date column of the DataFrame using regex,</span>
<span class="sd">    including hours and minutes if available.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame containing the date column.</span>
<span class="sd">        date_column_name (str): The name of the date column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame with parsed German dates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define a mapping of German month names to their numeric values</span>
    <span class="n">month_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Jan.&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Feb.&quot;</span><span class="p">:</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MÃ¤rz&quot;</span><span class="p">:</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Apr.&quot;</span><span class="p">:</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mai&quot;</span><span class="p">:</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juni&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juli&quot;</span><span class="p">:</span> <span class="s2">&quot;07&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Aug.&quot;</span><span class="p">:</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sep.&quot;</span><span class="p">:</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Okt.&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nov.&quot;</span><span class="p">:</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dez.&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">}</span>

    <span class="c1"># Create a regex pattern for replacing months and capturing time</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d{1,2})\.\s*(&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">month_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)\s*(\d</span><span class="si">{4}</span><span class="s1">)\s*(\d</span><span class="si">{2}</span><span class="s1">):(\d</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Function to replace the month in the matched string and keep the time part</span>
    <span class="k">def</span> <span class="nf">replace_month</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">month_map</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">minute</span><span class="si">}</span><span class="s2">:00&quot;</span>

    <span class="c1"># Apply regex replacement and convert to datetime</span>
        <span class="c1"># Apply regex replacement and convert to datetime, only for string values</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">replace_month</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Streamlit: Admin Page -->



<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.admin.parking"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.admin.parking.calculate_color" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_color</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the color of the marker based on the occupancy rate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>occupancy_rate</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The occupancy rate of the parking section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of RGB values representing the color of the marker.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/admin/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_color</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the color of the marker based on the occupancy rate.</span>

<span class="sd">    Args:</span>
<span class="sd">        occupancy_rate (float): The occupancy rate of the parking section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of RGB values representing the color of the marker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">occupancy_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">230</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">39</span><span class="p">]</span> <span class="c1">#red</span>

    <span class="k">elif</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">244</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span> <span class="c1">#yellow</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">109</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1">#green</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.admin.parking.get_fixed_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fixed_size</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a fixed size value for the map markers.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/admin/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fixed_size</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a fixed size value for the map markers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">300</span>  
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.admin.parking.get_parking_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parking_section</span><span class="p">(</span><span class="n">processed_parking_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Display the parking section of the dashboard with a map showing the real-time parking occupancy 
and interactive metrics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>processed_parking_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed parking data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/admin/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_parking_section</span><span class="p">(</span>
        <span class="n">processed_parking_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Display the parking section of the dashboard with a map showing the real-time parking occupancy </span>
<span class="sd">    and interactive metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        processed_parking_data (pd.DataFrame): Processed parking data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;real_time_parking_occupancy&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set a fixed size for all markers</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_fixed_size</span><span class="p">()</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_color</span><span class="p">)</span>

    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>  <span class="c1"># Convert to float</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>


    <span class="c1"># Calculate center of the map based on the average of latitudes and longitudes</span>
    <span class="n">avg_latitude</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">avg_longitude</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># PyDeck Map Configuration with adjusted view_state</span>
    <span class="n">view_state</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">ViewState</span><span class="p">(</span>
        <span class="n">latitude</span><span class="o">=</span><span class="n">avg_latitude</span><span class="p">,</span>  <span class="c1"># Center map at the average latitude</span>
        <span class="n">longitude</span><span class="o">=</span><span class="n">avg_longitude</span><span class="p">,</span>  <span class="c1"># Center map at the average longitude</span>
        <span class="n">zoom</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Zoom level increased for a closer view</span>
        <span class="n">pitch</span><span class="o">=</span><span class="mi">50</span>
    <span class="p">)</span>

    <span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
        <span class="s2">&quot;ScatterplotLayer&quot;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">processed_parking_data</span><span class="p">,</span>
        <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span>
        <span class="n">get_radius</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="n">get_fill_color</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">deck</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Deck</span><span class="p">(</span>
        <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">layer</span><span class="p">],</span>
        <span class="n">initial_view_state</span><span class="o">=</span><span class="n">view_state</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{location}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;available_spaces&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{current_availability}</span><span class="s2"> ðŸš—</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{current_occupancy_rate}</span><span class="s2">%&quot;</span>
        <span class="p">},</span>  <span class="c1"># Updated tooltip text with two decimal points for occupancy rate</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;road&quot;</span>
    <span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">pydeck_chart</span><span class="p">(</span><span class="n">deck</span><span class="p">)</span>

    <span class="c1"># Interactive Metrics</span>
    <span class="n">selected_location</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_parking_section&#39;</span><span class="p">],</span> 
        <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;selectbox_parking_section&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Display selected location details</span>
    <span class="k">if</span> <span class="n">selected_location</span><span class="p">:</span>
        <span class="n">selected_data</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_location</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">col1</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;available_spaces&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;current_availability&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ðŸš—&quot;</span><span class="p">)</span>
        <span class="n">col2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;capacity&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ðŸš—&quot;</span><span class="p">)</span>
        <span class="n">col3</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.admin.password"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.admin.password.check_password" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_password</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns <code>True</code> if the user had the correct password.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/admin/password.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_password</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns `True` if the user had the correct password.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">password_entered</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks whether a password entered by the user is correct.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">],</span> <span class="n">st</span><span class="o">.</span><span class="n">secrets</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]):</span>
            <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;password_correct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">del</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span>  <span class="c1"># Don&#39;t store the password.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">[</span><span class="s2">&quot;password_correct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Return True if the password is validated.</span>
    <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;password_correct&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Show input for password.</span>
    <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span>
        <span class="s2">&quot;Password&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="n">on_change</span><span class="o">=</span><span class="n">password_entered</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;password&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;password_correct&quot;</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ðŸ˜• Password incorrect&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.admin.visitor_count"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.admin.visitor_count.visitor_prediction_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visitor_prediction_graph</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the visitor counts section with the highest occupancy rate.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/admin/visitor_count.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span>
<span class="k">def</span> <span class="nf">visitor_prediction_graph</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the visitor counts section with the highest occupancy rate.</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;## </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_counts_forecasted&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># do a dropdown for the all_preds</span>
    <span class="n">regions_to_select</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">selected_region</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_region&#39;</span><span class="p">],</span> <span class="n">regions_to_select</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selected_region</span><span class="p">:</span>

        <span class="n">predictions_per_region</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">selected_region</span><span class="p">]</span>
        <span class="n">further_columns_to_show</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;day_date&quot;</span><span class="p">]</span>

        <span class="c1"># Filter the DataFrame based on the selected region</span>
        <span class="n">selected_region_predictions</span> <span class="o">=</span> <span class="n">inference_predictions</span><span class="p">[</span><span class="n">predictions_per_region</span> <span class="o">+</span> <span class="n">further_columns_to_show</span><span class="p">]</span>

        <span class="c1"># Get unique values for the day and date list</span>
        <span class="n">days_list</span> <span class="o">=</span> <span class="n">selected_region_predictions</span><span class="p">[</span><span class="s1">&#39;day_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># Add a note that this is forecasted data</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[*</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;forecasted_visitor_data&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">*].&quot;</span><span class="p">)</span>

        <span class="c1"># Create a layout for the radio button and chart</span>
        <span class="n">col1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

        <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
            <span class="c1"># Get radio button for selecting the day</span>
            <span class="n">day_selected</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_day&#39;</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="n">days_list</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>

        <span class="c1"># Extract the selected day for filtering (using date)</span>
        <span class="n">day_df</span> <span class="o">=</span> <span class="n">selected_region_predictions</span><span class="p">[</span><span class="n">selected_region_predictions</span><span class="p">[</span><span class="s1">&#39;day_date&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">day_selected</span><span class="p">]</span>

        <span class="c1"># Plot an interactive bar chart for relative traffic</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">day_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>  
            <span class="n">y</span><span class="o">=</span><span class="n">predictions_per_region</span><span class="p">,</span>
            <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;traffic_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="s1">&#39;Hour of Day&#39;</span><span class="p">},</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_foot_traffic_for_day&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">day_selected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Customize hover text for relative traffic</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                <span class="s1">&#39;Traffic: %</span><span class="si">{y}</span><span class="s1">&lt;br&gt;&#39;</span>  <span class="c1"># Display the traffic value</span>
                <span class="s1">&#39;Hour: %{x|%H:%M}&lt;br&gt;&#39;</span>  <span class="c1"># Display the hour in HH:MM format</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">weekly_max_value_per_region</span> <span class="o">=</span> <span class="n">selected_region_predictions</span><span class="p">[</span><span class="n">predictions_per_region</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="c1"># Update layout for relative traffic chart</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">weekly_max_value_per_region</span><span class="p">])</span>  <span class="c1"># Set y-axis to range from 0 to the max traffic value of the forecasted week for a region</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Keep the x-axis tick labels visible</span>

        <span class="n">fig1</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Hide the x-axis title</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Hide the y-axis title</span>
            <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span><span class="p">,</span>
            <span class="n">legend_title_text</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_foot_traffic&#39;</span><span class="p">],</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">itemsizing</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span>
                <span class="n">traceorder</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Position the legend below the chart</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span>  <span class="c1"># Center the legend horizontally</span>
            <span class="p">),</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;%H:%M&#39;</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Display the interactive bar chart for relative traffic below the radio button</span>
        <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Streamlit: Data Access Page -->



<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.convert_number_to_month_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_number_to_month_name</span><span class="p">(</span><span class="n">month</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a month number (1-12) to its corresponding month name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>month</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The month number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the month.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_number_to_month_name</span><span class="p">(</span><span class="n">month</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a month number (1-12) to its corresponding month name.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        month (int): The month number.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The name of the month.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">month_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;July&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;August&#39;</span><span class="p">,</span> 
                   <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;September&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;October&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;November&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;December&#39;</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">month_dict</span><span class="p">[</span><span class="n">month</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.create_temporal_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_temporal_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create temporal columns from the DataFrame index.</p>
<p>This function takes a DataFrame with a datetime index and creates additional
columns for month names, year, and season based on the index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input DataFrame with a datetime index.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The original DataFrame with added columns:
- 'month': The name of the month corresponding to the index.
- 'year': The year extracted from the index.
- 'season': The name of the season corresponding to the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the index of the DataFrame cannot be converted to datetime.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_temporal_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create temporal columns from the DataFrame index.</span>

<span class="sd">    This function takes a DataFrame with a datetime index and creates additional</span>
<span class="sd">    columns for month names, year, and season based on the index.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input DataFrame with a datetime index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The original DataFrame with added columns:</span>
<span class="sd">            - &#39;month&#39;: The name of the month corresponding to the index.</span>
<span class="sd">            - &#39;year&#39;: The year extracted from the index.</span>
<span class="sd">            - &#39;season&#39;: The name of the season corresponding to the index.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the index of the DataFrame cannot be converted to datetime.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># make a new column called &#39;month&#39; from the index</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>

    <span class="c1"># convert the numbers in the months column to the month names from the</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_number_to_month_name</span><span class="p">)</span>

    <span class="c1"># make a new column called &#39;year&#39; from the index</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>

    <span class="c1"># make a new column called &#39;season&#39; from the index</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="o">%</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span>
    <span class="c1"># convert the numbers in the season column to the season names</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_number_to_season_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.extract_values_according_to_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_values_according_to_type</span><span class="p">(</span><span class="n">selected_query</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extract values from a query string based on the specified query type.</p>
<p>This function uses regular expressions to extract relevant values from the 
<code>selected_query</code> string according to the specified <code>type</code>. The extracted values
may include properties, sensors, dates, months, seasons, and years, depending on the type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selected_query</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The selected query string from which to extract values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the query. Options include:
- 'type1': Query for date range.
- 'type2': Query for month and year.
- 'type3': Query for season and year.
- 'type4': Query for date range (weather category).
- 'type5': Query for month and year (weather category).
- 'type6': Query for season and year (weather category).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the extracted values, where keys are based on
  the field names specified in <code>query_types</code>, including:
  - 'property'
  - 'sensor'
  - 'month'
  - 'season'
  - 'year'
  - 'start_date'
  - 'end_date'</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>AttributeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the expected regex match is not found in the selected_query.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_values_according_to_type</span><span class="p">(</span><span class="n">selected_query</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract values from a query string based on the specified query type.</span>

<span class="sd">    This function uses regular expressions to extract relevant values from the </span>
<span class="sd">    `selected_query` string according to the specified `type`. The extracted values</span>
<span class="sd">    may include properties, sensors, dates, months, seasons, and years, depending on the type.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected_query (str): The selected query string from which to extract values.</span>
<span class="sd">        type (str): The type of the query. Options include:</span>
<span class="sd">            - &#39;type1&#39;: Query for date range.</span>
<span class="sd">            - &#39;type2&#39;: Query for month and year.</span>
<span class="sd">            - &#39;type3&#39;: Query for season and year.</span>
<span class="sd">            - &#39;type4&#39;: Query for date range (weather category).</span>
<span class="sd">            - &#39;type5&#39;: Query for month and year (weather category).</span>
<span class="sd">            - &#39;type6&#39;: Query for season and year (weather category).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the extracted values, where keys are based on</span>
<span class="sd">              the field names specified in `query_types`, including:</span>
<span class="sd">              - &#39;property&#39;</span>
<span class="sd">              - &#39;sensor&#39;</span>
<span class="sd">              - &#39;month&#39;</span>
<span class="sd">              - &#39;season&#39;</span>
<span class="sd">              - &#39;year&#39;</span>
<span class="sd">              - &#39;start_date&#39;</span>
<span class="sd">              - &#39;end_date&#39;</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If the expected regex match is not found in the selected_query.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">selected_query</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type1&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sensor</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the sensor (.+?) from&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;from (.+?) to&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;to (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">,</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type2&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sensor</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the sensor (.+?) for the month of&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the month of (.+?) &#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the year (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">,</span> <span class="n">sensor</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type3&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sensor</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the sensor (.+?) for the season of&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">season</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the season of (.+?) for&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the year (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">,</span> <span class="n">sensor</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type4&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;from (.+?) to&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;to (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type5&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the month of (.+?) for the year&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the year (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type6&#39;</span><span class="p">:</span>
        <span class="nb">property</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;What is the (.+?) value&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">season</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the season of (.+?) for the year&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;for the year (.+?)\?&#39;</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">extracted_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">property</span><span class="p">]</span>


    <span class="c1"># Get the structure from query_types for &#39;type1&#39;</span>
    <span class="n">type_struc</span> <span class="o">=</span> <span class="n">query_types</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> 

    <span class="c1"># Map the extracted values to the keys in the structure</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">type_struc</span><span class="p">,</span> <span class="n">extracted_values</span><span class="p">)}</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_data_from_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_data_from_query</span><span class="p">(</span><span class="n">selected_category</span><span class="p">,</span> <span class="n">selected_query</span><span class="p">,</span> <span class="n">selected_query_type</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve data based on the selected category and query.</p>
<p>This function extracts values from the provided query, retrieves data from
AWS based on the selected category, processes the data, and returns a DataFrame
containing the queried information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selected_category</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category of data to retrieve. Options include:
- 'visitor_sensors'
- 'parking'
- 'weather'
- 'visitor_centers'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_query</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query string used to extract specific values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_query_type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the query, which determines the 
format of the expected values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A DataFrame containing the filtered data based on the query.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the selected category is not recognized.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the expected values are not found in the query.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_data_from_query</span><span class="p">(</span><span class="n">selected_category</span><span class="p">,</span><span class="n">selected_query</span><span class="p">,</span><span class="n">selected_query_type</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve data based on the selected category and query.</span>

<span class="sd">    This function extracts values from the provided query, retrieves data from</span>
<span class="sd">    AWS based on the selected category, processes the data, and returns a DataFrame</span>
<span class="sd">    containing the queried information.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected_category (str): The category of data to retrieve. Options include:</span>
<span class="sd">            - &#39;visitor_sensors&#39;</span>
<span class="sd">            - &#39;parking&#39;</span>
<span class="sd">            - &#39;weather&#39;</span>
<span class="sd">            - &#39;visitor_centers&#39;</span>
<span class="sd">        selected_query (str): The query string used to extract specific values.</span>
<span class="sd">        selected_query_type (str): The type of the query, which determines the </span>
<span class="sd">            format of the expected values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing the filtered data based on the query.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the selected category is not recognized.</span>
<span class="sd">        KeyError: If the expected values are not found in the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;visitor_sensors&#39;</span><span class="p">:</span>
        <span class="n">sensor_df</span> <span class="o">=</span> <span class="n">get_sensors_data</span><span class="p">()</span>
        <span class="n">sensor_df</span> <span class="o">=</span> <span class="n">sensor_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span> 
        <span class="n">processed_category_df</span> <span class="o">=</span> <span class="n">create_temporal_columns</span><span class="p">(</span><span class="n">sensor_df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;parking&#39;</span><span class="p">:</span>
        <span class="n">category_df</span> <span class="o">=</span> <span class="n">get_parking_data_for_selected_sensor</span><span class="p">(</span><span class="n">selected_sensors</span><span class="p">)</span>
        <span class="n">processed_category_df</span> <span class="o">=</span> <span class="n">create_temporal_columns</span><span class="p">(</span><span class="n">category_df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;weather&#39;</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">get_files_from_aws</span><span class="p">(</span><span class="n">selected_category</span><span class="p">)</span>
        <span class="n">category_df</span> <span class="o">=</span> <span class="n">get_weather_data</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span>
        <span class="n">processed_category_df</span> <span class="o">=</span> <span class="n">create_temporal_columns</span><span class="p">(</span><span class="n">category_df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;visitor_centers&#39;</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">get_files_from_aws</span><span class="p">(</span><span class="n">selected_category</span><span class="p">)</span>
        <span class="n">category_df</span> <span class="o">=</span> <span class="n">get_visitor_centers_data</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span>
        <span class="n">category_df</span> <span class="o">=</span> <span class="n">category_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Datum&#39;</span><span class="p">)</span>
        <span class="n">processed_category_df</span> <span class="o">=</span> <span class="n">create_temporal_columns</span><span class="p">(</span><span class="n">category_df</span><span class="p">)</span>

    <span class="n">get_values</span> <span class="o">=</span> <span class="n">extract_values_according_to_type</span><span class="p">(</span><span class="n">selected_query</span><span class="p">,</span><span class="n">selected_query_type</span><span class="p">)</span>

    <span class="n">processed_category_df</span> <span class="o">=</span> <span class="n">get_queried_df</span><span class="p">(</span><span class="n">processed_category_df</span><span class="p">,</span> <span class="n">get_values</span><span class="p">,</span><span class="n">selected_query_type</span><span class="p">,</span> <span class="n">selected_category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">processed_category_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_parking_data_for_selected_sensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parking_data_for_selected_sensor</span><span class="p">(</span><span class="n">selected_sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetches parking data for a specified sensor from S3.</p>
<p>This function searches through a list of S3 object paths to find
the most relevant object that contains the specified sensor name.
It then retrieves the parking data from the corresponding Parquet file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>objects</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of S3 object paths to search for the
selected sensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_sensor</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the sensor to filter the
objects.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the parking data read</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>from the Parquet file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the selected sensor is not found in any object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_parking_data_for_selected_sensor</span><span class="p">(</span><span class="n">selected_sensor</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches parking data for a specified sensor from S3.</span>

<span class="sd">    This function searches through a list of S3 object paths to find</span>
<span class="sd">    the most relevant object that contains the specified sensor name.</span>
<span class="sd">    It then retrieves the parking data from the corresponding Parquet file.</span>

<span class="sd">    Args:</span>
<span class="sd">        objects (list): A list of S3 object paths to search for the</span>
<span class="sd">            selected sensor.</span>
<span class="sd">        selected_sensor (str): The name of the sensor to filter the</span>
<span class="sd">            objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the parking data read</span>
<span class="sd">        from the Parquet file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the selected sensor is not found in any object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/preprocessed_data/preprocessed_parking_data/merged_parking_data/</span><span class="si">{</span><span class="n">selected_sensor</span><span class="si">}</span><span class="s2">.csv&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_queried_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_queried_df</span><span class="p">(</span><span class="n">processed_category_df</span><span class="p">,</span> <span class="n">get_values</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">selected_category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve a filtered DataFrame based on the selected category and query type.</p>
<p>This function filters the input DataFrame <code>processed_category_df</code> according to the
specified <code>selected_category</code> and <code>type</code>. It uses values provided in the <code>get_values</code>
dictionary to perform the filtering.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>processed_category_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing processed data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>get_values</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing values for filtering, including:
- 'property' (str): The property to select from the DataFrame.
- 'start_date' (str): Start date for filtering (format: 'YYYY-MM-DD').
- 'end_date' (str): End date for filtering (format: 'YYYY-MM-DD').
- 'month' (int): Month for filtering.
- 'year' (int): Year for filtering.
- 'season' (str): Season for filtering (e.g., 'spring', 'summer').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of query to perform. Options include:
- 'type1': Filter by date range.
- 'type2': Filter by month and year.
- 'type3': Filter by season and year.
- 'type4': Filter by date range (weather category).
- 'type5': Filter by month and year (weather category).
- 'type6': Filter by season and year (weather category).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_category</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category to filter by. Options include:
- 'parking'
- 'weather'
- 'visitor_centers'
- 'visitor_sensors'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A DataFrame containing the filtered data for the specified property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If 'property' is not in <code>get_values</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an invalid type or selected_category is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_queried_df</span><span class="p">(</span><span class="n">processed_category_df</span><span class="p">,</span> <span class="n">get_values</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">selected_category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a filtered DataFrame based on the selected category and query type.</span>

<span class="sd">    This function filters the input DataFrame `processed_category_df` according to the</span>
<span class="sd">    specified `selected_category` and `type`. It uses values provided in the `get_values`</span>
<span class="sd">    dictionary to perform the filtering.</span>

<span class="sd">    Args:</span>
<span class="sd">        processed_category_df (pd.DataFrame): The DataFrame containing processed data.</span>
<span class="sd">        get_values (dict): A dictionary containing values for filtering, including:</span>
<span class="sd">            - &#39;property&#39; (str): The property to select from the DataFrame.</span>
<span class="sd">            - &#39;start_date&#39; (str): Start date for filtering (format: &#39;YYYY-MM-DD&#39;).</span>
<span class="sd">            - &#39;end_date&#39; (str): End date for filtering (format: &#39;YYYY-MM-DD&#39;).</span>
<span class="sd">            - &#39;month&#39; (int): Month for filtering.</span>
<span class="sd">            - &#39;year&#39; (int): Year for filtering.</span>
<span class="sd">            - &#39;season&#39; (str): Season for filtering (e.g., &#39;spring&#39;, &#39;summer&#39;).</span>
<span class="sd">        type (str): The type of query to perform. Options include:</span>
<span class="sd">            - &#39;type1&#39;: Filter by date range.</span>
<span class="sd">            - &#39;type2&#39;: Filter by month and year.</span>
<span class="sd">            - &#39;type3&#39;: Filter by season and year.</span>
<span class="sd">            - &#39;type4&#39;: Filter by date range (weather category).</span>
<span class="sd">            - &#39;type5&#39;: Filter by month and year (weather category).</span>
<span class="sd">            - &#39;type6&#39;: Filter by season and year (weather category).</span>
<span class="sd">        selected_category (str): The category to filter by. Options include:</span>
<span class="sd">            - &#39;parking&#39;</span>
<span class="sd">            - &#39;weather&#39;</span>
<span class="sd">            - &#39;visitor_centers&#39;</span>
<span class="sd">            - &#39;visitor_sensors&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing the filtered data for the specified property.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If &#39;property&#39; is not in `get_values`.</span>
<span class="sd">        ValueError: If an invalid type or selected_category is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">get_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
        <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">queried_df</span>

    <span class="c1"># get the property value from the get values dictionary</span>
    <span class="k">if</span> <span class="s1">&#39;property&#39;</span> <span class="ow">in</span> <span class="n">get_values</span><span class="p">:</span>
        <span class="n">property_value</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;property&#39;</span><span class="p">]</span>

    <span class="c1"># Implement filtering logic based on selected_category and type</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;parking&#39;</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type1&#39;</span><span class="p">:</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">])</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>  

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type2&#39;</span><span class="p">:</span>
            <span class="n">month</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">month</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type3&#39;</span><span class="p">:</span>
            <span class="n">season</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;weather&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type4&#39;</span><span class="p">:</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">])</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type5&#39;</span><span class="p">:</span>
            <span class="n">month</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">month</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type6&#39;</span><span class="p">:</span>
            <span class="n">season</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

    <span class="k">if</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;visitor_centers&#39;</span> <span class="ow">or</span> <span class="n">selected_category</span> <span class="o">==</span> <span class="s1">&#39;visitor_sensors&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type4&#39;</span><span class="p">:</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">])</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;end_date&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type5&#39;</span><span class="p">:</span>
            <span class="n">month</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">month</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;type6&#39;</span><span class="p">:</span>
            <span class="n">season</span> <span class="o">=</span> <span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_values</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">processed_category_df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">processed_category_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">queried_df</span> <span class="o">=</span> <span class="n">queried_df</span><span class="p">[[</span><span class="n">property_value</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">queried_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_sensors_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensors_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetches sensor data from the most recently modified object.</p>
<p>This function retrieves the sensor data from a specified object
in S3 by reading a CSV file. It selects the last object from
the provided list of objects, assuming this is the most recently
modified.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>objects</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of S3 object paths, where the last
object is the most recently modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the sensor data read</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>from the CSV file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sensors_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches sensor data from the most recently modified object.</span>

<span class="sd">    This function retrieves the sensor data from a specified object</span>
<span class="sd">    in S3 by reading a CSV file. It selects the last object from</span>
<span class="sd">    the provided list of objects, assuming this is the most recently</span>
<span class="sd">    modified.</span>

<span class="sd">    Args:</span>
<span class="sd">        objects (list): A list of S3 object paths, where the last</span>
<span class="sd">            object is the most recently modified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the sensor data read</span>
<span class="sd">        from the CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/preprocessed_data/preprocessed_visitor_count_sensors_data.parquet&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_visitor_centers_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_visitor_centers_data</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetches visitor centers data from the most recently modified Excel file.</p>
<p>This function retrieves visitor centers data from a specified Excel file
in S3. It selects the last object from the provided list of objects
that is an Excel file (with extensions '.xlsx' or '.xls'), assuming this
is the most recently modified Excel file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>objects</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of S3 object paths, where the last
object ending in '.xlsx' or '.xls' is the most recently modified Excel file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the visitor centers</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data read from the Excel file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_visitor_centers_data</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches visitor centers data from the most recently modified Excel file.</span>

<span class="sd">    This function retrieves visitor centers data from a specified Excel file</span>
<span class="sd">    in S3. It selects the last object from the provided list of objects</span>
<span class="sd">    that is an Excel file (with extensions &#39;.xlsx&#39; or &#39;.xls&#39;), assuming this</span>
<span class="sd">    is the most recently modified Excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        objects (list): A list of S3 object paths, where the last</span>
<span class="sd">            object ending in &#39;.xlsx&#39; or &#39;.xls&#39; is the most recently modified Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the visitor centers</span>
<span class="sd">        data read from the Excel file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Filter the list to include only objects that are Excel files</span>
    <span class="n">excel_objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;.xls&#39;</span><span class="p">))]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">excel_objects</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No visitor center data found!&quot;</span><span class="p">)</span>

    <span class="c1"># Select the most recently modified Excel file (i.e., the last one in the list)</span>
    <span class="n">object_to_be_queried</span> <span class="o">=</span> <span class="n">excel_objects</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Read the Excel file from S3, skipping the last row which is a NaN row</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">object_to_be_queried</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">skipfooter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.get_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_weather_data</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetches weather data from the most recently modified object.</p>
<p>This function retrieves weather data from a specified object
in S3 by reading an Parquet file. It selects the last object from
the provided list of objects, assuming this is the most recently
modified.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>objects</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of S3 object paths, where the last
object is the most recently modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the weather</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data read from the Parquet file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_weather_data</span><span class="p">(</span><span class="n">objects</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches weather data from the most recently modified object.</span>

<span class="sd">    This function retrieves weather data from a specified object</span>
<span class="sd">    in S3 by reading an Parquet file. It selects the last object from</span>
<span class="sd">    the provided list of objects, assuming this is the most recently</span>
<span class="sd">    modified.</span>

<span class="sd">    Args:</span>
<span class="sd">        objects (list): A list of S3 object paths, where the last</span>
<span class="sd">            object is the most recently modified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the weather</span>
<span class="sd">        data read from the Parquet file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># if there are multiple objects get the last mostfied one</span>
    <span class="n">object_to_be_queried</span> <span class="o">=</span> <span class="n">objects</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Read the parquet file from S3</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">object_to_be_queried</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.data_retrieval.parse_german_dates_regex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_german_dates_regex</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">date_column_name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses German dates in the specified date column of the DataFrame using regex,
including hours and minutes if available.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>date_column_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame with parsed German dates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/data_retrieval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_german_dates_regex</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses German dates in the specified date column of the DataFrame using regex,</span>
<span class="sd">    including hours and minutes if available.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame containing the date column.</span>
<span class="sd">        date_column_name (str): The name of the date column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame with parsed German dates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define a mapping of German month names to their numeric values</span>
    <span class="n">month_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Jan.&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Feb.&quot;</span><span class="p">:</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MÃ¤rz&quot;</span><span class="p">:</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Apr.&quot;</span><span class="p">:</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mai&quot;</span><span class="p">:</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juni&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juli&quot;</span><span class="p">:</span> <span class="s2">&quot;07&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Aug.&quot;</span><span class="p">:</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sep.&quot;</span><span class="p">:</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Okt.&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nov.&quot;</span><span class="p">:</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dez.&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">}</span>

    <span class="c1"># Create a regex pattern for replacing months and capturing time</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d{1,2})\.\s*(&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">month_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)\s*(\d</span><span class="si">{4}</span><span class="s1">)\s*(\d</span><span class="si">{2}</span><span class="s1">):(\d</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Function to replace the month in the matched string and keep the time part</span>
    <span class="k">def</span> <span class="nf">replace_month</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">month_map</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">minute</span><span class="si">}</span><span class="s2">:00&quot;</span>

    <span class="c1"># Apply regex replacement and convert to datetime</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">replace_month</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.download"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.download.list_files_in_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_files_in_s3</span><span class="p">(</span><span class="n">category</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lists files in S3 for a given category and returns only file names.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_files_in_s3</span><span class="p">(</span><span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists files in S3 for a given category and returns only file names.&quot;&quot;&quot;</span>
    <span class="n">s3_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">category</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">full_paths</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">s3_prefix</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">full_paths</span><span class="p">]</span>  <span class="c1"># Extract only the file names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.download.load_csv_files_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.pandas_profiling_styling"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.generate_queries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_queries</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate queries based on the selected category and date range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>category</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category of data (e.g., 'parking', 'weather', 'visitor_sensors', 'visitor_centers').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for the queries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for the queries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_properties</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected properties relevant to the category.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_sensors</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected sensors relevant to the category.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing generated queries based on the specified category and filters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_queries</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate queries based on the selected category and date range.</span>

<span class="sd">    Args:</span>
<span class="sd">        category (str): The category of data (e.g., &#39;parking&#39;, &#39;weather&#39;, &#39;visitor_sensors&#39;, &#39;visitor_centers&#39;).</span>
<span class="sd">        start_date (str): The start date for the queries.</span>
<span class="sd">        end_date (str): The end date for the queries.</span>
<span class="sd">        selected_properties (list): List of selected properties relevant to the category.</span>
<span class="sd">        selected_sensors (list): List of selected sensors relevant to the category.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing generated queries based on the specified category and filters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;parking&#39;</span><span class="p">:</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="n">get_queries_for_parking</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span><span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;weather&#39;</span><span class="p">:</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="n">get_queries_for_weather</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;visitor_sensors&#39;</span><span class="p">:</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="n">get_queries_for_visitor_sensors</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;visitor_centers&#39;</span><span class="p">:</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="n">get_queries_for_visitor_centers</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">queries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_parking" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_queries_for_parking</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate queries for parking data based on selected date range, properties, and sensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_properties</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parking properties to include in the query (e.g., occupancy, capacity).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_sensors</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parking sensors to query data for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys "type1", "type2", and "type3" containing queries for the date range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_queries_for_parking</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate queries for parking data based on selected date range, properties, and sensors.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_date (str): The start date for the query.</span>
<span class="sd">        end_date (str): The end date for the query.</span>
<span class="sd">        selected_properties (list): List of parking properties to include in the query (e.g., occupancy, capacity).</span>
<span class="sd">        selected_sensors (list): List of parking sensors to query data for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with keys &quot;type1&quot;, &quot;type2&quot;, and &quot;type3&quot; containing queries for the date range.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">selected_sensors</span><span class="p">:</span>
        <span class="k">for</span> <span class="nb">property</span> <span class="ow">in</span> <span class="n">selected_properties</span><span class="p">:</span>
            <span class="n">queries</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;type1&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;What is the </span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> value for the sensor </span><span class="si">{</span><span class="n">selected_sensors</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">?&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">queries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_centers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_queries_for_visitor_centers</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate queries for visitor center data based on selected date range,and sensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_sensors</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of visitor center sensors to query data for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys "type4", "type5", and "type6" containing queries for the date range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_queries_for_visitor_centers</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate queries for visitor center data based on selected date range,and sensors.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_date (str): The start date for the query.</span>
<span class="sd">        end_date (str): The end date for the query.</span>
<span class="sd">        selected_sensors (list): List of visitor center sensors to query data for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with keys &quot;type4&quot;, &quot;type5&quot;, and &quot;type6&quot; containing queries for the date range.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Queries for the date range (type1)</span>
    <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">selected_sensors</span><span class="p">:</span>
        <span class="n">queries</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;type4&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;What is the </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2"> value from </span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">?&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">queries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_queries_for_visitor_sensors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_queries_for_visitor_sensors</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate queries for visitor sensor data based on selected date range and sensors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for the query.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_sensors</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of visitor sensors to query data for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys "type4", "type5", and "type6" containing queries for the date range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_queries_for_visitor_sensors</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate queries for visitor sensor data based on selected date range and sensors.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_date (str): The start date for the query.</span>
<span class="sd">        end_date (str): The end date for the query.</span>
<span class="sd">        selected_sensors (list): List of visitor sensors to query data for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with keys &quot;type4&quot;, &quot;type5&quot;, and &quot;type6&quot; containing queries for the date range.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Queries for the date range (type1)</span>
    <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">selected_sensors</span><span class="p">:</span>
        <span class="n">queries</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;type4&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;What is the </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2"> value from </span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">?&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">queries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.get_query_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_query_section</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the query section for data selection and execution.</p>
<p>This function displays a user interface for selecting data categories, date ranges, 
and additional filters. It allows users to generate 
specific queries and execute them to retrieve data.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function does not return any values but updates the Streamlit UI
  with the selected query results and visualizations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_query_section</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the query section for data selection and execution.</span>

<span class="sd">    This function displays a user interface for selecting data categories, date ranges, </span>
<span class="sd">    and additional filters. It allows users to generate </span>
<span class="sd">    specific queries and execute them to retrieve data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: This function does not return any values but updates the Streamlit UI</span>
<span class="sd">              with the selected query results and visualizations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># display the query box</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;## Data query&quot;</span><span class="p">)</span>

    <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
        <span class="n">selected_category</span> <span class="o">=</span> <span class="n">select_category</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">selected_category</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
        <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span> <span class="o">=</span> <span class="n">select_date</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span> <span class="o">=</span> <span class="n">select_filters</span><span class="p">(</span><span class="n">selected_category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="c1"># Give options to select your queries in form of a dropdown</span>
    <span class="n">queries_dict</span> <span class="o">=</span> <span class="n">generate_queries</span><span class="p">(</span><span class="n">selected_category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_properties</span><span class="p">,</span><span class="n">selected_sensors</span><span class="p">)</span>

    <span class="c1"># get all the values of the all the keys in the dictionary queries</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="k">for</span> <span class="n">query_list</span> <span class="ow">in</span> <span class="n">queries_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">query_list</span><span class="p">]</span>

    <span class="n">selected_query_type</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">form</span><span class="p">(</span><span class="s2">&quot;Select a query&quot;</span><span class="p">):</span>

        <span class="n">selected_query</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;Select a query&quot;</span><span class="p">,</span> <span class="n">queries</span><span class="p">)</span>

        <span class="c1"># get the type of the selected query from the queries dictionary</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">queries_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">selected_query</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">selected_query_type</span> <span class="o">=</span> <span class="n">key</span>

        <span class="n">submitted</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">form_submit_button</span><span class="p">(</span><span class="s2">&quot;:green[Run Query]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">submitted</span><span class="p">:</span>
        <span class="c1"># get_data_from_query(selected_query,selected_query_type,selected_category)</span>
        <span class="n">queried_df</span> <span class="o">=</span> <span class="n">get_data_from_query</span><span class="p">(</span><span class="n">selected_category</span><span class="p">,</span><span class="n">selected_query</span><span class="p">,</span><span class="n">selected_query_type</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">selected_sensors</span><span class="p">)</span>

        <span class="c1"># handle error if the queried df is an empty dataframe</span>
        <span class="k">if</span> <span class="n">queried_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error: The query returned an empty dataframe. Please try again.&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Query executed successfully!&quot;</span><span class="p">)</span>

            <span class="c1"># get visualization for the queried data</span>
            <span class="n">get_visualization_section</span><span class="p">(</span><span class="n">queried_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_category" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_category</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Select the category of data to access using st.selectbox from Streamlit.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>category</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category selected by the user.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_category</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the category of data to access using st.selectbox from Streamlit.</span>

<span class="sd">    Returns: </span>
<span class="sd">        category (str): The category selected by the user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># select the dropdown for the category</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;Select data category&quot;</span><span class="p">,</span> 
                            <span class="p">[</span><span class="s2">&quot;weather&quot;</span><span class="p">,</span> <span class="s2">&quot;visitor_sensors&quot;</span><span class="p">,</span> <span class="s2">&quot;parking&quot;</span><span class="p">,</span> <span class="s2">&quot;visitor_centers&quot;</span><span class="p">],</span>
                            <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">category</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_date" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_date</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Select the start and end date for data access using date inputs in Streamlit.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The selected start and end date in the format "MM-DD-YYYY".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_date</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the start and end date for data access using date inputs in Streamlit.</span>

<span class="sd">    Returns: </span>
<span class="sd">        tuple: The selected start and end date in the format &quot;MM-DD-YYYY&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the default start and end dates of the 01.01.2023 to 31.12.2023</span>
    <span class="n">default_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">default_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>

    <span class="c1"># Create the date input widget with start date</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">date_input</span><span class="p">(</span>
        <span class="s2">&quot;Select the start date&quot;</span><span class="p">,</span>
        <span class="n">default_start</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;DD.MM.YYYY&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Create the date input widget with end date</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">date_input</span><span class="p">(</span>
        <span class="s2">&quot;Select the end date&quot;</span><span class="p">,</span>
        <span class="n">default_end</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;DD.MM.YYYY&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># capture the selected date</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%Y&quot;</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%Y&quot;</span><span class="p">)</span>

    <span class="c1"># prompt if the end date is chosen before start date</span>
    <span class="k">if</span> <span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error: End date must fall after start date.&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_box.select_filters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_filters</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Select additional filters such as sensors, weather values, or parking values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>category</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category selected by the user. Can be one of:
            "weather", "parking", "visitor_sensors", "visitor_centers".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing selected_properties and selected_sensors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_box.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_filters</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select additional filters such as sensors, weather values, or parking values.</span>

<span class="sd">    Args:</span>
<span class="sd">        category (str): The category selected by the user. Can be one of:</span>
<span class="sd">                        &quot;weather&quot;, &quot;parking&quot;, &quot;visitor_sensors&quot;, &quot;visitor_centers&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing selected_properties and selected_sensors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### More Filters&quot;</span><span class="p">)</span>

    <span class="c1"># Select the sensors or weather values or parking values</span>
    <span class="n">category_based_filters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;weather&quot;</span> <span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Temperature (Â°C)&#39;</span><span class="p">,</span> <span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind Speed (km/h)&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative Humidity (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunshine Duration (min)&#39;</span>
            <span class="p">],</span>
        <span class="s2">&quot;parking&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sensors&#39;</span><span class="p">:[</span>
                                <span class="s1">&#39;p-r-spiegelau-1&#39;</span><span class="p">,</span><span class="s1">&#39;parkplatz-fredenbruecke-1&#39;</span><span class="p">,</span><span class="s1">&#39;parkplatz-graupsaege-1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;parkplatz-nationalparkzentrum-falkenstein-2&#39;</span><span class="p">,</span><span class="s1">&#39;parkplatz-nationalparkzentrum-lusen-p2&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;parkplatz-skisportzentrum-finsterau-1&#39;</span><span class="p">,</span><span class="s1">&#39;parkplatz-waldhaeuser-ausblick-1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;parkplatz-waldhaeuser-kirche-1&#39;</span><span class="p">,</span><span class="s1">&#39;parkplatz-zwieslerwaldhaus-1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;parkplatz-zwieslerwaldhaus-nord-1&#39;</span><span class="p">,</span><span class="s1">&#39;scheidt-bachmann-parkplatz-1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;skiwanderzentrum-zwieslerwaldhaus-2&#39;</span><span class="p">],</span>

                     <span class="s1">&#39;properties&#39;</span><span class="p">:[</span>
                         <span class="s1">&#39;occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;occupancy_rate&#39;</span><span class="p">],</span>
                    <span class="p">},</span>

        <span class="s1">&#39;visitor_sensors&#39;</span>  <span class="p">:[</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein&#39;</span><span class="p">,</span> <span class="s1">&#39;Bayerisch Eisenstein IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bayerisch Eisenstein FuÃŸgÃ¤nger&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein FahrrÃ¤der IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bayerisch Eisenstein FahrrÃ¤der OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;BrechhÃ¤uslau IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;BrechhÃ¤uslau OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;BrechhÃ¤uslau&#39;</span><span class="p">,</span> <span class="s1">&#39;BrechhÃ¤uslau FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;BrechhÃ¤uslau FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bucina_Multi FuÃŸgÃ¤nger&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bucina_Multi FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi FahrrÃ¤der IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Bucina_Multi FahrrÃ¤der OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Deffernik&#39;</span><span class="p">,</span> <span class="s1">&#39;Deffernik IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Deffernik OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Deffernik FuÃŸgÃ¤nger&#39;</span><span class="p">,</span> <span class="s1">&#39;Deffernik FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Deffernik FahrrÃ¤der IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Deffernik FahrrÃ¤der OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Deffernik FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Deffernik FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe&#39;</span><span class="p">,</span> <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Felswandergebiet&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Felswandergebiet IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Felswandergebiet OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Ferdinandsthal&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Ferdinandsthal IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Ferdinandsthal OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;FredenbrÃ¼cke&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;FredenbrÃ¼cke FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;FredenbrÃ¼cke FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;GfÃ¤ll&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;GfÃ¤ll FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;GfÃ¤ll FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Gsenget IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget FuÃŸgÃ¤nger&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Gsenget FahrrÃ¤der&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget IN.1&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget OUT.1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Gsenget FahrrÃ¤der IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget FahrrÃ¤der OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald&#39;</span><span class="p">,</span> <span class="s1">&#39;Klingenbrunner Wald IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Klingenbrunner Wald FuÃŸgÃ¤nger&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald FahrrÃ¤der IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klingenbrunner Wald FahrrÃ¤der OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Klosterfilz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klosterfilz IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Klosterfilz OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Klosterfilz FuÃŸgÃ¤nger&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klosterfilz FahrrÃ¤der&#39;</span><span class="p">,</span> <span class="s1">&#39;Klosterfilz FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klosterfilz FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Klosterfilz FahrrÃ¤der IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Klosterfilz FahrrÃ¤der OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;RacheldiensthÃ¼tte&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RacheldiensthÃ¼tte IN&#39;</span><span class="p">,</span> <span class="s1">&#39;RacheldiensthÃ¼tte OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RacheldiensthÃ¼tte FuÃŸgÃ¤nger&#39;</span><span class="p">,</span> <span class="s1">&#39;RacheldiensthÃ¼tte FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RacheldiensthÃ¼tte FahrrÃ¤der IN&#39;</span><span class="p">,</span> <span class="s1">&#39;RacheldiensthÃ¼tte Cyclist OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RacheldiensthÃ¼tte Pedestrian IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RacheldiensthÃ¼tte Pedestrian OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;SagwassersÃ¤ge&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SagwassersÃ¤ge FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;SagwassersÃ¤ge FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Scheuereck&#39;</span><span class="p">,</span> <span class="s1">&#39;Scheuereck IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Scheuereck OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;SchillerstraÃŸe&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SchillerstraÃŸe IN&#39;</span><span class="p">,</span> <span class="s1">&#39;SchillerstraÃŸe OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;SchwarzbachbrÃ¼cke&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SchwarzbachbrÃ¼cke FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;SchwarzbachbrÃ¼cke FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Falkenstein_1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Falkenstein_1 FuÃŸgÃ¤nger zum Parkplatz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Falkenstein_1 FuÃŸgÃ¤nger zum HZW&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Falkenstein_2&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Falkenstein_2 FuÃŸgÃ¤nger In Richtung Parkplatz&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Falkenstein_2 FuÃŸgÃ¤nger In Richtung TFG&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Lusen_1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Lusen_1 FuÃŸgÃ¤nger Richtung TFG&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Lusen_1 FuÃŸgÃ¤nger Richtung Parkplatz&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Lusen_2&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Lusen_2 FuÃŸgÃ¤nger Richtung VÃ¶gel am Waldrand&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Lusen_2 FuÃŸgÃ¤nger Richtung Parkplatz&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Lusen_3&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;TFG_Lusen_3 TFG Lusen 3 IN&#39;</span><span class="p">,</span> <span class="s1">&#39;TFG_Lusen_3 TFG Lusen 3 OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI&#39;</span><span class="p">,</span> <span class="s1">&#39;Trinkwassertalsperre_MULTI IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FuÃŸgÃ¤nger&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FahrrÃ¤der&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FahrrÃ¤der IN&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Trinkwassertalsperre_MULTI FahrrÃ¤der OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldhausreibe&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Waldhausreibe IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldhausreibe OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;WaldspielgelÃ¤nde_1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;WaldspielgelÃ¤nde_1 IN&#39;</span><span class="p">,</span> <span class="s1">&#39;WaldspielgelÃ¤nde_1 OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Wistlberg&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Wistlberg FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Wistlberg FuÃŸgÃ¤nger OUT&#39;</span><span class="p">],</span>


        <span class="s1">&#39;visitor_centers&#39;</span> <span class="p">:</span> <span class="p">[</span>
                            <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span>
                            <span class="p">]</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;weather&quot;</span><span class="p">:</span>
        <span class="n">selected_properties</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&quot;Select the weather properties&quot;</span><span class="p">,</span> <span class="n">category_based_filters</span><span class="p">[</span><span class="n">category</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">selected_sensors</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;parking&quot;</span><span class="p">:</span>
        <span class="n">selected_properties</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&quot;Select the parking values&quot;</span><span class="p">,</span> <span class="n">category_based_filters</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  
        <span class="n">selected_sensors</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;Select the parking sensor you want to find the values for?&quot;</span><span class="p">,</span> <span class="n">category_based_filters</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="s1">&#39;sensors&#39;</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;visitor_sensors&quot;</span><span class="p">:</span>
        <span class="n">visitor_sensors_data</span> <span class="o">=</span> <span class="n">get_data_from_query</span><span class="p">(</span>
            <span class="n">selected_category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">selected_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">selected_query_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
            <span class="n">selected_sensors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">visitor_sensor_options</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">visitor_sensors_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">]))</span>

        <span class="n">selected_sensors</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&quot;Select the visitor sensor you want to find the count for?&quot;</span><span class="p">,</span> <span class="n">visitor_sensor_options</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">selected_properties</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;visitor_centers&quot;</span><span class="p">:</span>
        <span class="n">selected_sensors</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&quot;Select the visitor center you want to find the count for?&quot;</span><span class="p">,</span> <span class="n">category_based_filters</span><span class="p">[</span><span class="n">category</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">selected_properties</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">selected_properties</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">selected_sensors</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">selected_properties</span><span class="p">,</span> <span class="n">selected_sensors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.query_viz_and_download.get_visualization_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_visualization_section</span><span class="p">(</span><span class="n">retrieved_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the visualization section.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/query_viz_and_download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_visualization_section</span><span class="p">(</span><span class="n">retrieved_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the visualization section.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;# Data visualization&quot;</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">retrieved_df</span><span class="p">)</span>

    <span class="c1"># Generate Pandas Profiling report</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">ProfileReport</span><span class="p">(</span><span class="n">retrieved_df</span><span class="p">,</span><span class="n">minimal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">st_profile_report</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.data_accessibility.upload"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.upload.generate_file_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_file_name</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">upload_timestamp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generates a file name based on the category.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/upload.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_file_name</span><span class="p">(</span><span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">upload_timestamp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a file name based on the category.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">category</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_uploaded_</span><span class="si">{</span><span class="n">upload_timestamp</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.data_accessibility.upload.write_csv_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes a CSV file to AWS S3.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/data_accessibility/upload.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a CSV file to AWS S3.&quot;&quot;&quot;</span>
    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Streamlit: Visitors Page -->



<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.language_selection_menu"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.other_information"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.other_information.get_other_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_other_information</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the other information section.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/other_information.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_other_information</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the other information section.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;other_information&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_centers&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">):</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_centers_description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;learn_more&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_centers_link&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;popular_entrances&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">):</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;entrances_description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;:green[**1 - Falkenstein**]&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;learn_more&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](https://www.nationalpark-bayerischer-wald.bayern.de/besucher/einrichtungen/npz_falkenstein/index.htm)&quot;</span><span class="p">)</span>

        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;:green[**2 - Lusen**]&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;learn_more&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](https://www.nationalpark-bayerischer-wald.bayern.de/besucher/einrichtungen/npz_lusen/index.htm)&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;best_way_to_get_there&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">):</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;getting_there_description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;learn_more&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](https://www.nationalpark-bayerischer-wald.bayern.de/service/anreise/)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.page_layout_config"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.page_layout_config.get_page_layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_page_layout</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set the page layout for the Streamlit app.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>col1, col2: The two columns of the page layout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/page_layout_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_page_layout</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the page layout for the Streamlit app.</span>

<span class="sd">    Returns:</span>
<span class="sd">        col1, col2: The two columns of the page layout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s1">&#39;Plan your tripðŸŒ²&#39;</span><span class="p">,</span>
    <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;ðŸŒ²&quot;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span><span class="p">,</span>
    <span class="n">initial_sidebar_state</span><span class="o">=</span><span class="s2">&quot;expanded&quot;</span><span class="p">)</span>

    <span class="n">alt</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>

    <span class="c1"># Define the app layout</span>

    <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">((</span><span class="mf">2.2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">gap</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.parking"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.parking.calculate_color_based_on_occupancy_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_color_based_on_occupancy_rate</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the color of the marker based on the occupancy rate.
Returns a named tuple with the RGB values and a CSS gradient color value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>occupancy_rate</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The occupancy rate of the parking section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of RGB values representing the color of the marker.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_color_based_on_occupancy_rate</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the color of the marker based on the occupancy rate.</span>
<span class="sd">    Returns a named tuple with the RGB values and a CSS gradient color value.</span>



<span class="sd">    Args:</span>
<span class="sd">        occupancy_rate (float): The occupancy rate of the parking section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of RGB values representing the color of the marker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">occupancy_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;color_markers_map_visualization&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">230</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">39</span><span class="p">],</span>
                <span class="s2">&quot;color_bar_occupancy_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span> <span class="c1"># red</span>
    <span class="k">elif</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;color_markers_map_visualization&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                <span class="s2">&quot;color_bar_occupancy_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;yellow&quot;</span><span class="p">}</span> <span class="c1"># yellow</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;color_markers_map_visualization&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">109</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="s2">&quot;color_bar_occupancy_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">}</span> <span class="c1"># green</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.parking.get_fixed_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fixed_size</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a fixed size value for the map markers.</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fixed_size</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a fixed size value for the map markers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">450</span>  
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.parking.get_occupancy_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_occupancy_status</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the occupancy status (High, Medium, Low) based on the occupancy rate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>occupancy_rate</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The occupancy rate of the parking section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The occupancy status ("High", "Medium", "Low").</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_occupancy_status</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the occupancy status (High, Medium, Low) based on the occupancy rate.</span>

<span class="sd">    Args:</span>
<span class="sd">        occupancy_rate (float): The occupancy rate of the parking section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The occupancy status (&quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s2">&quot;parking_status_high&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">occupancy_rate</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s2">&quot;parking_status_moderate&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s2">&quot;parking_status_low&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.parking.get_parking_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parking_section</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Display the parking section of the dashboard with a map showing the real-time parking occupancy 
and interactive metrics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>processed_parking_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed parking data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="s2">&quot;15min&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_parking_section</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display the parking section of the dashboard with a map showing the real-time parking occupancy </span>
<span class="sd">    and interactive metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        processed_parking_data (pd.DataFrame): Processed parking data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rendering parking section for the visitor dashboard...&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_current_15min_interval</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current 15-minute interval in the format &quot;HH:MM:00&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The current 15-minute interval in the format &quot;HH:MM:00&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Europe/Berlin&#39;</span><span class="p">))</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_time</span><span class="o">.</span><span class="n">minute</span> <span class="o">//</span> <span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="mi">15</span>

        <span class="c1"># Replace the minute value with the truncated value and set seconds and microseconds to 0</span>
        <span class="n">timestamp_latest_parking_data_fetch</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="n">minutes</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># If you want to format it as a string in the &quot;%Y-%m-%d %H:%M:%S&quot; format</span>
        <span class="n">timestamp_latest_parking_data_fetch_str</span> <span class="o">=</span> <span class="n">timestamp_latest_parking_data_fetch</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">timestamp_latest_parking_data_fetch_str</span>

    <span class="n">timestamp_latest_parking_data_fetch</span> <span class="o">=</span> <span class="n">get_current_15min_interval</span><span class="p">()</span>

    <span class="c1"># Source and preprocess the parking data</span>
    <span class="n">processed_parking_data</span> <span class="o">=</span> <span class="n">source_and_preprocess_realtime_parking_data</span><span class="p">(</span><span class="n">timestamp_latest_parking_data_fetch</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;real_time_parking_occupancy&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set a fixed size for all markers</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_fixed_size</span><span class="p">()</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">occupancy_rate</span><span class="p">:</span> <span class="n">calculate_color_based_on_occupancy_rate</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)[</span><span class="s2">&quot;color_markers_map_visualization&quot;</span><span class="p">])</span>

    <span class="c1"># Convert the occupancy rate to numeric and handle errors</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="c1"># Map occupancy rate to status (High, Medium, Low)</span>
    <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;occupancy_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_occupancy_status</span><span class="p">)</span>

    <span class="c1"># Calculate center of the map based on the average of latitudes and longitudes</span>
    <span class="n">avg_latitude</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">avg_longitude</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># PyDeck Map Configuration with adjusted view_state</span>
    <span class="n">view_state</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">ViewState</span><span class="p">(</span>
        <span class="n">latitude</span><span class="o">=</span><span class="n">avg_latitude</span><span class="p">,</span>  <span class="c1"># Center map at the average latitude</span>
        <span class="n">longitude</span><span class="o">=</span><span class="n">avg_longitude</span><span class="p">,</span>  <span class="c1"># Center map at the average longitude</span>
        <span class="n">zoom</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Zoom level increased for a closer view</span>
        <span class="n">pitch</span><span class="o">=</span><span class="mi">50</span>
    <span class="p">)</span>

    <span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
        <span class="s2">&quot;ScatterplotLayer&quot;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">processed_parking_data</span><span class="p">,</span>
        <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span>
        <span class="n">get_radius</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span>
        <span class="n">get_fill_color</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">deck</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Deck</span><span class="p">(</span>
        <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">layer</span><span class="p">],</span>
        <span class="n">initial_view_state</span><span class="o">=</span><span class="n">view_state</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{location}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;occupancy_status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{occupancy_status}</span><span class="s2">&quot;</span>
        <span class="p">},</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s2">&quot;road&quot;</span>
    <span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">pydeck_chart</span><span class="p">(</span><span class="n">deck</span><span class="p">)</span>

    <span class="c1"># Interactive Metrics</span>
    <span class="n">selected_location</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_parking_section&#39;</span><span class="p">],</span> 
        <span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;selectbox_parking_section&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Display selected location details</span>
    <span class="k">if</span> <span class="n">selected_location</span><span class="p">:</span>
        <span class="n">selected_data</span> <span class="o">=</span> <span class="n">processed_parking_data</span><span class="p">[</span><span class="n">processed_parking_data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_location</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">col1</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;capacity&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;current_capacity&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ðŸš—&quot;</span><span class="p">)</span>

        <span class="c1"># Display occupancy status and bar</span>
        <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;occupancy_status&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;occupancy_status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">**&quot;</span><span class="p">)</span>
            <span class="n">render_occupancy_bar</span><span class="p">(</span><span class="n">selected_data</span><span class="p">[</span><span class="s1">&#39;current_occupancy_rate&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.parking.render_occupancy_bar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">render_occupancy_bar</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Render a color bar representing the occupancy rate using HTML and CSS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>occupancy_rate</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The occupancy rate of the parking section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/parking.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">render_occupancy_bar</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Render a color bar representing the occupancy rate using HTML and CSS.</span>

<span class="sd">    Args:</span>
<span class="sd">        occupancy_rate (float): The occupancy rate of the parking section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure occupancy rate is between minimum value and 100</span>
    <span class="n">minimum_value_of_occupancy</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">occupancy_rate</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">),</span> <span class="n">minimum_value_of_occupancy</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Define the color based on occupancy</span>
    <span class="n">bar_color</span> <span class="o">=</span> <span class="n">calculate_color_based_on_occupancy_rate</span><span class="p">(</span><span class="n">occupancy_rate</span><span class="p">)[</span><span class="s2">&quot;color_bar_occupancy_rate&quot;</span><span class="p">]</span>

    <span class="c1"># Create an HTML div with the appropriate width based on occupancy rate</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&quot;width: 100%; background-color: lightgrey; border-radius: 5px; padding: 3px;&quot;&gt;</span>
<span class="s2">        &lt;div style=&quot;width: </span><span class="si">{</span><span class="n">occupancy_rate</span><span class="si">}</span><span class="s2">%; background-color: </span><span class="si">{</span><span class="n">bar_color</span><span class="si">}</span><span class="s2">; height: 25px; border-radius: 5px;&quot;&gt;&lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.recreational_activities"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.recreational_activities.get_recreation_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_recreation_section</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the recreational activities section for the Bavarian Forest National Park.</p>
        <p>Returns:
    None</p>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/recreational_activities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_recreation_section</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the recreational activities section for the Bavarian Forest National Park.</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>
<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;recreational_activities&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="n">activities</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;hiking&#39;</span><span class="p">]:</span> <span class="p">{</span>
            <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;ðŸ¥¾&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;hiking_description&#39;</span><span class="p">],</span>
            <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;hiking_link&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;cycling&#39;</span><span class="p">]:</span> <span class="p">{</span>
            <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;ðŸš´â€â™‚ï¸&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;cycling_description&#39;</span><span class="p">],</span>
            <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;cycling_link&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;camping&#39;</span><span class="p">]:</span> <span class="p">{</span>
            <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;ðŸ•ï¸&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;camping_description&#39;</span><span class="p">],</span>
            <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;camping_link&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;snowshoeing&#39;</span><span class="p">]:</span> <span class="p">{</span>
            <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;ðŸŒ¨ï¸&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;snowshoeing_description&#39;</span><span class="p">],</span>
            <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;snowshoeing_link&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;skiing&#39;</span><span class="p">]:</span> <span class="p">{</span>
            <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;ðŸŽ¿&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;skiing_description&#39;</span><span class="p">],</span>
            <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;skiing_link&#39;</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">activity</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">activities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;div style=&quot;</span>
<span class="s2">                padding: 5px 10px;</span>
<span class="s2">                margin-bottom: 8px;</span>
<span class="s2">                background-color: #215202;</span>
<span class="s2">                border-radius: 5px;</span>
<span class="s2">                text-align: left;&quot;&gt;</span>
<span class="s2">                &lt;h5 style=&quot;color: #fff; margin: 0;&quot;&gt;</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;emoji&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">activity</span><span class="si">}</span><span class="s2">&lt;/h5&gt;</span>
<span class="s2">                &lt;p style=&quot;color: #ccc; margin: 3px 0; font-size: 0.9em;&quot;&gt;</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">                &lt;a href=&quot;</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; target=&quot;_blank&quot; style=&quot;color: #00a0ff; font-size: 0.9em; text-decoration: none;f&quot;&gt;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;learn_more&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/a&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.visitor_count"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.visitor_count.get_visitor_counts_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_visitor_counts_section</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the visitor counts section with the highest occupancy rate.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/visitor_count.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span>
<span class="k">def</span> <span class="nf">get_visitor_counts_section</span><span class="p">(</span><span class="n">inference_predictions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the visitor counts section with the highest occupancy rate.</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;## </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_counts_forecasted&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># do a dropdown for the all_preds</span>
    <span class="n">regions_to_select</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">selected_region</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_region&#39;</span><span class="p">],</span> <span class="n">regions_to_select</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selected_region</span><span class="p">:</span>

        <span class="c1"># Filter the DataFrame based on the selected region</span>
        <span class="n">selected_region_predictions</span> <span class="o">=</span> <span class="n">inference_predictions</span><span class="p">[[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;day_date&quot;</span><span class="p">,</span> <span class="n">selected_region</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;weekly_relative_traffic_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;traffic_color_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]]</span>

        <span class="c1"># Get unique values for the day and date list</span>
        <span class="n">days_list</span> <span class="o">=</span> <span class="n">selected_region_predictions</span><span class="p">[</span><span class="s1">&#39;day_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># Add a note that this is forecasted data</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:green[*</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;forecasted_visitor_data&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">*].&quot;</span><span class="p">)</span>

        <span class="c1"># Create a layout for the radio button and chart</span>
        <span class="n">col1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

        <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
            <span class="c1"># Get radio button for selecting the day</span>
            <span class="n">day_selected</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;select_day&#39;</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="n">days_list</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>

        <span class="c1"># Extract the selected day for filtering (using date)</span>
        <span class="n">day_df</span> <span class="o">=</span> <span class="n">selected_region_predictions</span><span class="p">[</span><span class="n">selected_region_predictions</span><span class="p">[</span><span class="s1">&#39;day_date&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">day_selected</span><span class="p">]</span>

        <span class="c1"># Plot an interactive bar chart for relative traffic</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">day_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>  
            <span class="n">y</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;weekly_relative_traffic_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;traffic_color_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="c1"># Use the traffic color column</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;weekly_relative_traffic_</span><span class="si">{</span><span class="n">selected_region</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="s1">&#39;Hour of Day&#39;</span><span class="p">},</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_foot_traffic_for_day&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">day_selected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Customize hover text for relative traffic</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                <span class="s1">&#39;Hour: %{x|%H:%M}&lt;br&gt;&#39;</span>  <span class="c1"># Display the hour in HH:MM format</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Update layout for relative traffic chart</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">showticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Set y-axis to range from 0 to 1 and hide tick labels</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showticklabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Keep the x-axis tick labels visible</span>

        <span class="n">fig1</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Hide the x-axis title</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Hide the y-axis title</span>
            <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span><span class="p">,</span>
            <span class="n">legend_title_text</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;visitor_foot_traffic&#39;</span><span class="p">],</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">itemsizing</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span>
                <span class="n">traceorder</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Position the legend below the chart</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span>  <span class="c1"># Center the legend horizontally</span>
            <span class="p">),</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;%H:%M&#39;</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Update the legend names</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">for_each_trace</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;peak_traffic&#39;</span><span class="p">],</span> <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;low_traffic&#39;</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;moderate_traffic&#39;</span><span class="p">]}[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="c1"># Display the interactive bar chart for relative traffic below the radio button</span>
        <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.streamlit_app.pages_in_dashboard.visitors.weather"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.weather.find_peaks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_peaks</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Find peaks in the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to find peaks in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of indices where peaks occur.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find peaks in the data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.Series): The data to find peaks in.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of indices where peaks occur.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">peaks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">peaks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.weather.get_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_graph</span><span class="p">(</span><span class="n">forecast_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Display a line graph of the temperature forecast in the same plot,
with clear day labels on the x-axis and properly formatted hover info.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecast_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forecast data to plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>plotly.graph_objects.Figure: The plotly figure object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_graph</span><span class="p">(</span><span class="n">forecast_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a line graph of the temperature forecast in the same plot,</span>
<span class="sd">    with clear day labels on the x-axis and properly formatted hover info.</span>

<span class="sd">    Args:</span>
<span class="sd">        forecast_data (pd.DataFrame): The forecast data to plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plotly.graph_objects.Figure: The plotly figure object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecast_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add the temperature line with improved styling</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">forecast_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> 
        <span class="n">y</span><span class="o">=</span><span class="n">forecast_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span> 
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> 
        <span class="n">name</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Smoother line with better color</span>
        <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">: &#39;</span> <span class="o">+</span>  <span class="s1">&#39;%{x|</span><span class="si">%d</span><span class="s1">-%m-%Y, %H:%M}&lt;br&gt;&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">: &#39;</span> <span class="o">+</span> <span class="s1">&#39; %</span><span class="si">{y}</span><span class="s1">Â°C&lt;extra&gt;&lt;/extra&gt;&#39;</span>
    <span class="p">))</span>

    <span class="c1"># Find peak indices for temperature</span>
    <span class="n">peak_indices</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">forecast_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">])</span>

    <span class="c1"># Create a scatter trace for peaks</span>
    <span class="n">peak_points_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">forecast_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">peak_indices</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">forecast_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">peak_indices</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">26</span> <span class="k">else</span> <span class="s1">&#39;green&#39;</span> <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">forecast_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">peak_indices</span><span class="p">]],</span> 
            <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle-open&#39;</span>
        <span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;peaks&#39;</span><span class="p">],</span>
        <span class="n">text</span><span class="o">=</span><span class="n">forecast_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">peak_indices</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Â°C&quot;</span><span class="p">,</span>
        <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;top center&#39;</span><span class="p">,</span>
        <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span>  <span class="c1"># Disable hover for peaks to avoid overlapping</span>
    <span class="p">)</span>

    <span class="c1"># Add peak points trace to the figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">peak_points_trace</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;7_day_hourly_weather&#39;</span><span class="p">],</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;date&#39;</span><span class="p">],</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m&#39;</span><span class="p">,</span>  <span class="c1"># Format x-axis as &#39;Day, Month Date&#39;</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># Tick every day</span>
        <span class="n">tickangle</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span>  <span class="c1"># Rotate the labels to make them more readable</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  <span class="c1"># Ensure labels are visible on the dark background</span>
        <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Hide vertical grid lines for better clarity</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>  <span class="c1"># Ensure y-axis labels are visible</span>
    <span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>  <span class="c1"># Horizontal legend</span>
        <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># Move the legend further down below the plot</span>
        <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">),</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span>  <span class="c1"># Increase bottom margin to make space for the x-axis labels</span>
    <span class="p">),</span>
    <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span><span class="p">,</span>
    <span class="n">hovermode</span><span class="o">=</span><span class="s2">&quot;x unified&quot;</span>  <span class="c1"># Unified hover to show temperature together</span>
    <span class="p">)</span>


    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.streamlit_app.pages_in_dashboard.visitors.weather.get_weather_section" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_weather_section</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Display the weather section of the dashboard.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>processed_weather_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/streamlit_app/pages_in_dashboard/visitors/weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="s2">&quot;1h&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_weather_section</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display the weather section of the dashboard.</span>

<span class="sd">    Args:</span>
<span class="sd">        processed_weather_data (pd.DataFrame): Processed weather data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fetching the latest weather forecast data for the current hour...&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_current_hour</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current hour in the format &quot;HH:00:00&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The current hour interval in the format &quot;HH:MM:00&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Europe/Berlin&#39;</span><span class="p">))</span>

        <span class="c1"># Get the current hour: Replace the minute value with the truncated value and set seconds and microseconds to 0</span>
        <span class="n">current_hour</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">current_hour</span>

    <span class="n">timestamp_latest_weather_data_fetch</span> <span class="o">=</span> <span class="n">get_current_hour</span><span class="p">()</span>

    <span class="n">processed_weather_data</span> <span class="o">=</span> <span class="n">source_and_preprocess_forecasted_weather_data</span><span class="p">(</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="p">)</span>


    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### </span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;weather_forecast&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRANSLATIONS</span><span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_language</span><span class="p">][</span><span class="s1">&#39;weather_data_last_updated&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">timestamp_latest_weather_data_fetch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="n">fig</span>  <span class="o">=</span> <span class="n">get_graph</span><span class="p">(</span><span class="n">processed_weather_data</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Prediction Pipeline -->

<!-- Sourcing Data -->



<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_historic_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_historical_data_for_location</span><span class="p">(</span><span class="n">location_id</span><span class="p">,</span> <span class="n">location_slug</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">api_endpoint_suffix</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">save_file_path</span><span class="o">=</span><span class="s1">&#39;outputs&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetch historical data from the BayernCloud API and save it as a CSV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>location_id</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the location for which the data is to be fetched.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>location_slug</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A slug (a URL-friendly string) representing the location.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>data_type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of data being fetched (e.g., 'occupancy', 'occupancy_rate', 'capacity').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>api_endpoint_suffix</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The specific suffix of the API endpoint for the data type (e.g., 'dcls_occupancy', 'dcls_occupancy_rate').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>column_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to store the fetched data in the DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save_file_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where the CSV file will be saved (default is 'outputs').</p>
              </div>
            </td>
            <td>
                  <code>&#39;outputs&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>historical_df</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Pandas DataFrame containing the historical data for a location.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_historic_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_historical_data_for_location</span><span class="p">(</span>
    <span class="n">location_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">location_slug</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_endpoint_suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">save_file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;outputs&#39;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch historical data from the BayernCloud API and save it as a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        location_id (str): The ID of the location for which the data is to be fetched.</span>
<span class="sd">        location_slug (str): A slug (a URL-friendly string) representing the location.</span>
<span class="sd">        data_type (str): The type of data being fetched (e.g., &#39;occupancy&#39;, &#39;occupancy_rate&#39;, &#39;capacity&#39;).</span>
<span class="sd">        api_endpoint_suffix (str): The specific suffix of the API endpoint for the data type (e.g., &#39;dcls_occupancy&#39;, &#39;dcls_occupancy_rate&#39;).</span>
<span class="sd">        column_name (str): The name of the column to store the fetched data in the DataFrame.</span>
<span class="sd">        save_file_path (str, optional): The base directory where the CSV file will be saved (default is &#39;outputs&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        historical_df (pd.DataFrame): A Pandas DataFrame containing the historical data for a location.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Construct the API endpoint URL</span>
    <span class="n">API_endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://data.bayerncloud.digital/api/v4/things/</span><span class="si">{</span><span class="n">location_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">api_endpoint_suffix</span><span class="si">}</span><span class="s1">/&#39;</span>

    <span class="c1"># Set request parameters</span>
    <span class="n">request_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">BAYERN_CLOUD_API_KEY</span>
    <span class="p">}</span>

    <span class="c1"># Send the GET request to the API</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">API_endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_params</span><span class="p">)</span>
    <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="c1"># Convert the response to a Pandas DataFrame and preprocess it</span>
    <span class="n">historical_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">])</span>
    <span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
    <span class="c1"># historical_df.set_index(&quot;time&quot;, inplace=True)</span>

    <span class="k">return</span> <span class="n">historical_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_all_locations</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process and fetch all types of historical data for each location in the parking sensors dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>parking_sensors</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing location slugs as keys and location IDs as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_historic_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_all_locations</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process and fetch all types of historical data for each location in the parking sensors dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        parking_sensors (dict): Dictionary containing location slugs as keys and location IDs as values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_occupancy_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;occupancy_rate&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;capacity&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parking_sensors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">historical_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">api_suffix</span><span class="p">,</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading historical </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2"> data for location: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> with location_id: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">parking_df</span>  <span class="o">=</span> <span class="n">get_historical_data_for_location</span><span class="p">(</span>
                <span class="n">location_id</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                <span class="n">location_slug</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
                <span class="n">api_endpoint_suffix</span><span class="o">=</span><span class="n">api_suffix</span><span class="p">,</span>
                <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span>
            <span class="p">)</span>
            <span class="n">historical_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parking_df</span><span class="p">)</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">),</span> <span class="n">historical_data</span><span class="p">)</span>

        <span class="c1"># Create a filename based on the location name</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_historical_parking_data.csv&quot;</span>

        <span class="c1"># make the output directory if it doesn&#39;t exist</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved historical parking data for location: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_historic_visitor_count"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_historic_visitor_count.source_historic_visitor_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_historic_visitor_count</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source historic visitor count data from AWS S3.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_historic_visitor_count.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_historic_visitor_count</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Source historic visitor count data from AWS S3.&quot;&quot;&quot;</span>

    <span class="c1"># Load visitor count data from AWS S3</span>
    <span class="n">visitor_counts</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">raw_data_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">visitor_counts_folder</span><span class="si">}</span><span class="s2">/*.csv&quot;</span><span class="p">,</span>
        <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="n">common_columns</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">visitor_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_real_time_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_visitor_center_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_data_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.
Args:
    path (str): The path to the CSV files on AWS S3.
    **kwargs: Additional arguments to pass to the read_csv function.
Returns:
    pd.DataFrame: The DataFrame containing the data from the CSV files.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_visitor_center_data.source_preprocessed_hourly_visitor_center_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_preprocessed_hourly_visitor_center_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load the preprocessed hourly visitor center data from AWS S3.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_preprocessed_hourly_visitor_center_data</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the preprocessed hourly visitor center data from AWS S3.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load visitor count data from AWS S3</span>
    <span class="n">preprocessed_hourly_visitor_center_data</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/preprocessed_data/visitor_centers_hourly.parquet&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">preprocessed_hourly_visitor_center_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_weather"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_weather.get_hourly_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hourly_data</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetch hourly weather data for a specified region and date range.</p>
<p>This function retrieves hourly weather data from the Meteostat API or another defined source,
returning it as a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>region</code></td>
            <td>
                  <code><span title="meteostat.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>Point</code> object representing the geographical location (latitude, longitude).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for data retrieval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for data retrieval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing hourly weather data with the following columns:
- time: Datetime of the record.
- temp: Temperature in degrees Celsius.
- dwpt: Dew point in degrees Celsius.
- prcp: Precipitation in millimeters.
- wdir: Wind direction in degrees.
- wspd: Wind speed in km/h.
- wpgt: Wind gust in km/h.
- pres: Sea-level air pressure in hPa.
- tsun: Sunshine duration in minutes.
- snow: Snowfall in millimeters.
- rhum: Relative humidity in percent.
- coco: Weather condition code.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_hourly_data</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch hourly weather data for a specified region and date range.</span>

<span class="sd">    This function retrieves hourly weather data from the Meteostat API or another defined source,</span>
<span class="sd">    returning it as a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (Point): A `Point` object representing the geographical location (latitude, longitude).</span>
<span class="sd">        start_date (datetime): The start date for data retrieval.</span>
<span class="sd">        end_date (datetime): The end date for data retrieval.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing hourly weather data with the following columns:</span>
<span class="sd">            - time: Datetime of the record.</span>
<span class="sd">            - temp: Temperature in degrees Celsius.</span>
<span class="sd">            - dwpt: Dew point in degrees Celsius.</span>
<span class="sd">            - prcp: Precipitation in millimeters.</span>
<span class="sd">            - wdir: Wind direction in degrees.</span>
<span class="sd">            - wspd: Wind speed in km/h.</span>
<span class="sd">            - wpgt: Wind gust in km/h.</span>
<span class="sd">            - pres: Sea-level air pressure in hPa.</span>
<span class="sd">            - tsun: Sunshine duration in minutes.</span>
<span class="sd">            - snow: Snowfall in millimeters.</span>
<span class="sd">            - rhum: Relative humidity in percent.</span>
<span class="sd">            - coco: Weather condition code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fetch hourly data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Hourly</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>

    <span class="c1"># Reset the index</span>
    <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_weather.process_hourly_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_hourly_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process raw hourly weather data by cleaning and formatting.</p>
<p>This function drops unnecessary columns, renames the remaining columns to more descriptive names,
and converts the 'time' column to a datetime format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing raw hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the processed hourly weather data with the following columns:
- Time: Datetime of the record.
- Temperature (Â°C): Temperature in degrees Celsius.
- Wind Speed (km/h): Wind speed in km/h.
- Relative Humidity (%): Relative humidity in percent.
- coco_2: Weather condition code.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_hourly_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process raw hourly weather data by cleaning and formatting.</span>

<span class="sd">    This function drops unnecessary columns, renames the remaining columns to more descriptive names,</span>
<span class="sd">    and converts the &#39;time&#39; column to a datetime format.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): A DataFrame containing raw hourly weather data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the processed hourly weather data with the following columns:</span>
<span class="sd">            - Time: Datetime of the record.</span>
<span class="sd">            - Temperature (Â°C): Temperature in degrees Celsius.</span>
<span class="sd">            - Wind Speed (km/h): Wind speed in km/h.</span>
<span class="sd">            - Relative Humidity (%): Relative humidity in percent.</span>
<span class="sd">            - coco_2: Weather condition code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="c1"># Drop unnecessary columns</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">,</span> <span class="s1">&#39;wpgt&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;snow&#39;</span><span class="p">,</span> <span class="s1">&#39;tsun&#39;</span><span class="p">,</span> <span class="s1">&#39;prcp&#39;</span><span class="p">])</span>

    <span class="c1"># Rename columns for clarity</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature (Â°C)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;wspd&#39;</span><span class="p">:</span> <span class="s1">&#39;Wind Speed (km/h)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rhum&#39;</span><span class="p">:</span> <span class="s1">&#39;Relative Humidity (%)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;coco&#39;</span><span class="p">:</span> <span class="s1">&#39;coco_2&#39;</span>
    <span class="p">})</span>


    <span class="c1"># Convert the &#39;Time&#39; column to datetime format</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    <span class="c1"># Map weather condition codes to new codes</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coco_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coco_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">coco_to_coco_2_mapping</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_weather.source_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data
for the specified time period, processes the data to extract necessary weather parameters,
and saves the processed data to a CSV file.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_weather.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data</span>
<span class="sd">    for the specified time period, processes the data to extract necessary weather parameters,</span>
<span class="sd">    and saves the processed data to a CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sourcing weather data for </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_time</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="c1"># Create a Point object for the Bavarian Forest National Park entry</span>
    <span class="n">bavarian_forest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">LATITUDE</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">LONGITUDE</span><span class="p">)</span>

    <span class="c1"># Fetch hourly data for the location</span>
    <span class="n">hourly_data</span> <span class="o">=</span> <span class="n">get_hourly_data</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

    <span class="c1"># Process the hourly data to extract and format necessary weather parameters</span>
    <span class="n">sourced_hourly_data</span> <span class="o">=</span> <span class="n">process_hourly_data</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">sourced_hourly_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Preprocessing -->



<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_daily_max_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_daily_max_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add columns to the DataFrame that show the maximum daily value for each weather characteristic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with 'Time' and multiple weather-related columns.
- 'Time': Datetime column with timestamps.
- columns (list of str): List of column names to compute the daily maximum values for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame with new columns that contain the maximum values for each day,
          repeated for every hour.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_daily_max_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add columns to the DataFrame that show the maximum daily value for each weather characteristic.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): DataFrame with &#39;Time&#39; and multiple weather-related columns.</span>
<span class="sd">            - &#39;Time&#39;: Datetime column with timestamps.</span>
<span class="sd">            - columns (list of str): List of column names to compute the daily maximum values for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame with new columns that contain the maximum values for each day,</span>
<span class="sd">                      repeated for every hour.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure the Time column is in datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

    <span class="c1"># Extract the date from the Time column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

    <span class="c1"># Create a DataFrame to store daily max values</span>
    <span class="n">daily_max_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="c1"># Rename columns to indicate they are daily maximum values</span>
    <span class="n">daily_max_df</span> <span class="o">=</span> <span class="n">daily_max_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Daily_Max_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">})</span>

    <span class="c1"># Merge the daily max values back into the original DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">daily_max_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_moving_z_scores" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_moving_z_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add moving z-score columns for weather characteristics based on their daily maximum values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with 'Time' and daily maximum columns.
- 'Time': Datetime column with timestamps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>columns</code></td>
            <td>
                  <code>list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to compute the moving z-scores for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the moving window in days.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame with new columns that contain the moving z-scores for each column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_moving_z_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add moving z-score columns for weather characteristics based on their daily maximum values.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): DataFrame with &#39;Time&#39; and daily maximum columns.</span>
<span class="sd">            - &#39;Time&#39;: Datetime column with timestamps.</span>
<span class="sd">        columns (list of str): List of column names to compute the moving z-scores for.</span>
<span class="sd">        window_size (int): Size of the moving window in days.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame with new columns that contain the moving z-scores for each column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure the Time column is in datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

    <span class="c1"># Extract unique dates with daily max values</span>
    <span class="n">daily_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Daily_Max_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="c1"># Calculate rolling mean and standard deviation for daily max values</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">daily_max_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Daily_Max_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="c1"># Calculate rolling mean and standard deviation over the specified window size</span>
        <span class="n">daily_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rolling_Mean_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_df</span><span class="p">[</span><span class="n">daily_max_col</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">daily_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rolling_Std_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_df</span><span class="p">[</span><span class="n">daily_max_col</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># Calculate the z-score</span>
        <span class="n">daily_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ZScore_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">daily_df</span><span class="p">[</span><span class="n">daily_max_col</span><span class="p">]</span> <span class="o">-</span> <span class="n">daily_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rolling_Mean_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span> <span class="o">/</span>
            <span class="n">daily_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rolling_Std_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Drop the rolling mean and std columns as they are intermediate calculations</span>
        <span class="n">daily_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rolling_Mean_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Rolling_Std_</span><span class="si">{</span><span class="n">daily_max_col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Merge the z-scores back into the original hourly DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">daily_df</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ZScore_Daily_Max_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="c1"># List of columns to drop (daily max columns)</span>
    <span class="n">daily_max_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Daily_Max_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

    <span class="c1"># Drop the daily max columns from the main DataFrame</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">daily_max_columns</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.add_nearest_holiday_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_nearest_holiday_distance</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add columns to the DataFrame calculating the distance to the nearest holiday for both 'Feiertag_Bayern' and 'Feiertag_CZ'.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with 'Time', 'Feiertag_Bayern', and 'Feiertag_CZ' columns.
- 'Time': Datetime column with timestamps.
- 'Feiertag_Bayern': Boolean column indicating if the date is a holiday in Bayern.
- 'Feiertag_CZ': Boolean column indicating if the date is a holiday in CZ.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame with two new columns:
- 'Distance_to_Nearest_Holiday_Bayern': Distance in days to the nearest holiday in Bayern for each day/row.
- 'Distance_to_Nearest_Holiday_CZ': Distance in days to the nearest holiday in CZ for each day/row.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_nearest_holiday_distance</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add columns to the DataFrame calculating the distance to the nearest holiday for both &#39;Feiertag_Bayern&#39; and &#39;Feiertag_CZ&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): DataFrame with &#39;Time&#39;, &#39;Feiertag_Bayern&#39;, and &#39;Feiertag_CZ&#39; columns.</span>
<span class="sd">            - &#39;Time&#39;: Datetime column with timestamps.</span>
<span class="sd">            - &#39;Feiertag_Bayern&#39;: Boolean column indicating if the date is a holiday in Bayern.</span>
<span class="sd">            - &#39;Feiertag_CZ&#39;: Boolean column indicating if the date is a holiday in CZ.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame with two new columns:</span>
<span class="sd">            - &#39;Distance_to_Nearest_Holiday_Bayern&#39;: Distance in days to the nearest holiday in Bayern for each day/row.</span>
<span class="sd">            - &#39;Distance_to_Nearest_Holiday_CZ&#39;: Distance in days to the nearest holiday in CZ for each day/row.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure the Time column is in datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

    <span class="c1"># Extract date from Time column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

    <span class="c1"># Extract unique dates for holidays</span>
    <span class="n">bayern_holidays</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">]][</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">cz_holidays</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Feiertag_CZ&#39;</span><span class="p">]][</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Create a DataFrame with unique dates</span>
    <span class="n">dates_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()})</span>


    <span class="k">def</span> <span class="nf">get_nearest_holiday_distance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">holidays</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the distance in days to the nearest holiday.</span>

<span class="sd">        Args:</span>
<span class="sd">            date (pd.Timestamp): The date for which to calculate the distance.</span>
<span class="sd">            holidays (np.ndarray): Array of holiday dates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Distance in days to the nearest holiday, or NaN if no holidays are provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">holidays</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">nearest_holiday</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">date</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">holidays</span><span class="p">))</span><span class="o">.</span><span class="n">days</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">nearest_holiday</span>

    <span class="c1"># Apply the function to calculate distances for both sets of holidays</span>
    <span class="n">dates_df</span><span class="p">[</span><span class="s1">&#39;Distance_to_Nearest_Holiday_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_nearest_holiday_distance</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">bayern_holidays</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">dates_df</span><span class="p">[</span><span class="s1">&#39;Distance_to_Nearest_Holiday_CZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_nearest_holiday_distance</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">cz_holidays</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Merge the distances back with the original DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dates_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.load_csv_files_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.
Args:
    path (str): The path to the CSV files on AWS S3.
    **kwargs: Additional arguments to pass to the read_csv function.
Returns:
    pd.DataFrame: The DataFrame containing the data from the CSV files.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1">#the low_memory parameter is set to False to avoid an error with dtypes in some of the files</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.slice_at_first_non_null" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">slice_at_first_non_null</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Slices the DataFrame starting at the first non-null value in the 'Feiertag_Bayern' column.</p>
<p>We don't have data for holidays in 2016, so the function finds the index of the first non-null 
value in the 'Feiertag_Bayern' column and returns the DataFrame sliced from that index onward.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the 'Feiertag_Bayern' column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The sliced DataFrame starting from the first non-null value in 'Feiertag_Bayern'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">slice_at_first_non_null</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slices the DataFrame starting at the first non-null value in the &#39;Feiertag_Bayern&#39; column.</span>

<span class="sd">    We don&#39;t have data for holidays in 2016, so the function finds the index of the first non-null </span>
<span class="sd">    value in the &#39;Feiertag_Bayern&#39; column and returns the DataFrame sliced from that index onward.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): DataFrame containing the &#39;Feiertag_Bayern&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: The sliced DataFrame starting from the first non-null value in &#39;Feiertag_Bayern&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Find the index of the first non-null value in the &#39;Feiertag_Bayern&#39; column</span>
    <span class="n">first_non_null_index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first_valid_index</span><span class="p">()</span>

    <span class="c1"># Slice the DataFrame from the first non-null index onward and create a copy to avoid warnings</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_non_null_index</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.features_zscoreweather_distanceholidays.write_csv_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual CSV file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/features_zscoreweather_distanceholidays.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual CSV file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_csv function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.impute_missing_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check data quality - if the occupancy is greater than the capacity of the parking space</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check data quality - if the occupancy is greater than the capacity of the parking space</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the capacity is always smaller than the occupancy</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
        <span class="c1"># remove the rows where the occupancy is greater than the capacity</span>
        <span class="c1"># print the row numbers where the occupancy is greater than the capacity</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The occupancy is greater than the capacity&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows where the occupancy is greater than the capacity:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]])</span>
        <span class="c1"># impute_occupancy_values(data)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check data quality - if the occupancy rate is greater than 100</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check data quality - if the occupancy rate is greater than 100</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the occupancy rate is greater than 100</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">100.00</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The occupancy rate is greater than 100&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows where the occupancy rate is greater than 100:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">],</span><span class="n">sensor</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check missing data per sensor</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check missing data per sensor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">missing_data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">missing_data</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill missing values in the data</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill missing values in the data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fill all the missing values with linear interpolation</span>
    <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">impute_occupancy_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Impute occupancy values where the occupancy is greater than the capacity</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">impute_occupancy_values</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impute occupancy values where the occupancy is greater than the capacity</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Impute the occupancy values where the occupancy is greater than the capacity</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">else</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputed occupancy values:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main function to run the script</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to run the script</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">,</span> <span class="n">paths_to_parking_data</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>

        <span class="c1"># Missing data for each sensor</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">....................&quot;</span><span class="p">)</span>
        <span class="n">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">)</span>

        <span class="c1"># check if the capacity is always smaller than the occupancy</span>
        <span class="n">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the rows where the occupancy rate is greater than 100</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the rows where the occupancy rate is greater than 100</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;./outputs&#39;</span><span class="p">,</span><span class="s1">&#39;parking_data_final&#39;</span><span class="p">,</span><span class="s1">&#39;data_quality_issues&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s1">_higher_occupancy_rate.csv&#39;</span><span class="p">)</span>

    <span class="c1"># make the output directory if it doesn&#39;t exist</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Save the rows where the occupancy rate is greater than 100</span>
    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved the rows where the occupancy rate is greater than 100 for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_datetimeindex</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prepare DataFrame by ensuring the index is a DateTimeIndex, resampling to hourly frequency,
and handling missing values.</p>
<p>Parameters:
- df: DataFrame containing the data.
- "Time": Name of the timestamp column to convert and set as the index.</p>
<p>Returns:
- df: DataFrame resampled to hourly frequency with missing values handled.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_datetimeindex</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare DataFrame by ensuring the index is a DateTimeIndex, resampling to hourly frequency,</span>
<span class="sd">    and handling missing values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df: DataFrame containing the data.</span>
<span class="sd">    - &quot;Time&quot;: Name of the timestamp column to convert and set as the index.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - df: DataFrame resampled to hourly frequency with missing values handled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure the timestamp column is converted to datetime if it&#39;s not already the index</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">])</span>
    <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Ensure the index is a DateTimeIndex</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index must be a DateTimeIndex.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.get_joined_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_joined_dataframe</span><span class="p">(</span><span class="n">weather_data</span><span class="p">,</span> <span class="n">visitor_count_data</span><span class="p">,</span> <span class="n">visitorcenter_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main function to run the data joining pipeline.</p>
<p>This function loads the visitor count, visitor center and weather data, preprocesses them and joins them into one dataframe.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The joined data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_joined_dataframe</span><span class="p">(</span><span class="n">weather_data</span><span class="p">,</span> <span class="n">visitor_count_data</span><span class="p">,</span> <span class="n">visitorcenter_data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to run the data joining pipeline.</span>

<span class="sd">    This function loads the visitor count, visitor center and weather data, preprocesses them and joins them into one dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The joined data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">weather_data</span><span class="p">,</span> <span class="n">visitor_count_data</span><span class="p">,</span> <span class="n">visitorcenter_data</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>
        <span class="n">create_datetimeindex</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">joined_data</span> <span class="o">=</span> <span class="n">join_dataframes</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">joined_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.join_dataframes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_dataframes</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Joins a list of DataFrames using an outer join along the columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df_list</code></td>
            <td>
                  <code>list of pd.DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of pandas DataFrames to join.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A single DataFrame resulting from concatenating all input DataFrames along columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">join_dataframes</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Joins a list of DataFrames using an outer join along the columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_list (list of pd.DataFrame): A list of pandas DataFrames to join.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A single DataFrame resulting from concatenating all input DataFrames along columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span> <span class="n">df_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data"></a>
    <div class="doc doc-contents first">

        <p>Clean historic sensor data from 2016 to 2024. In the docstring of every function you can check what it does and the assumptions that were made.</p>
<p>Usage:
- Change the global variables section if needed
    - Fill your AWS credentiales</p>
<p>Output:
- Returns the preprocessed data</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.calculate_traffic_metrics_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_traffic_metrics_abs</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function calculates several traffic metrics and adds them to the DataFrame:
- <code>traffic_abs</code>: The sum of all INs and OUTs for every sensor
- <code>sum_IN_abs</code>: The sum of all columns containing 'IN' in their names.
- <code>sum_OUT_abs</code>: The sum of all columns containing 'OUT' in their names.
- <code>diff_abs</code>: The difference between <code>sum_IN_abs</code> and <code>sum_OUT_abs</code>.
- <code>occupancy_abs</code>: The cumulative sum of <code>diff_abs</code>, representing the occupancy over time.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing traffic data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The DataFrame with additional columns for absolute traffic metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_traffic_metrics_abs</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      This function calculates several traffic metrics and adds them to the DataFrame:</span>
<span class="sd">    - `traffic_abs`: The sum of all INs and OUTs for every sensor</span>
<span class="sd">    - `sum_IN_abs`: The sum of all columns containing &#39;IN&#39; in their names.</span>
<span class="sd">    - `sum_OUT_abs`: The sum of all columns containing &#39;OUT&#39; in their names.</span>
<span class="sd">    - `diff_abs`: The difference between `sum_IN_abs` and `sum_OUT_abs`.</span>
<span class="sd">    - `occupancy_abs`: The cumulative sum of `diff_abs`, representing the occupancy over time.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): DataFrame containing traffic data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: The DataFrame with additional columns for absolute traffic metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate total traffic</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;traffic_abs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;IN|OUT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sum of &#39;IN&#39; columns</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sum_IN_abs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;IN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sum of &#39;OUT&#39; columns</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sum_OUT_abs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;OUT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_and_impute_times" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_impute_times</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects repeated timestamps caused by a 2-hour interval that is indicative of a daylight saving.</p>
<p>The function operates under the following assumptions:
1. By default every interval should be of 1 hour
2. If any interval differ from this, particularly the repeated timestamp is corrected by subtracting one hour.
3. The data values for the corrected timestamp are then imputed from the next available row.
4. 2017 is an odd year where the null row is not the one with the 2 hours interval, but the one with 0. We fixed this manually for this specific rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing a 'Time' column with datetime-like values and other associated data columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The corrected DataFrame with timestamps set as the index and sorted chronologically.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the 'Time' column is missing from the DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an index out of range occurs due to imputation attempts beyond the DataFrame bounds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_impute_times</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects repeated timestamps caused by a 2-hour interval that is indicative of a daylight saving.</span>

<span class="sd">    The function operates under the following assumptions:</span>
<span class="sd">    1. By default every interval should be of 1 hour</span>
<span class="sd">    2. If any interval differ from this, particularly the repeated timestamp is corrected by subtracting one hour.</span>
<span class="sd">    3. The data values for the corrected timestamp are then imputed from the next available row.</span>
<span class="sd">    4. 2017 is an odd year where the null row is not the one with the 2 hours interval, but the one with 0. We fixed this manually for this specific rows.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): A DataFrame containing a &#39;Time&#39; column with datetime-like values and other associated data columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: The corrected DataFrame with timestamps set as the index and sorted chronologically.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the &#39;Time&#39; column is missing from the DataFrame.</span>
<span class="sd">        KeyError: If an index out of range occurs due to imputation attempts beyond the DataFrame bounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Swap values of specific rows to correct data misalignment</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">54603</span><span class="p">,</span> <span class="mi">54602</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">54602</span><span class="p">,</span> <span class="mi">54603</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Sort DataFrame by &#39;Time&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Identify intervals where there is a 2 hours gap</span>
    <span class="n">intervals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">index_wrong_time</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="n">intervals</span> <span class="o">==</span> <span class="s2">&quot;0 days 02:00:00&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Impute values from the next row and adjust &#39;Time&#39; column</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index_wrong_time</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Adjust for daylight saving</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Time&#39;</span><span class="p">]</span>  <span class="c1"># Impute values from the next row</span>

    <span class="c1"># Set &#39;Time&#39; as index and sort by index</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_non_replaced_sensors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_non_replaced_sensors</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Replaces data with NaN for non-replaced sensors in the DataFrame based on specified timestamps. A dictionary is provided where keys are timestamps as strings and values are lists of column names that should be set to NaN if the index is earlier than the timestamp.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to be corrected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame with corrected sensor data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_non_replaced_sensors</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces data with NaN for non-replaced sensors in the DataFrame based on specified timestamps. A dictionary is provided where keys are timestamps as strings and values are lists of column names that should be set to NaN if the index is earlier than the timestamp.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to be corrected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame with corrected sensor data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dict_non_replaced</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;2020-07-30 00:00:00&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lusen 1 PYRO IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusen 1 PYRO OUT&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;2022-12-20 00:00:00&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lusen 3 IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusen 3 OUT&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;2022-10-12 00:00:00&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Gsenget IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Gsenget OUT&#39;</span><span class="p">]}</span>


    <span class="c1"># Iterate over the dictionary of non-replaced sensors</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">dict_non_replaced</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Convert the timestamp key from string to datetime object</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># Set values to NaN for specified columns where the index is earlier than the given timestamp</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Out of place values were turn to NaN for Lusen 1 PYRO, Lusen 3 and Gsenget&quot;</span><span class="p">)</span>    

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.correct_overlapping_sensor_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_overlapping_sensor_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects sensor overlapping data by setting specific values to NaN based on replacement dates. Also filters the DataFrame to include only rows with an index timestamp on or after "2016-05-10 03:00:00". This is 3am after the installing date for the first working sensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing sensor data to be corrected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame with corrected sensor data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_overlapping_sensor_data</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects sensor overlapping data by setting specific values to NaN based on replacement dates. Also filters the DataFrame to include only rows with an index timestamp on or after &quot;2016-05-10 03:00:00&quot;. This is 3am after the installing date for the first working sensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame containing sensor data to be corrected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame with corrected sensor data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the replacement dates and columns for different sensor types</span>
    <span class="n">replacement_dates</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;trinkwassertalsperre&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-06-18 00:00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bucina&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-05-28 00:00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;falkenstein 1&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-12-22 12:00:00&#39;</span>
    <span class="p">}</span>

    <span class="n">multi_columns_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;trinkwassertalsperre&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI FahrrÃ¤der IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI FahrrÃ¤der OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre_MULTI OUT&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;bucina&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Bucina_Multi OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina_Multi FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina_Multi FahrrÃ¤der IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina_Multi FahrrÃ¤der OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina_Multi FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina_Multi IN&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;falkenstein 1&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Falkenstein 1 OUT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Falkenstein 1 IN&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">pyro_columns_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;trinkwassertalsperre&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Trinkwassertalsperre PYRO IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Trinkwassertalsperre PYRO OUT&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;bucina&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Bucina PYRO IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Bucina PYRO OUT&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;falkenstein 1&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Falkenstein 1 PYRO IN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Falkenstein 1 PYRO OUT&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Process each sensor type based on the predefined dictionaries</span>
    <span class="k">for</span> <span class="n">sensor_type</span> <span class="ow">in</span> <span class="n">replacement_dates</span><span class="p">:</span>
        <span class="n">replacement_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">replacement_dates</span><span class="p">[</span><span class="n">sensor_type</span><span class="p">])</span>
        <span class="n">multi_columns</span> <span class="o">=</span> <span class="n">multi_columns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sensor_type</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">pyro_columns</span> <span class="o">=</span> <span class="n">pyro_columns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sensor_type</span><span class="p">,</span> <span class="p">[])</span>

        <span class="c1"># Set to NaN the values in &#39;multi_columns&#39; for dates on or before the replacement date</span>
        <span class="k">if</span> <span class="n">multi_columns</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">replacement_date</span><span class="p">,</span> <span class="n">multi_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># Set to NaN the values in &#39;pyro_columns&#39; for dates after the replacement date</span>
        <span class="k">if</span> <span class="n">pyro_columns</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">replacement_date</span><span class="p">,</span> <span class="n">pyro_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Slice data before date because  there were no sensors installed</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s2">&quot;2016-05-10 03:00:00&quot;</span><span class="p">]</span>


    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fixed overlapping values for replaced sensors&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.fix_columns_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fix_columns_names</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Processes the given DataFrame by renaming columns, dropping specified columns, and creating a new column for Bucina_Multi IN by summing the Bucina_Multi FahrrÃ¤der IN and Bucina_Multi FuÃŸgÃ¤nger IN columns. .</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rename</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary where the keys are existing column names and the values are the new column names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>drop</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names that should be removed from the DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>create</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the new column that will be created by summing the "Bucina_Multi FahrrÃ¤der IN" 
          and "Bucina_Multi FuÃŸgÃ¤nger IN" columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The modified DataFrame with the specified changes applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_columns_names</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the given DataFrame by renaming columns, dropping specified columns, and creating a new column for Bucina_Multi IN by summing the Bucina_Multi FahrrÃ¤der IN and Bucina_Multi FuÃŸgÃ¤nger IN columns. .</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to be modified.</span>
<span class="sd">        rename (dict): A dictionary where the keys are existing column names and the values are the new column names.</span>
<span class="sd">        drop (list): A list of column names that should be removed from the DataFrame.</span>
<span class="sd">        create (str): The name of the new column that will be created by summing the &quot;Bucina_Multi FahrrÃ¤der IN&quot; </span>
<span class="sd">                      and &quot;Bucina_Multi FuÃŸgÃ¤nger IN&quot; columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The modified DataFrame with the specified changes applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#lists and dictionaries for columns that need to be dropped or renamed</span>

    <span class="n">drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BrechhÃ¤uslau FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span> <span class="s1">&#39;BrechhÃ¤uslau FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldhausreibe Channel 1 IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldhausreibe Channel 2 OUT&#39;</span><span class="p">]</span> <span class="c1">#Waldhausreibe Channel 1 (IN and OUT) had a total sum of values of 10 and 13. BrechhÃ¤uslau columns were duplicated.</span>

    <span class="n">rename</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Bucina IN&#39;</span><span class="p">:</span> <span class="s1">&#39;Bucina PYRO IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Bucina OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;Bucina PYRO OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Gsenget IN.1&#39;</span><span class="p">:</span> <span class="s1">&#39;Gsenget FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Gsenget OUT.1&#39;</span><span class="p">:</span> <span class="s1">&#39;Gsenget FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;GfÃ¤ll FuÃŸgÃ¤nger IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;GfÃ¤ll IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;GfÃ¤ll FuÃŸgÃ¤nger OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;GfÃ¤ll OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;FredenbrÃ¼cke FuÃŸgÃ¤nger IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;FredenbrÃ¼cke IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;FredenbrÃ¼cke FuÃŸgÃ¤nger OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;FredenbrÃ¼cke OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe FuÃŸgÃ¤nger IN&#39;</span><span class="p">:</span> <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe IN&#39;</span> <span class="p">,</span>
          <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe FuÃŸgÃ¤nger OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;DiensthÃ¼ttenstraÃŸe OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;RacheldiensthÃ¼tte Cyclist OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;RacheldiensthÃ¼tte FahrrÃ¤der OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;RacheldiensthÃ¼tte Pedestrian IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;RacheldiensthÃ¼tte FuÃŸgÃ¤nger IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;RacheldiensthÃ¼tte Pedestrian OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;RacheldiensthÃ¼tte FuÃŸgÃ¤nger OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;SagwassersÃ¤ge FuÃŸgÃ¤nger IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;SagwassersÃ¤ge IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;SagwassersÃ¤ge FuÃŸgÃ¤nger OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;SagwassersÃ¤ge OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;SchwarzbachbrÃ¼cke FuÃŸgÃ¤nger IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;SchwarzbachbrÃ¼cke IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;SchwarzbachbrÃ¼cke FuÃŸgÃ¤nger OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;SchwarzbachbrÃ¼cke OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NPZ_Falkenstein IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 1 PYRO IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NPZ_Falkenstein OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 1 PYRO OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Falkenstein_1 FuÃŸgÃ¤nger zum Parkplatz&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 1 OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Falkenstein_1 FuÃŸgÃ¤nger zum HZW&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 1 IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Falkenstein_2 FuÃŸgÃ¤nger In Richtung Parkplatz&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 2 OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Falkenstein_2 FuÃŸgÃ¤nger In Richtung TFG&#39;</span> <span class="p">:</span> <span class="s1">&#39;Falkenstein 2 IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lusen 1 PYRO IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lusen 1 PYRO OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_1 FuÃŸgÃ¤nger Richtung TFG&#39;</span><span class="p">:</span> <span class="s1">&#39;Lusen 1 EVO IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_1 FuÃŸgÃ¤nger Richtung Parkplatz&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lusen 1 EVO OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_2 FuÃŸgÃ¤nger Richtung VÃ¶gel am Waldrand&#39;</span><span class="p">:</span> <span class="s1">&#39;Lusen 2 IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_2 FuÃŸgÃ¤nger Richtung Parkplatz&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lusen 2 OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_3 TFG Lusen 3 IN&#39;</span><span class="p">:</span> <span class="s1">&#39;Lusen 3 IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;TFG_Lusen_3 TFG Lusen 3 OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;Lusen 3 OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;WaldspielgelÃ¤nde_1 IN&#39;</span><span class="p">:</span> <span class="s1">&#39;WaldspielgelÃ¤nde IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;WaldspielgelÃ¤nde_1 OUT&#39;</span><span class="p">:</span> <span class="s1">&#39;WaldspielgelÃ¤nde OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Wistlberg FuÃŸgÃ¤nger IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;Wistlberg IN&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Wistlberg FuÃŸgÃ¤nger OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;Wistlberg OUT&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Trinkwassertalsperre IN&#39;</span> <span class="p">:</span> <span class="s1">&#39;Trinkwassertalsperre PYRO IN&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Trinkwassertalsperre OUT&#39;</span> <span class="p">:</span> <span class="s1">&#39;Trinkwassertalsperre PYRO OUT&#39;</span>
          <span class="p">}</span>


    <span class="c1"># Rename columns according to the provided mapping</span>

    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">rename</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rename</span><span class="p">),</span> <span class="s1">&#39; columns were renamed&#39;</span><span class="p">)</span>

    <span class="c1"># Remove the specified columns from the DataFrame</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop</span><span class="p">),</span> <span class="s1">&#39; repeated columns were dropped&#39;</span><span class="p">)</span>

    <span class="c1"># Add Bucina_Multi IN column by summing Fahrraeder and Fussgaenger columns</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Bucina_Multi IN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bucina_Multi FahrrÃ¤der IN&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bucina_Multi FuÃŸgÃ¤nger IN&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bucina_Multi IN column was created&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.handle_outliers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Transform to NaN every value higher than 800. During exploration we found that values over that are outliers. There were only 6 rows with any count over 800</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with values to be turned to NaN.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The modified DataFrame with values over 800 turned to NaN</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform to NaN every value higher than 800. During exploration we found that values over that are outliers. There were only 6 rows with any count over 800</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): DataFrame with values to be turned to NaN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: The modified DataFrame with values over 800 turned to NaN</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.merge_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Merges columns from replaced sensors in the DataFrame into new combined columns based on a predefined mapping
and drops the original columns after merging. Additionally, drops columns with names containing "FahrrÃ¤der" or "FuÃŸgÃ¤nger" as we will not use that distinction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing columns to be merged.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The modified DataFrame with the new merged columns, original columns removed, and FahrrÃ¤der or FuÃŸgÃ¤nger columns dropped.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges columns from replaced sensors in the DataFrame into new combined columns based on a predefined mapping</span>
<span class="sd">    and drops the original columns after merging. Additionally, drops columns with names containing &quot;FahrrÃ¤der&quot; or &quot;FuÃŸgÃ¤nger&quot; as we will not use that distinction.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): A DataFrame containing columns to be merged.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: The modified DataFrame with the new merged columns, original columns removed, and FahrrÃ¤der or FuÃŸgÃ¤nger columns dropped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merge_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Bucina MERGED IN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bucina PYRO IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi IN&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Bucina MERGED OUT&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bucina PYRO OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bucina_Multi OUT&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Falkenstein 1 MERGED IN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Falkenstein 1 PYRO IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Falkenstein 1 IN&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Falkenstein 1 MERGED OUT&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Falkenstein 1 PYRO OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Falkenstein 1 OUT&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Lusen 1 MERGED IN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lusen 1 PYRO IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusen 1 EVO IN&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Lusen 1 MERGED OUT&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lusen 1 PYRO OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusen 1 EVO OUT&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Trinkwassertalsperre MERGED IN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Trinkwassertalsperre PYRO IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Trinkwassertalsperre_MULTI IN&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Trinkwassertalsperre MERGED OUT&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Trinkwassertalsperre PYRO OUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Trinkwassertalsperre_MULTI OUT&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Iterate over each item in the dictionary to merge columns</span>
    <span class="k">for</span> <span class="n">new_col</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">merge_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Combine the two columns into one using the first non-null value</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

    <span class="c1"># Drop the original columns used for merging</span>
    <span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">merge_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_to_drop</span><span class="p">)</span>

    <span class="c1"># Drop columns with names containing &quot;FahrrÃ¤der&quot; or &quot;FuÃŸgÃ¤nger&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;FahrrÃ¤der|FuÃŸgÃ¤nger&quot;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.parse_german_dates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_german_dates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">date_column_name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses German dates in the specified date column of the DataFrame using regex,
including hours and minutes if available.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>date_column_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the date column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame with parsed German dates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_german_dates</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses German dates in the specified date column of the DataFrame using regex,</span>
<span class="sd">    including hours and minutes if available.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame containing the date column.</span>
<span class="sd">        date_column_name (str): The name of the date column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame with parsed German dates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define a mapping of German month names to their numeric values</span>
    <span class="n">month_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Jan.&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Feb.&quot;</span><span class="p">:</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MÃ¤rz&quot;</span><span class="p">:</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Apr.&quot;</span><span class="p">:</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mai&quot;</span><span class="p">:</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juni&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Juli&quot;</span><span class="p">:</span> <span class="s2">&quot;07&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Aug.&quot;</span><span class="p">:</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sep.&quot;</span><span class="p">:</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Okt.&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nov.&quot;</span><span class="p">:</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dez.&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">}</span>

    <span class="c1"># Create a regex pattern for replacing months and capturing time</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d{1,2})\.\s*(&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">month_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)\s*(\d</span><span class="si">{4}</span><span class="s1">)\s*(\d</span><span class="si">{2}</span><span class="s1">):(\d</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Function to replace the month in the matched string and keep the time part</span>
    <span class="k">def</span> <span class="nf">replace_month</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">month_map</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">minute</span><span class="si">}</span><span class="s2">:00&quot;</span>

    <span class="c1"># Apply regex replacement and convert to datetime</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">replace_month</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">date_column_name</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_historic_visitor_count_data.write_csv_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual CSV file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_historic_visitor_count_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual CSV file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_csv function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_and_translate_day_of_week" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Wochentag' that represents the day of the week in German.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with updated 'Wochentag' column in German.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Wochentag&#39; that represents the day of the week in German.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with updated &#39;Wochentag&#39; column in German.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new column &#39;Wochentag2&#39; with the day of the week in English</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Define the translation mapping from English to German</span>
    <span class="n">translation_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Monday&#39;</span><span class="p">:</span> <span class="s1">&#39;Montag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Tuesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Dienstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Wednesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Mittwoch&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Thursday&#39;</span><span class="p">:</span> <span class="s1">&#39;Donnerstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Friday&#39;</span><span class="p">:</span> <span class="s1">&#39;Freitag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Saturday&#39;</span><span class="p">:</span> <span class="s1">&#39;Samstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sunday&#39;</span><span class="p">:</span> <span class="s1">&#39;Sonntag&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Replace the English day names in the &#39;Wochentag2&#39; column with German names</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">translation_map</span><span class="p">)</span>

    <span class="c1"># Remove the &#39;Wochentag&#39; column from the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Rename &#39;Wochentag2&#39; to &#39;Wochentag&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">:</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_date_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create new columns for day, month, and year from a date column in the DataFrame.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with additional columns for day, month, and year.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create new columns for day, month, and year from a date column in the DataFrame.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with additional columns for day, month, and year.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert &#39;Datum&#39; column to datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">])</span>

    <span class="c1"># Add new columns for day, month, and year</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

    <span class="c1"># Change data types for modeling purposes</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_season_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Jahreszeit' in the DataFrame based on the month variable.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Monat' column with month information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Jahreszeit' column representing the season.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Jahreszeit&#39; in the DataFrame based on the month variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Monat&#39; column with month information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Jahreszeit&#39; column representing the season.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the seasons based on the month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;FrÃ¼hling&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Sommer&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Herbst&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Winter&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">else</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="p">)</span>

    <span class="c1"># Convert the &#39;Jahreszeit&#39; column to category type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.add_weekend_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new binary column 'Wochenende' indicating whether the day is a weekend.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Wochentag' column with German day names.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Wochenende' column indicating weekend status.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new binary column &#39;Wochenende&#39; indicating whether the day is a weekend.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Wochentag&#39; column with German day names.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Wochenende&#39; column indicating weekend status.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new binary column &#39;Wochenende&#39; where True represents weekend days (Saturday, Sunday)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Samstag&#39;</span><span class="p">,</span> <span class="s1">&#39;Sonntag&#39;</span><span class="p">])</span>

    <span class="c1"># Convert the &#39;Wochenende&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_schulferien" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects a typo in the 'Schulferien_Bayern' column and converts it to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Schulferien_Bayern' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with corrected 'Schulferien_Bayern' values and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects a typo in the &#39;Schulferien_Bayern&#39; column and converts it to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Schulferien_Bayern&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with corrected &#39;Schulferien_Bayern&#39; values and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Correct the typo in specific value for column &#39;Schulferien_Bayern&#39; (from `10` to `0`)</span>
    <span class="n">df_visitcenters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2017-04-30&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Change &#39;Schulferien_Bayern&#39; to bool type</span>
    <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_visitcenters</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_and_convert_wgm_geoeffnet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'WGM_geoeffnet' column by replacing the value 11 with 1.
Converts the column to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'WGM_geoeffnet' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'WGM_geoeffnet' corrected and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;WGM_geoeffnet&#39; column by replacing the value 11 with 1.</span>
<span class="sd">    Converts the column to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;WGM_geoeffnet&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;WGM_geoeffnet&#39; corrected and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Replace single value of 11 with 1 in &#39;WGM_geoeffnet&#39; column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Convert &#39;WGM_geoeffnet&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.correct_besuchszahlen_heh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'Besuchszahlen_HEH' column by rounding up values with non-zero fractional parts to the nearest whole number.
Converts the column to Int64 type to retain NaN values.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Besuchszahlen_HEH' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'Besuchszahlen_HEH' corrected and converted to Int64 type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;Besuchszahlen_HEH&#39; column by rounding up values with non-zero fractional parts to the nearest whole number.</span>
<span class="sd">    Converts the column to Int64 type to retain NaN values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Besuchszahlen_HEH&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;Besuchszahlen_HEH&#39; corrected and converted to Int64 type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Apply np.ceil() to round up values with non-zero fractional parts to nearest whole number</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span>
    <span class="p">)</span>

    <span class="c1"># Convert &#39;Besuchszahlen_HEH&#39; to Int64 to retain NaN values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.create_hourly_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing daily data with a 'Datum' column representing dates.</p>
<p>Returns:
pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing daily data with a &#39;Datum&#39; column representing dates.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a new DataFrame where each day is expanded into 24 rows (one per hour)</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">24</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Create the hourly timestamps by adding hours to the &#39;Datum&#39; column</span>
    <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">(),</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

    <span class="c1"># Rename columns for clarity</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df_hourly</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.detect_outliers_std" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect outliers in a specific column of the DataFrame using the standard deviation method.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the column to check.
column (str): Name of the column to check for outliers.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect outliers in a specific column of the DataFrame using the standard deviation method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the column to check.</span>
<span class="sd">    column (str): Name of the column to check for outliers.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="c1"># Define the bounds for outliers</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>

    <span class="c1"># Identify outliers</span>
    <span class="n">outliers_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">outliers_mask</span><span class="p">][[</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.handle_outliers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect and handle outliers for a list of columns by replacing them with NaN.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the columns to check.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect and handle outliers for a list of columns by replacing them with NaN.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the columns to check.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">]</span>

    <span class="c1">#outliers = {}</span>

    <span class="c1"># Detect outliers and store in dictionary</span>
    <span class="c1">#for column in columns:</span>
        <span class="c1">#outliers[column] = detect_outliers_std(df, column, num_sd)</span>

    <span class="c1"># Handle outliers by replacing with NaN</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">),</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.remove_last_row_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Removes the last row from the DataFrame if it has 2923 rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame to be checked and modified.</p>
<p>Returns:
pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the last row from the DataFrame if it has 2923 rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame to be checked and modified.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the DataFrame has exactly 2923 rows</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2923</span><span class="p">:</span>
        <span class="c1"># Drop the last row</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.rename_and_set_time_as_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Rename columns, convert 'time' column to datetime, and set 'time' as the index.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing data with a 'Datum' column to be renamed and converted.</p>
<p>Returns:
pandas.DataFrame: The cleaned DataFrame with 'Datum' renamed to 'time', converted to datetime, and 'time' set as index.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rename columns, convert &#39;time&#39; column to datetime, and set &#39;time&#39; as the index.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing data with a &#39;Datum&#39; column to be renamed and converted.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: The cleaned DataFrame with &#39;Datum&#39; renamed to &#39;time&#39;, converted to datetime, and &#39;time&#39; set as index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rename &#39;Datum&#39; column to &#39;time&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Convert &#39;time&#39; column to datetime</span>
    <span class="c1">#df[&#39;time&#39;] = pd.to_datetime(df[&#39;time&#39;])</span>

    <span class="c1"># Set &#39;time&#39; column as index</span>
    <span class="c1">#df.set_index(&#39;time&#39;, inplace=True)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.reorder_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reorder columns in the DataFrame to place date-related variables together.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame with various columns including date-related variables.</p>
<p>Returns:
pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reorder columns in the DataFrame to place date-related variables together.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame with various columns including date-related variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the desired order of columns</span>
    <span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;Monat&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahr&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochenende&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahreszeit&#39;</span><span class="p">,</span> <span class="s1">&#39;LaubfÃ¤rbung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_CZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_CZ&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;HEH_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;HZW_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusenschutzhaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Racheldiensthuette_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldschmidthaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Falkensteinschutzhaus_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Schwellhaeusl_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperatur&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Niederschlagsmenge&#39;</span><span class="p">,</span> <span class="s1">&#39;Schneehoehe&#39;</span><span class="p">,</span> <span class="s1">&#39;GS mit&#39;</span><span class="p">,</span> <span class="s1">&#39;GS max&#39;</span>
    <span class="p">]</span>

    <span class="c1"># Reorder columns in the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_visitor_center_data.write_parquet_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual Parquet file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the Parquet files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_parquet function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_visitor_center_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual Parquet file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the Parquet files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_parquet function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame successfully written to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to write DataFrame to S3. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.preprocess_weather_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_weather_data.fill_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill missing values in the weather data using linear interpolation or zero values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>parameters</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: DataFrame with missing values filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_weather_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill missing values in the weather data using linear interpolation or zero values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): Processed hourly weather data.</span>
<span class="sd">        parameters (list): List of column names to process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: DataFrame with missing values filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
        <span class="c1"># Calculate missing values and their percentage</span>
        <span class="n">missing_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">missing_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Calculate zero values and their percentage</span>
        <span class="n">zero_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">zero_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">zero_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Check for missing values in the &#39;Time&#39; column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">and</span> <span class="n">missing_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in Time column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please check the missing values in the Time column&#39;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">missing_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">zero_percentage</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                <span class="c1"># Fill missing values with 0.0 if zero values are significant</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zero values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">zero_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled with 0.0&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span>
                    <span class="c1">#fill with previous row value  </span>
                    <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use linear interpolation to fill missing values</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="c1"># Round the interpolated values to 2 decimal places</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled using linear interpolation&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.preprocess_weather_data.process_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_weather_data</span><span class="p">(</span><span class="n">sourced_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data
for the specified time period, processes the data to extract necessary weather parameters,
and saves the processed data to a CSV file.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/preprocess_weather_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_weather_data</span><span class="p">(</span><span class="n">sourced_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data</span>
<span class="sd">    for the specified time period, processes the data to extract necessary weather parameters,</span>
<span class="sd">    and saves the processed data to a CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sourced_df</span><span class="p">[</span><span class="s2">&quot;coco_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sourced_df</span><span class="p">[</span><span class="s2">&quot;coco_2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
    <span class="c1"># Get the list of columns to process</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">sourced_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

    <span class="c1"># Fill missing values in the weather data</span>
    <span class="n">imputed_data</span> <span class="o">=</span> <span class="n">fill_missing_values</span><span class="p">(</span><span class="n">sourced_df</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="c1"># # Uncomment the following line to save the processed data to a CSV file</span>
    <span class="c1"># # Save the processed data to a CSV file</span>
    <span class="c1"># save_data_to_csv(imputed_data, &#39;outputs/weather_data_final/processed_weather_data_2016-24_forecasted_imputed.csv&#39;)</span>


    <span class="k">return</span> <span class="n">imputed_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.visitor_center_processing_script"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Wochentag' that represents the day of the week in German.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with updated 'Wochentag' column in German.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Wochentag&#39; that represents the day of the week in German.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with updated &#39;Wochentag&#39; column in German.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new column &#39;Wochentag2&#39; with the day of the week in English</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Define the translation mapping from English to German</span>
    <span class="n">translation_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Monday&#39;</span><span class="p">:</span> <span class="s1">&#39;Montag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Tuesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Dienstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Wednesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Mittwoch&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Thursday&#39;</span><span class="p">:</span> <span class="s1">&#39;Donnerstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Friday&#39;</span><span class="p">:</span> <span class="s1">&#39;Freitag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Saturday&#39;</span><span class="p">:</span> <span class="s1">&#39;Samstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sunday&#39;</span><span class="p">:</span> <span class="s1">&#39;Sonntag&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Replace the English day names in the &#39;Wochentag2&#39; column with German names</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">translation_map</span><span class="p">)</span>

    <span class="c1"># Remove the &#39;Wochentag&#39; column from the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Rename &#39;Wochentag2&#39; to &#39;Wochentag&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">:</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create new columns for day, month, and year from a date column in the DataFrame.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with additional columns for day, month, and year.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create new columns for day, month, and year from a date column in the DataFrame.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with additional columns for day, month, and year.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert &#39;Datum&#39; column to datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">])</span>

    <span class="c1"># Add new columns for day, month, and year</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

    <span class="c1"># Change data types for modeling purposes</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Jahreszeit' in the DataFrame based on the month variable.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Monat' column with month information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Jahreszeit' column representing the season.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Jahreszeit&#39; in the DataFrame based on the month variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Monat&#39; column with month information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Jahreszeit&#39; column representing the season.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the seasons based on the month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;FrÃ¼hling&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Sommer&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Herbst&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Winter&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">else</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="p">)</span>

    <span class="c1"># Convert the &#39;Jahreszeit&#39; column to category type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new binary column 'Wochenende' indicating whether the day is a weekend.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Wochentag' column with German day names.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Wochenende' column indicating weekend status.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new binary column &#39;Wochenende&#39; indicating whether the day is a weekend.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Wochentag&#39; column with German day names.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Wochenende&#39; column indicating weekend status.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new binary column &#39;Wochenende&#39; where True represents weekend days (Saturday, Sunday)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Samstag&#39;</span><span class="p">,</span> <span class="s1">&#39;Sonntag&#39;</span><span class="p">])</span>

    <span class="c1"># Convert the &#39;Wochenende&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects a typo in the 'Schulferien_Bayern' column and converts it to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Schulferien_Bayern' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with corrected 'Schulferien_Bayern' values and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects a typo in the &#39;Schulferien_Bayern&#39; column and converts it to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Schulferien_Bayern&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with corrected &#39;Schulferien_Bayern&#39; values and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Correct the typo in specific value for column &#39;Schulferien_Bayern&#39; (from `10` to `0`)</span>
    <span class="n">df_visitcenters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2017-04-30&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Change &#39;Schulferien_Bayern&#39; to bool type</span>
    <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_visitcenters</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'WGM_geoeffnet' column by replacing the value 11 with 1.
Converts the column to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'WGM_geoeffnet' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'WGM_geoeffnet' corrected and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;WGM_geoeffnet&#39; column by replacing the value 11 with 1.</span>
<span class="sd">    Converts the column to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;WGM_geoeffnet&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;WGM_geoeffnet&#39; corrected and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Replace single value of 11 with 1 in &#39;WGM_geoeffnet&#39; column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Convert &#39;WGM_geoeffnet&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'Besuchszahlen_HEH' column by rounding up values with non-zero fractional parts to the nearest whole number.
Converts the column to Int64 type to retain NaN values.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Besuchszahlen_HEH' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'Besuchszahlen_HEH' corrected and converted to Int64 type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;Besuchszahlen_HEH&#39; column by rounding up values with non-zero fractional parts to the nearest whole number.</span>
<span class="sd">    Converts the column to Int64 type to retain NaN values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Besuchszahlen_HEH&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;Besuchszahlen_HEH&#39; corrected and converted to Int64 type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Apply np.ceil() to round up values with non-zero fractional parts to nearest whole number</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span>
    <span class="p">)</span>

    <span class="c1"># Convert &#39;Besuchszahlen_HEH&#39; to Int64 to retain NaN values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing daily data with a 'Datum' column representing dates.</p>
<p>Returns:
pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing daily data with a &#39;Datum&#39; column representing dates.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a new DataFrame where each day is expanded into 24 rows (one per hour)</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">24</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Create the hourly timestamps by adding hours to the &#39;Datum&#39; column</span>
    <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">(),</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

    <span class="c1"># Rename columns for clarity</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df_hourly</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect outliers in a specific column of the DataFrame using the standard deviation method.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the column to check.
column (str): Name of the column to check for outliers.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect outliers in a specific column of the DataFrame using the standard deviation method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the column to check.</span>
<span class="sd">    column (str): Name of the column to check for outliers.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="c1"># Define the bounds for outliers</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>

    <span class="c1"># Identify outliers</span>
    <span class="n">outliers_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">outliers_mask</span><span class="p">][[</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect and handle outliers for a list of columns by replacing them with NaN.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the columns to check.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect and handle outliers for a list of columns by replacing them with NaN.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the columns to check.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">]</span>

    <span class="c1">#outliers = {}</span>

    <span class="c1"># Detect outliers and store in dictionary</span>
    <span class="c1">#for column in columns:</span>
        <span class="c1">#outliers[column] = detect_outliers_std(df, column, num_sd)</span>

    <span class="c1"># Handle outliers by replacing with NaN</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">),</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Removes the last row from the DataFrame if it has 2923 rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame to be checked and modified.</p>
<p>Returns:
pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the last row from the DataFrame if it has 2923 rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame to be checked and modified.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the DataFrame has exactly 2923 rows</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2923</span><span class="p">:</span>
        <span class="c1"># Drop the last row</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Rename columns, convert 'time' column to datetime, and set 'time' as the index.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing data with a 'Datum' column to be renamed and converted.</p>
<p>Returns:
pandas.DataFrame: The cleaned DataFrame with 'Datum' renamed to 'time', converted to datetime, and 'time' set as index.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rename columns, convert &#39;time&#39; column to datetime, and set &#39;time&#39; as the index.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing data with a &#39;Datum&#39; column to be renamed and converted.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: The cleaned DataFrame with &#39;Datum&#39; renamed to &#39;time&#39;, converted to datetime, and &#39;time&#39; set as index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rename &#39;Datum&#39; column to &#39;time&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Convert &#39;time&#39; column to datetime</span>
    <span class="c1">#df[&#39;time&#39;] = pd.to_datetime(df[&#39;time&#39;])</span>

    <span class="c1"># Set &#39;time&#39; column as index</span>
    <span class="c1">#df.set_index(&#39;time&#39;, inplace=True)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reorder columns in the DataFrame to place date-related variables together.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame with various columns including date-related variables.</p>
<p>Returns:
pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reorder columns in the DataFrame to place date-related variables together.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame with various columns including date-related variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the desired order of columns</span>
    <span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;Monat&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahr&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochenende&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahreszeit&#39;</span><span class="p">,</span> <span class="s1">&#39;LaubfÃ¤rbung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_CZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_CZ&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;HEH_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;HZW_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusenschutzhaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Racheldiensthuette_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldschmidthaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Falkensteinschutzhaus_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Schwellhaeusl_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperatur&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Niederschlagsmenge&#39;</span><span class="p">,</span> <span class="s1">&#39;Schneehoehe&#39;</span><span class="p">,</span> <span class="s1">&#39;GS mit&#39;</span><span class="p">,</span> <span class="s1">&#39;GS max&#39;</span>
    <span class="p">]</span>

    <span class="c1"># Reorder columns in the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.
Args:
    path (str): The path to the CSV files on AWS S3.
    **kwargs: Additional arguments to pass to the read_csv function.
Returns:
    pd.DataFrame: The DataFrame containing the data from the CSV files.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual Parquet file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the Parquet files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_parquet function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual Parquet file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the Parquet files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_parquet function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame successfully written to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to write DataFrame to S3. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Modeling -->



<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.create_inference_dfs"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.create_inference_dfs.load_latest_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_latest_models</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_prefix</span><span class="p">,</span> <span class="n">models_names</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load the latest files from an S3 folder based on the model names, 
and dynamically create variables with 'loaded_' as prefix.</p>
<p>Parameters:
- bucket_name (str): The name of the S3 bucket.
- folder_prefix (str): The folder path within the bucket.
- models (list): List of model names without the 'extra_trees_' prefix.</p>
<p>Returns:
- dict: A dictionary containing the loaded models with keys prefixed by 'loaded_'.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/create_inference_dfs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_resource</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">load_latest_models</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">folder_prefix</span><span class="p">,</span> <span class="n">models_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the latest files from an S3 folder based on the model names, </span>
<span class="sd">    and dynamically create variables with &#39;loaded_&#39; as prefix.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - bucket_name (str): The name of the S3 bucket.</span>
<span class="sd">    - folder_prefix (str): The folder path within the bucket.</span>
<span class="sd">    - models (list): List of model names without the &#39;extra_trees_&#39; prefix.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - dict: A dictionary containing the loaded models with keys prefixed by &#39;loaded_&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Dictionary to store loaded models</span>
    <span class="n">loaded_models</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Loop through each model to get the latest pickle (.pkl) file</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_names</span><span class="p">:</span>

        <span class="c1"># Create an S3 client</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>

        <span class="n">s3_key</span> <span class="o">=</span> <span class="n">folder_prefix</span> <span class="o">+</span> <span class="n">model</span> <span class="o">+</span> <span class="s1">&#39;.pkl&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieving the trained model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> saved under AWS S3 in bucket </span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2"> with key </span><span class="si">{</span><span class="n">s3_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Get the object from S3</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">s3_key</span><span class="p">)</span>

        <span class="c1"># Load the pickled model from the response object using joblib</span>
        <span class="n">loaded_regressor_model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>

        <span class="c1"># Store the loaded model in the dictionary</span>
        <span class="n">loaded_models</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loaded_regressor_model</span>

    <span class="k">return</span> <span class="n">loaded_models</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.create_inference_dfs.predict_with_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_with_models</span><span class="p">(</span><span class="n">loaded_models</span><span class="p">,</span> <span class="n">df_features</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Given a dictionary of models and a DataFrame of features, this function predicts the target
values using each model and saves the inference predictions to AWS S3 (to be further loaded from Streamlit).</p>
<p>Parameters:
- loaded_models (dict): A dictionary of models where keys are model names and values are the trained models.
- df_features (pd.DataFrame): A DataFrame containing the features to make predictions on.</p>
<p>Returns:
- pd.DataFrame: A DataFrame containing the predictions of all models per region.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/create_inference_dfs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_with_models</span><span class="p">(</span><span class="n">loaded_models</span><span class="p">,</span> <span class="n">df_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of models and a DataFrame of features, this function predicts the target</span>
<span class="sd">    values using each model and saves the inference predictions to AWS S3 (to be further loaded from Streamlit).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - loaded_models (dict): A dictionary of models where keys are model names and values are the trained models.</span>
<span class="sd">    - df_features (pd.DataFrame): A DataFrame containing the features to make predictions on.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - pd.DataFrame: A DataFrame containing the predictions of all models per region.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">overall_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Iterate through the loaded models</span>
    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">loaded_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Check if the model has a predict method</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">):</span>
            <span class="c1"># Make predictions</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_features</span><span class="p">)</span>

            <span class="c1"># Create a new DataFrame for the predictions with the time column</span>
            <span class="n">df_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">])</span>

            <span class="c1"># Make the index column &#39;Time&#39;</span>
            <span class="n">df_predictions</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">index</span>

            <span class="c1"># Make sure predictions are integers and not floats</span>
            <span class="n">df_predictions</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_predictions</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="c1"># save the prediction dataframe as a parquet file in aws</span>
            <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">df_predictions</span><span class="p">,</span><span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/models/inference_data_outputs/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predictions for </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> stored successfully&quot;</span><span class="p">)</span>
            <span class="n">df_predictions</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;extra_trees_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.parquet&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Append the predictions to the overall_predictions DataFrame</span>
            <span class="n">overall_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">overall_predictions</span><span class="p">,</span> <span class="n">df_predictions</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> is not a valid model. It is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">overall_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.preprocess_inference_features"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.preprocess_inference_features.join_inference_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">visitor_centers_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Merge weather data with visitor centers data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>weather_data_inference</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>visitor_centers_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing visitor centers data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Merged DataFrame with selected columns from visitor centers data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/preprocess_inference_features.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">join_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">visitor_centers_data</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge weather data with visitor centers data.</span>

<span class="sd">    Args:</span>
<span class="sd">        weather_data_inference (pd.DataFrame): DataFrame containing weather data.</span>
<span class="sd">        visitor_centers_data (pd.DataFrame): DataFrame containing visitor centers data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Merged DataFrame with selected columns from visitor centers data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the columns you want to bring from visitor_centers_data</span>
    <span class="n">columns_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;Hour&#39;</span><span class="p">,</span> <span class="s1">&#39;Monat&#39;</span><span class="p">,</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">,</span>  <span class="s1">&#39;Wochenende&#39;</span><span class="p">,</span>  <span class="s1">&#39;Jahreszeit&#39;</span><span class="p">,</span>  <span class="s1">&#39;LaubfÃ¤rbung&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_CZ&#39;</span><span class="p">,</span><span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">,</span>  <span class="s1">&#39;Feiertag_CZ&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;HEH_geoeffnet&#39;</span><span class="p">,</span>  <span class="s1">&#39;HZW_geoeffnet&#39;</span><span class="p">,</span>  <span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusenschutzhaus_geoeffnet&#39;</span><span class="p">,</span>  <span class="s1">&#39;Racheldiensthuette_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Falkensteinschutzhaus_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Schwellhaeusl_geoeffnet&#39;</span><span class="p">]</span>  

    <span class="c1"># Perform the merge, keep the min and max values of the visitor center data</span>
    <span class="n">merged_data</span> <span class="o">=</span> <span class="n">visitor_centers_data</span><span class="p">[</span><span class="n">columns_to_add</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.preprocess_inference_features.source_preprocess_inference_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_preprocess_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">hourly_visitor_center_data</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source and preprocess inference data from weather and visitor center sources.</p>
<p>This function fetches weather and visitor center data, merges them, and computes additional features
such as nearest holiday distance, daily max values, and moving z-scores.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame containing preprocessed inference data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/preprocess_inference_features.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span><span class="p">(</span><span class="n">max_entries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">source_preprocess_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">hourly_visitor_center_data</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Source and preprocess inference data from weather and visitor center sources.</span>

<span class="sd">    This function fetches weather and visitor center data, merges them, and computes additional features</span>
<span class="sd">    such as nearest holiday distance, daily max values, and moving z-scores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame containing preprocessed inference data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sourcing and preprocessing inference data at </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>    

    <span class="n">join_df</span> <span class="o">=</span> <span class="n">join_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">hourly_visitor_center_data</span><span class="p">)</span>


    <span class="c1"># Get z scores for the weather columns</span>
    <span class="n">inference_data_with_distances</span> <span class="o">=</span> <span class="n">add_nearest_holiday_distance</span><span class="p">(</span><span class="n">join_df</span><span class="p">)</span>


    <span class="n">inference_data_with_daily_max</span> <span class="o">=</span> <span class="n">add_daily_max_values</span><span class="p">(</span><span class="n">inference_data_with_distances</span><span class="p">,</span> <span class="n">weather_columns_for_zscores</span><span class="p">)</span>

    <span class="n">inference_data_with_new_features</span> <span class="o">=</span> <span class="n">add_moving_z_scores</span><span class="p">(</span><span class="n">inference_data_with_daily_max</span><span class="p">,</span> 
                                                           <span class="n">weather_columns_for_zscores</span><span class="p">,</span> 
                                                           <span class="n">window_size_for_zscores</span><span class="p">)</span>



    <span class="c1"># Apply the cyclic and categorical trasformations from the training dataset (same as the training dataset)</span>
    <span class="n">inference_data_with_coco_encoding</span> <span class="o">=</span> <span class="n">process_transformations</span><span class="p">(</span><span class="n">inference_data_with_new_features</span><span class="p">)</span>

    <span class="c1"># Slice the data to keep only rows within the next 10 days</span>
    <span class="n">inference_data_with_coco_encoding</span> <span class="o">=</span> <span class="n">inference_data_with_coco_encoding</span><span class="p">[</span>
        <span class="p">(</span><span class="n">inference_data_with_coco_encoding</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">&amp;</span> 
        <span class="p">(</span><span class="n">inference_data_with_coco_encoding</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="p">]</span>

    <span class="c1">#set Time column as index   </span>
    <span class="n">inference_data_with_coco_encoding</span> <span class="o">=</span> <span class="n">inference_data_with_coco_encoding</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="c1">#drop column named Date</span>
    <span class="n">inference_data_with_coco_encoding</span> <span class="o">=</span> <span class="n">inference_data_with_coco_encoding</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>


    <span class="k">return</span> <span class="n">inference_data_with_coco_encoding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.run_inference"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.run_inference.run_inference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_inference</span><span class="p">(</span><span class="n">preprocessed_hourly_visitor_center_data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run the inference pipeline. Fetches the latest weather forecasts, preprocesses data, and makes predictions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>preprocessed_hourly_visitor_center_data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The preprocessed hourly visitor center data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/run_inference.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@st</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="s2">&quot;3h&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_inference</span><span class="p">(</span><span class="n">preprocessed_hourly_visitor_center_data</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the inference pipeline. Fetches the latest weather forecasts, preprocesses data, and makes predictions.</span>

<span class="sd">    Args:</span>
<span class="sd">        preprocessed_hourly_visitor_center_data (pd.DataFrame): The preprocessed hourly visitor center data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get the weather data for inference</span>
    <span class="k">def</span> <span class="nf">get_today_midnight_berlin</span><span class="p">():</span>
        <span class="c1"># Set the timezone to Berlin (CET or CEST)</span>
        <span class="n">berlin_tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Europe/Berlin&#39;</span><span class="p">)</span>

        <span class="c1"># Get the current time in Berlin</span>
        <span class="n">now_berlin</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">berlin_tz</span><span class="p">)</span>

        <span class="c1"># Replace the hour, minute, second, and microsecond with 0 to get today at 00:00</span>
        <span class="n">day_today_berlin</span> <span class="o">=</span> <span class="n">now_berlin</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

        <span class="c1"># Convert day_today_berlin to datetime</span>
        <span class="n">day_today_berlin</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">day_today_berlin</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">day_today_berlin</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">get_today_midnight_berlin</span><span class="p">()</span>
    <span class="n">start_inference_time</span> <span class="o">=</span> <span class="n">today</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">end_inference_time</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running inference part from </span><span class="si">{</span><span class="n">start_inference_time</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_inference_time</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="n">weather_data_inference</span> <span class="o">=</span> <span class="n">source_weather_data</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="n">start_inference_time</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">end_inference_time</span><span class="p">)</span>

    <span class="c1"># preprocess the inference data</span>
    <span class="n">inference_df</span> <span class="o">=</span> <span class="n">source_preprocess_inference_data</span><span class="p">(</span><span class="n">weather_data_inference</span><span class="p">,</span> <span class="n">preprocessed_hourly_visitor_center_data</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="n">today</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">end_inference_time</span><span class="p">)</span>

    <span class="c1"># make predictions</span>
    <span class="n">overall_visitor_predictions</span> <span class="o">=</span> <span class="n">visitor_predictions</span><span class="p">(</span><span class="n">inference_df</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">overall_visitor_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.source_and_feature_selection"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.change_datatypes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">change_datatypes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dtype_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Change column datatypes based on dtype_dict.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">change_datatypes</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">dtype_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Change column datatypes based on dtype_dict.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">dtype_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># set time as the index</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.filter_features_for_modelling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_features_for_modelling</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Filter the features for modelling.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filter_features_for_modelling</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the features for modelling.&quot;&quot;&quot;</span>
    <span class="c1"># Filter the features for modelling</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">numeric_features_for_modelling</span> <span class="o">+</span> <span class="n">categorical_features_for_modelling</span> <span class="o">+</span> <span class="n">target_vars_et</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.get_regionwise_IN_and_OUT_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_regionwise_IN_and_OUT_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Preprocess the data by summing IN and OUT columns for each region.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame containing the data to preprocess.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The preprocessed DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_regionwise_IN_and_OUT_columns</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocess the data by summing IN and OUT columns for each region.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame containing the data to preprocess.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The preprocessed DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Iterate over the regionwise sensor mapping</span>
    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">sensors</span> <span class="ow">in</span> <span class="n">regionwise_sensor_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Sum the values for all IN columns of the current region</span>
        <span class="k">if</span> <span class="n">sensors</span><span class="p">[</span><span class="s1">&#39;IN&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1"> IN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">sensors</span><span class="p">[</span><span class="s1">&#39;IN&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Sum the values for all OUT columns of the current region</span>
        <span class="k">if</span> <span class="n">sensors</span><span class="p">[</span><span class="s1">&#39;OUT&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1"> OUT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">sensors</span><span class="p">[</span><span class="s1">&#39;OUT&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.load_csv_files_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.
Args:
    path (str): The path to the CSV files on AWS S3.
    **kwargs: Additional arguments to pass to the read_csv function.
Returns:
    pd.DataFrame: The DataFrame containing the data from the CSV files.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Loads individual or multiple CSV files from an AWS S3 bucket.</span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># set time to datetime</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.merge_new_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_new_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_newfeatures</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Merges new features from df_newfeatures into df on 'Time' column.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_new_features</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">df_newfeatures</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merges new features from df_newfeatures into df on &#39;Time&#39; column.&quot;&quot;&quot;</span>

    <span class="c1"># Ensure &#39;Time&#39; columns are datetime</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">df_newfeatures</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span> <span class="p">[</span><span class="n">df</span><span class="p">,</span> <span class="n">df_newfeatures</span><span class="p">])</span>

    <span class="c1"># Columns to merge</span>
    <span class="n">columns_to_add</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ZScore_Daily_Max_Temperature (Â°C)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ZScore_Daily_Max_Relative Humidity (%)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ZScore_Daily_Max_Wind Speed (km/h)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Distance_to_Nearest_Holiday_Bayern&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Distance_to_Nearest_Holiday_CZ&#39;</span>
    <span class="p">]</span>

    <span class="c1"># Select only existing columns for merging</span>
    <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_add</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_newfeatures</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

    <span class="c1"># Merge on &#39;Time&#39; column</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_newfeatures</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">selected_columns</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

   <span class="c1">#add the hour column additionally</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.source_and_feature_selection.process_transformations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_transformations</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process the transformations on the DataFrame.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/source_and_feature_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_transformations</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process the transformations on the DataFrame.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">apply_cliclic_tranformations</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cyclic_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span><span class="s1">&#39;Hour&#39;</span><span class="p">,</span> <span class="s1">&#39;Monat&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">standardize_numeric_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">standardize_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Temperature (Â°C)&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative Humidity (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind Speed (km/h)&#39;</span><span class="p">,</span>
                                                                  <span class="s1">&#39;Distance_to_Nearest_Holiday_Bayern&#39;</span><span class="p">,</span><span class="s1">&#39;Distance_to_Nearest_Holiday_CZ&#39;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">get_dummy_encodings</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns_to_use</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">,</span> <span class="s1">&#39;coco_2&#39;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">handle_binary_values</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.train_lstm"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.build_lstm_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_lstm_model</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Build and compile the LSTM model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>input_shape</code></td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the input data (time_steps, features).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of target variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>model</code></td>            <td>
                  <code><span title="tensorflow.keras.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Compiled LSTM model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_lstm_model</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">output_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build and compile the LSTM model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        input_shape (tuple): Shape of the input data (time_steps, features).</span>
<span class="sd">        output_size (int): Number of target variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        model (tensorflow.keras.Model): Compiled LSTM model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">)))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">output_size</span><span class="p">))</span>  <span class="c1"># Output layer with the number of target variables</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.create_sequences" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create sequences from the data for LSTM input.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>X</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target variable array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of time steps to include in each sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_seq</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_seq</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence targets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create sequences from the data for LSTM input.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        X (np.ndarray): Feature array.</span>
<span class="sd">        y (np.ndarray): Target variable array.</span>
<span class="sd">        window_size (int): The number of time steps to include in each sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        X_seq (np.ndarray): Sequence features.</span>
<span class="sd">        y_seq (np.ndarray): Sequence targets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_seq</span><span class="p">,</span> <span class="n">y_seq</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">):</span>
        <span class="n">X_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
        <span class="n">y_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_seq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_seq</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.load_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load preprocessed data from the feature_selection_and_preprocessing module.
Returns:
    df (pd.DataFrame): The preprocessed dataframe with features and target variables.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load preprocessed data from the feature_selection_and_preprocessing module.</span>
<span class="sd">    Returns:</span>
<span class="sd">        df (pd.DataFrame): The preprocessed dataframe with features and target variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">feature_selection_and_preprocessing</span> <span class="kn">import</span> <span class="n">get_preprocessed_data</span>
    <span class="k">return</span> <span class="n">get_preprocessed_data</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.save_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;lstm_model.h5&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the trained model to a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="tensorflow.keras.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trained LSTM model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>model_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the model file.</p>
              </div>
            </td>
            <td>
                  <code>&#39;lstm_model.h5&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;lstm_model.h5&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the trained model to a file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model (tensorflow.keras.Model): The trained LSTM model.</span>
<span class="sd">        model_path (str): Path to save the model file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.split_features_targets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_features_targets</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_vars</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Split the dataframe into features and target variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with features and target variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>target_vars</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of target variable column names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature array.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target variable array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split_features_targets</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_vars</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the dataframe into features and target variables.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (pd.DataFrame): The dataframe with features and target variables.</span>
<span class="sd">        target_vars (list): List of target variable column names.</span>

<span class="sd">    Returns:</span>
<span class="sd">        X (np.ndarray): Feature array.</span>
<span class="sd">        y (np.ndarray): Target variable array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">target_vars</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Features</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_vars</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Target variables</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.split_train_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_train_test</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Split data into training and test sets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>X</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target variable array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_size</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Proportion of the dataset to include in the test split.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_eval</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_train</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training targets.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_eval</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation targets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split_train_test</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split data into training and test sets.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        X (np.ndarray): Feature array.</span>
<span class="sd">        y (np.ndarray): Target variable array.</span>
<span class="sd">        test_size (float): Proportion of the dataset to include in the test split.</span>

<span class="sd">    Returns:</span>
<span class="sd">        X_train (np.ndarray): Training features.</span>
<span class="sd">        X_eval (np.ndarray): Evaluation features.</span>
<span class="sd">        y_train (np.ndarray): Training targets.</span>
<span class="sd">        y_eval (np.ndarray): Evaluation targets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.train_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train_seq</span><span class="p">,</span> <span class="n">y_train_seq</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Train the LSTM model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="tensorflow.keras.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The compiled LSTM model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>X_train_seq</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training sequence features.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y_train_seq</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training sequence targets.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>epochs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of epochs to train the model.</p>
              </div>
            </td>
            <td>
                  <code>50</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>batch_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Batch size for training.</p>
              </div>
            </td>
            <td>
                  <code>64</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>history</code></td>            <td>
                  <code><span title="tensorflow.keras.callbacks.History">History</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training history.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train_seq</span><span class="p">,</span> <span class="n">y_train_seq</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Train the LSTM model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model (tensorflow.keras.Model): The compiled LSTM model.</span>
<span class="sd">        X_train_seq (np.ndarray): Training sequence features.</span>
<span class="sd">        y_train_seq (np.ndarray): Training sequence targets.</span>
<span class="sd">        epochs (int): Number of epochs to train the model.</span>
<span class="sd">        batch_size (int): Batch size for training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        history (tensorflow.keras.callbacks.History): Training history.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">early_stopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_seq</span><span class="p">,</span> <span class="n">y_train_seq</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">history</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_lstm.training_pipeline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">training_pipeline</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main function to execute the training pipeline for the LSTM model.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_lstm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">training_pipeline</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to execute the training pipeline for the LSTM model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Load preprocessed data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>

    <span class="c1"># Define target variables</span>
    <span class="n">target_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;traffic_abs&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_IN_abs&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_OUT_abs&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Lusen-Mauth-Finsterau IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusen-Mauth-Finsterau OUT&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Falkenstein-SchwellhÃ¤usl IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Falkenstein-SchwellhÃ¤usl OUT&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Rachel-Spiegelau IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Rachel-Spiegelau OUT&#39;</span><span class="p">,</span>  
                   <span class="s1">&#39;Nationalparkzentrum Lusen IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Nationalparkzentrum Lusen OUT&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Scheuereck-Schachten-Trinkwassertalsperre IN&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Scheuereck-Schachten-Trinkwassertalsperre OUT&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Nationalparkzentrum Falkenstein IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Nationalparkzentrum Falkenstein OUT&#39;</span><span class="p">]</span>

    <span class="c1"># Split features and target variables</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">split_features_targets</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_vars</span><span class="p">)</span>

    <span class="c1"># Split into training and evaluation sets</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_eval</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_eval</span> <span class="o">=</span> <span class="n">split_train_test</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Create sequences</span>
    <span class="n">window_size</span> <span class="o">=</span> <span class="mi">168</span>  <span class="c1"># 7 days, assuming data is hourly</span>
    <span class="n">X_train_seq</span><span class="p">,</span> <span class="n">y_train_seq</span> <span class="o">=</span> <span class="n">create_sequences</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
    <span class="n">X_eval_seq</span><span class="p">,</span> <span class="n">y_eval_seq</span> <span class="o">=</span> <span class="n">create_sequences</span><span class="p">(</span><span class="n">X_eval</span><span class="p">,</span> <span class="n">y_eval</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>

    <span class="c1"># Build the LSTM model</span>
    <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">output_size</span> <span class="o">=</span> <span class="n">y_train_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">build_lstm_model</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>

    <span class="c1"># Train the model</span>
    <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train_seq</span><span class="p">,</span> <span class="n">y_train_seq</span><span class="p">)</span>

    <span class="c1"># Save the trained model</span>
    <span class="n">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.modeling.train_regressor"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_regressor.create_uuid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_uuid</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates a unique identifier string.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique identifier string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_regressor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_uuid</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a unique identifier string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A unique identifier string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unique_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">unique_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_regressor.save_models_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_models_to_aws_s3</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">save_path_models</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">uuid</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the model to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to save.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save_path_models</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>model_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>local_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local path to the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>uuid</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_regressor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_models_to_aws_s3</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">save_path_models</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the model to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to save.</span>
<span class="sd">        save_path_models (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        model_name (str): The name of the model.</span>
<span class="sd">        local_path (str): The local path to the model.</span>
<span class="sd">        uuid (str): The unique identifier string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># make the save path if it does not exist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>

    <span class="n">save_model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span>
    <span class="n">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">save_model_path</span><span class="p">,</span> <span class="n">model_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">save_path_aws</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">save_path_models</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">uuid</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.pkl&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">save_model_path</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">,</span><span class="n">save_path_aws</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model saved in AWS S3 under </span><span class="si">{</span><span class="n">save_path_aws</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.modeling.train_regressor.save_predictions_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_predictions_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">save_path_predictions</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">uuid</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual CSV file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save_path_predictions</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>uuid</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/modeling/train_regressor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_predictions_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">save_path_predictions</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual CSV file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        save_path_predictions (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        filename (str): The name of the CSV file.</span>
<span class="sd">        uuid (str): The unique identifier string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">aws_s3_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">aws_s3_bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">save_path_predictions</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">uuid</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">aws_s3_path</span><span class="p">,</span><span class="n">index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predictions for test data saved in AWS S3 under </span><span class="si">{</span><span class="n">aws_s3_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>