
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dssgxmunich.github.io/bavarian-forest-visitor-monitoring-dssgx-24/api-reference/">
      
      
        <link rel="prev" href="../references-and-appendix/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.35">
    
    
      
        <title>API Reference - Docs for the Bavarian Forest National Park Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Docs for the Bavarian Forest National Park Project" class="md-header__button md-logo" aria-label="Docs for the Bavarian Forest National Park Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docs for the Bavarian Forest National Park Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Docs for the Bavarian Forest National Park Project" class="md-nav__button md-logo" aria-label="Docs for the Bavarian Forest National Park Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Docs for the Bavarian Forest National Park Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bavarian forest project
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../executive-summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executive Summary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Background and Goal
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../methodology-and-approach/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methodology and Approach
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../findings-and-results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Findings and Results
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations-and-challenges/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discussion
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../references-and-appendix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References and Appendix
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing" class="md-nav__link">
    <span class="md-ellipsis">
      new_weather_sourcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing.get_hourly_data_forecasted" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data_forecasted
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      check_missing_data_per_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_occupancy_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      save_higher_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_weather_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values.visualize_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter" class="md-nav__link">
    <span class="md-ellipsis">
      join_sensor_weather_visitorcenter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="md-nav__link">
    <span class="md-ellipsis">
      create_datetimeindex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_center_processing_script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing" class="md-nav__link">
    <span class="md-ellipsis">
      weather_data_sourcing_and_processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.get_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.process_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.save_data_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_data_to_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.source_and_process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_historical_data_for_location
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_historical_data_for_location">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="md-nav__link">
    <span class="md-ellipsis">
      process_all_locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="process_all_locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_real_time_parking_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing" class="md-nav__link">
    <span class="md-ellipsis">
      new_weather_sourcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing.get_hourly_data_forecasted" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data_forecasted
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.new_weather_sourcing.source_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_quality_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="md-nav__link">
    <span class="md-ellipsis">
      check_missing_data_per_sensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_occupancy_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="md-nav__link">
    <span class="md-ellipsis">
      save_higher_occupancy_rate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values" class="md-nav__link">
    <span class="md-ellipsis">
      impute_missing_weather_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values.fill_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      fill_missing_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.impute_missing_weather_values.visualize_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter" class="md-nav__link">
    <span class="md-ellipsis">
      join_sensor_weather_visitorcenter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="md-nav__link">
    <span class="md-ellipsis">
      create_datetimeindex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script" class="md-nav__link">
    <span class="md-ellipsis">
      visitor_center_processing_script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="md-nav__link">
    <span class="md-ellipsis">
      add_and_translate_day_of_week
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="md-nav__link">
    <span class="md-ellipsis">
      add_date_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_season_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="md-nav__link">
    <span class="md-ellipsis">
      add_weekend_variable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_schulferien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="md-nav__link">
    <span class="md-ellipsis">
      correct_and_convert_wgm_geoeffnet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="md-nav__link">
    <span class="md-ellipsis">
      correct_besuchszahlen_heh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_hourly_dataframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="md-nav__link">
    <span class="md-ellipsis">
      detect_outliers_std
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      handle_outliers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      remove_last_row_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="md-nav__link">
    <span class="md-ellipsis">
      rename_and_set_time_as_index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="md-nav__link">
    <span class="md-ellipsis">
      reorder_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      source_data_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_parquet_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing" class="md-nav__link">
    <span class="md-ellipsis">
      weather_data_sourcing_and_processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.get_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.load_csv_files_from_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv_files_from_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.process_hourly_data" class="md-nav__link">
    <span class="md-ellipsis">
      process_hourly_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.save_data_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_data_to_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.source_and_process_weather_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_and_process_weather_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.write_csv_file_to_aws_s3" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv_file_to_aws_s3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_historic_parking_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_historical_data_for_location
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_historical_data_for_location">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="md-nav__link">
    <span class="md-ellipsis">
      process_all_locations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="process_all_locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.prediction_pipeline.sourcing_data.source_real_time_parking_data" class="md-nav__link">
    <span class="md-ellipsis">
      source_real_time_parking_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api-reference">API Reference</h1>
<!-- Code in General -->



<div class="doc doc-object doc-module">



<a id="src.new_weather_sourcing"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.new_weather_sourcing.get_hourly_data_forecasted" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hourly_data_forecasted</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetch hourly weather data for the Bavarian Forest - forecasted from todays date</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Hourly weather data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/new_weather_sourcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_hourly_data_forecasted</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch hourly weather data for the Bavarian Forest - forecasted from todays date</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Hourly weather data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Hourly</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>

    <span class="c1"># Reset the index</span>
    <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.new_weather_sourcing.source_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_weather_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Source the weather data from METEOSTAT API</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Hourly weather data for the Bavarian Forest National Park for the next 7 days</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/new_weather_sourcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_weather_data</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source the weather data from METEOSTAT API</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Hourly weather data for the Bavarian Forest National Park for the next 7 days</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># Create a Point object for the Bavarian Forest National Park entry</span>
    <span class="n">bavarian_forest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">LATITUDE</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">LONGITUDE</span><span class="p">)</span>
    <span class="n">bavarian_forest</span><span class="o">.</span><span class="n">max_count</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="o">.</span><span class="n">max_count</span><span class="p">)</span>

    <span class="c1"># Fetch hourly data for the location</span>
    <span class="n">weather_hourly</span> <span class="o">=</span> <span class="n">get_hourly_data_forecasted</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">)</span>

    <span class="c1"># Drop unnecessary columns</span>
    <span class="n">weather_hourly</span> <span class="o">=</span> <span class="n">weather_hourly</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">,</span> <span class="s1">&#39;wpgt&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="s1">&#39;tsun&#39;</span><span class="p">,</span> <span class="s1">&#39;prcp&#39;</span><span class="p">,</span> <span class="s1">&#39;snow&#39;</span><span class="p">])</span>

    <span class="c1"># Convert the &#39;Time&#39; column to datetime format</span>
    <span class="n">weather_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">weather_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">weather_hourly</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Prediction Pipeline -->

<!-- Preprocessing -->



<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.impute_missing_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check data quality - if the occupancy is greater than the capacity of the parking space</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check data quality - if the occupancy is greater than the capacity of the parking space</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the capacity is always smaller than the occupancy</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
        <span class="c1"># remove the rows where the occupancy is greater than the capacity</span>
        <span class="c1"># print the row numbers where the occupancy is greater than the capacity</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The occupancy is greater than the capacity&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows where the occupancy is greater than the capacity:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]])</span>
        <span class="c1"># impute_occupancy_values(data)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_data_quality_occupancy_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check data quality - if the occupancy rate is greater than 100</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check data quality - if the occupancy rate is greater than 100</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the occupancy rate is greater than 100</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">100.00</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The occupancy rate is greater than 100&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows where the occupancy rate is greater than 100:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">],</span><span class="n">sensor</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data quality issue for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.check_missing_data_per_sensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check missing data per sensor</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check missing data per sensor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missing_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">missing_data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">missing_data</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.fill_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill missing values in the data</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill missing values in the data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fill all the missing values with linear interpolation</span>
    <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.impute_occupancy_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">impute_occupancy_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Impute occupancy values where the occupancy is greater than the capacity</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">impute_occupancy_values</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impute occupancy values where the occupancy is greater than the capacity</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Impute the occupancy values where the occupancy is greater than the capacity</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">else</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputed occupancy values:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main function to run the script</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to run the script</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">,</span> <span class="n">paths_to_parking_data</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>

        <span class="c1"># Missing data for each sensor</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking missing data for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">....................&quot;</span><span class="p">)</span>
        <span class="n">check_missing_data_per_sensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">)</span>

        <span class="c1"># check if the capacity is always smaller than the occupancy</span>
        <span class="n">check_data_quality_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_parking_data.save_higher_occupancy_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sensor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the rows where the occupancy rate is greater than 100</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_higher_occupancy_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">sensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the rows where the occupancy rate is greater than 100</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;./outputs&#39;</span><span class="p">,</span><span class="s1">&#39;parking_data_final&#39;</span><span class="p">,</span><span class="s1">&#39;data_quality_issues&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s1">_higher_occupancy_rate.csv&#39;</span><span class="p">)</span>

    <span class="c1"># make the output directory if it doesn&#39;t exist</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Save the rows where the occupancy rate is greater than 100</span>
    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved the rows where the occupancy rate is greater than 100 for </span><span class="si">{</span><span class="n">sensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.impute_missing_weather_values"></a>
    <div class="doc doc-contents first">

        <p>Weather Data Visualization and Processing Script</p>
<p>This script visualizes temperature and precipitation data from a CSV file containing hourly weather data for the Bavarian Forest region. 
It also fills missing values in the dataset using linear interpolation and zero filling and saves the processed data to a new CSV file.</p>
<p>Usage:
- Ensure the data file is located at './outputs/weather_data_final/bf-weather.csv'.
- Run the script:
  $ python src/process_and_clean_weather_data.py</p>
<p>Output:
- The processed data is saved as 'bf-weather-imputed.csv' in the './outputs/weather_data_final/' directory.
- A plot of temperature and precipitation is saved as 'bf-weather.png' in the same directory.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_weather_values.fill_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fill missing values in the weather data using linear interpolation or zero values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>parameters</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: DataFrame with missing values filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_weather_values.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill missing values in the weather data using linear interpolation or zero values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): Processed hourly weather data.</span>
<span class="sd">        parameters (list): List of column names to process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: DataFrame with missing values filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
        <span class="c1"># Calculate missing values and their percentage</span>
        <span class="n">missing_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">missing_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Calculate zero values and their percentage</span>
        <span class="n">zero_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">zero_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">zero_values</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Check for missing values in the &#39;Time&#39; column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">and</span> <span class="n">missing_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in Time column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please check the missing values in the Time column&#39;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">missing_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">missing_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">zero_percentage</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                <span class="c1"># Fill missing values with 0.0 if zero values are significant</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zero values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column: </span><span class="si">{</span><span class="n">zero_percentage</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled with 0.0&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use linear interpolation to fill missing values</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># Round the interpolated values to 2 decimal places</span>
                <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing values in </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s1"> column filled using linear interpolation&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.impute_missing_weather_values.visualize_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize_weather_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fig_save_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Visualize temperature and precipitation data and save the plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fig_save_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the generated plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/impute_missing_weather_values.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">visualize_weather_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fig_save_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize temperature and precipitation data and save the plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): Processed hourly weather data.</span>
<span class="sd">        fig_save_path (str): Path to save the generated plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create subplots for temperature and precipitation</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Plot temperature data</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bavarian Forest Weather Data&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

    <span class="c1"># Plot precipitation data</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

    <span class="c1"># Save the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_save_path</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close the plot to free memory</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Plot saved to </span><span class="si">{</span><span class="n">fig_save_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter"></a>
    <div class="doc doc-contents first">

        <p>Join sensor, weather and visitor center data script.</p>
<p>This script sources from AWS three different data sources, join them over a datetime index, and writes the joined df as a csv to AWS.</p>
<p>Usage:
- Change the global variables section if needed
    - Fill your AWS credentiales
    - Change the data paths or output directories</p>
<ul>
<li>Run the script:</li>
</ul>
<p>$ python src/join_sensor_weather_visitorcenter.py</p>
<p>Output:
- The joined data is saved as 'joined_sensor_weather_visitorcenter_2016-2024.csv' in the 'preprocessed_data' directory in AWS.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.create_datetimeindex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_datetimeindex</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">timestamp_column</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prepare DataFrame by ensuring the index is a DateTimeIndex, resampling to hourly frequency,
and handling missing values.</p>
<p>Parameters:
- df: DataFrame containing the data.
- timestamp_column: Name of the timestamp column to convert and set as the index.</p>
<p>Returns:
- df: DataFrame resampled to hourly frequency with missing values handled.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_datetimeindex</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">timestamp_column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare DataFrame by ensuring the index is a DateTimeIndex, resampling to hourly frequency,</span>
<span class="sd">    and handling missing values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df: DataFrame containing the data.</span>
<span class="sd">    - timestamp_column: Name of the timestamp column to convert and set as the index.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - df: DataFrame resampled to hourly frequency with missing values handled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure the timestamp column is converted to datetime if it&#39;s not already the index</span>
    <span class="k">if</span> <span class="n">timestamp_column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">timestamp_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">timestamp_column</span><span class="p">])</span>
        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">timestamp_column</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Ensure the index is a DateTimeIndex</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index must be a DateTimeIndex.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.load_csv_files_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the read_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame containing the data from the CSV files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.join_sensor_weather_visitorcenter.write_csv_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual CSV file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/join_sensor_weather_visitorcenter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual CSV file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_csv function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.visitor_center_processing_script"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_and_translate_day_of_week" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Wochentag' that represents the day of the week in German.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with updated 'Wochentag' column in German.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_and_translate_day_of_week</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Wochentag&#39; that represents the day of the week in German.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with updated &#39;Wochentag&#39; column in German.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new column &#39;Wochentag2&#39; with the day of the week in English</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Define the translation mapping from English to German</span>
    <span class="n">translation_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Monday&#39;</span><span class="p">:</span> <span class="s1">&#39;Montag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Tuesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Dienstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Wednesday&#39;</span><span class="p">:</span> <span class="s1">&#39;Mittwoch&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Thursday&#39;</span><span class="p">:</span> <span class="s1">&#39;Donnerstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Friday&#39;</span><span class="p">:</span> <span class="s1">&#39;Freitag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Saturday&#39;</span><span class="p">:</span> <span class="s1">&#39;Samstag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sunday&#39;</span><span class="p">:</span> <span class="s1">&#39;Sonntag&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Replace the English day names in the &#39;Wochentag2&#39; column with German names</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">translation_map</span><span class="p">)</span>

    <span class="c1"># Remove the &#39;Wochentag&#39; column from the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Rename &#39;Wochentag2&#39; to &#39;Wochentag&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wochentag2&#39;</span><span class="p">:</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_date_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create new columns for day, month, and year from a date column in the DataFrame.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Datum' column with date information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with additional columns for day, month, and year.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_date_variables</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create new columns for day, month, and year from a date column in the DataFrame.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Datum&#39; column with date information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with additional columns for day, month, and year.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert &#39;Datum&#39; column to datetime format</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">])</span>

    <span class="c1"># Add new columns for day, month, and year</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

    <span class="c1"># Change data types for modeling purposes</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_season_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new column 'Jahreszeit' in the DataFrame based on the month variable.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Monat' column with month information.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Jahreszeit' column representing the season.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_season_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new column &#39;Jahreszeit&#39; in the DataFrame based on the month variable.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Monat&#39; column with month information.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Jahreszeit&#39; column representing the season.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the seasons based on the month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Monat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;Frühling&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Sommer&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Herbst&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="k">else</span>
                  <span class="s1">&#39;Winter&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">else</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="p">)</span>

    <span class="c1"># Convert the &#39;Jahreszeit&#39; column to category type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Jahreszeit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.add_weekend_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new binary column 'Wochenende' indicating whether the day is a weekend.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Wochentag' column with German day names.</p>
<p>Returns:
pandas.DataFrame: DataFrame with an additional 'Wochenende' column indicating weekend status.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_weekend_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new binary column &#39;Wochenende&#39; indicating whether the day is a weekend.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Wochentag&#39; column with German day names.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with an additional &#39;Wochenende&#39; column indicating weekend status.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new binary column &#39;Wochenende&#39; where True represents weekend days (Saturday, Sunday)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochentag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Samstag&#39;</span><span class="p">,</span> <span class="s1">&#39;Sonntag&#39;</span><span class="p">])</span>

    <span class="c1"># Convert the &#39;Wochenende&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wochenende&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_schulferien" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects a typo in the 'Schulferien_Bayern' column and converts it to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Schulferien_Bayern' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with corrected 'Schulferien_Bayern' values and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_schulferien</span><span class="p">(</span><span class="n">df_visitcenters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects a typo in the &#39;Schulferien_Bayern&#39; column and converts it to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Schulferien_Bayern&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with corrected &#39;Schulferien_Bayern&#39; values and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Correct the typo in specific value for column &#39;Schulferien_Bayern&#39; (from `10` to `0`)</span>
    <span class="n">df_visitcenters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2017-04-30&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Change &#39;Schulferien_Bayern&#39; to bool type</span>
    <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_visitcenters</span><span class="p">[</span><span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_visitcenters</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_and_convert_wgm_geoeffnet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'WGM_geoeffnet' column by replacing the value 11 with 1.
Converts the column to boolean type.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'WGM_geoeffnet' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'WGM_geoeffnet' corrected and converted to boolean type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_and_convert_wgm_geoeffnet</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;WGM_geoeffnet&#39; column by replacing the value 11 with 1.</span>
<span class="sd">    Converts the column to boolean type.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;WGM_geoeffnet&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;WGM_geoeffnet&#39; corrected and converted to boolean type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Replace single value of 11 with 1 in &#39;WGM_geoeffnet&#39; column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Convert &#39;WGM_geoeffnet&#39; column to boolean type</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.correct_besuchszahlen_heh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Corrects the 'Besuchszahlen_HEH' column by rounding up values with non-zero fractional parts to the nearest whole number.
Converts the column to Int64 type to retain NaN values.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the 'Besuchszahlen_HEH' column.</p>
<p>Returns:
pandas.DataFrame: DataFrame with 'Besuchszahlen_HEH' corrected and converted to Int64 type.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_besuchszahlen_heh</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Corrects the &#39;Besuchszahlen_HEH&#39; column by rounding up values with non-zero fractional parts to the nearest whole number.</span>
<span class="sd">    Converts the column to Int64 type to retain NaN values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the &#39;Besuchszahlen_HEH&#39; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with &#39;Besuchszahlen_HEH&#39; corrected and converted to Int64 type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Apply np.ceil() to round up values with non-zero fractional parts to nearest whole number</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span>
    <span class="p">)</span>

    <span class="c1"># Convert &#39;Besuchszahlen_HEH&#39; to Int64 to retain NaN values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.create_hourly_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing daily data with a 'Datum' column representing dates.</p>
<p>Returns:
pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_hourly_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands the daily data in the DataFrame to an hourly level by duplicating each day into 24 hourly rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing daily data with a &#39;Datum&#39; column representing dates.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: New DataFrame with an hourly level where each day is expanded into 24 hourly rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a new DataFrame where each day is expanded into 24 rows (one per hour)</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">24</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Create the hourly timestamps by adding hours to the &#39;Datum&#39; column</span>
    <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">cumcount</span><span class="p">(),</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

    <span class="c1"># Rename columns for clarity</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df_hourly</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.detect_outliers_std" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect outliers in a specific column of the DataFrame using the standard deviation method.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the column to check.
column (str): Name of the column to check for outliers.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">detect_outliers_std</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect outliers in a specific column of the DataFrame using the standard deviation method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the column to check.</span>
<span class="sd">    column (str): Name of the column to check for outliers.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame containing rows with outliers in the specified column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="c1"># Define the bounds for outliers</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>

    <span class="c1"># Identify outliers</span>
    <span class="n">outliers_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">outliers_mask</span><span class="p">][[</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.handle_outliers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Detect and handle outliers for a list of columns by replacing them with NaN.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing the columns to check.
num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</p>
<p>Returns:
pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_sd</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect and handle outliers for a list of columns by replacing them with NaN.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing the columns to check.</span>
<span class="sd">    num_sd (int): Number of standard deviations to define the outlier bounds (default is 7).</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with outliers replaced by NaN in the specified columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">]</span>

    <span class="c1">#outliers = {}</span>

    <span class="c1"># Detect outliers and store in dictionary</span>
    <span class="c1">#for column in columns:</span>
        <span class="c1">#outliers[column] = detect_outliers_std(df, column, num_sd)</span>

    <span class="c1"># Handle outliers by replacing with NaN</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">std_dev</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_sd</span> <span class="o">*</span> <span class="n">std_dev</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">),</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.remove_last_row_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Removes the last row from the DataFrame if it has 2923 rows.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame to be checked and modified.</p>
<p>Returns:
pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_last_row_if_needed</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes the last row from the DataFrame if it has 2923 rows.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame to be checked and modified.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: Updated DataFrame with the last row removed if the initial length was 2923.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the DataFrame has exactly 2923 rows</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2923</span><span class="p">:</span>
        <span class="c1"># Drop the last row</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.rename_and_set_time_as_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Rename columns, convert 'time' column to datetime, and set 'time' as the index.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame containing data with a 'Datum' column to be renamed and converted.</p>
<p>Returns:
pandas.DataFrame: The cleaned DataFrame with 'Datum' renamed to 'time', converted to datetime, and 'time' set as index.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rename_and_set_time_as_index</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rename columns, convert &#39;time&#39; column to datetime, and set &#39;time&#39; as the index.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame containing data with a &#39;Datum&#39; column to be renamed and converted.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: The cleaned DataFrame with &#39;Datum&#39; renamed to &#39;time&#39;, converted to datetime, and &#39;time&#39; set as index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rename &#39;Datum&#39; column to &#39;time&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Datum&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Convert &#39;time&#39; column to datetime</span>
    <span class="c1">#df[&#39;time&#39;] = pd.to_datetime(df[&#39;time&#39;])</span>

    <span class="c1"># Set &#39;time&#39; column as index</span>
    <span class="c1">#df.set_index(&#39;time&#39;, inplace=True)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.reorder_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reorder columns in the DataFrame to place date-related variables together.</p>
<p>Parameters:
df (pandas.DataFrame): DataFrame with various columns including date-related variables.</p>
<p>Returns:
pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reorder columns in the DataFrame to place date-related variables together.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): DataFrame with various columns including date-related variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">    pandas.DataFrame: DataFrame with columns reordered to place date-related variables next to each other.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the desired order of columns</span>
    <span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;Monat&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahr&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochentag&#39;</span><span class="p">,</span> <span class="s1">&#39;Wochenende&#39;</span><span class="p">,</span> <span class="s1">&#39;Jahreszeit&#39;</span><span class="p">,</span> <span class="s1">&#39;Laubfärbung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Besuchszahlen_HEH&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_HZW&#39;</span><span class="p">,</span> <span class="s1">&#39;Besuchszahlen_WGM&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Parkpl_HEH_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HEH_BUS&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_PKW&#39;</span><span class="p">,</span> <span class="s1">&#39;Parkpl_HZW_BUS&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Schulferien_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Schulferien_CZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Feiertag_CZ&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;HEH_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;HZW_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;WGM_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Lusenschutzhaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Racheldiensthuette_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Waldschmidthaus_geoeffnet&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Falkensteinschutzhaus_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Schwellhaeusl_geoeffnet&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperatur&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Niederschlagsmenge&#39;</span><span class="p">,</span> <span class="s1">&#39;Schneehoehe&#39;</span><span class="p">,</span> <span class="s1">&#39;GS mit&#39;</span><span class="p">,</span> <span class="s1">&#39;GS max&#39;</span>
    <span class="p">]</span>

    <span class="c1"># Reorder columns in the DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.source_data_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.
Args:
    path (str): The path to the CSV files on AWS S3.
    **kwargs: Additional arguments to pass to the read_csv function.
Returns:
    pd.DataFrame: The DataFrame containing the data from the CSV files.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_data_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.visitor_center_processing_script.write_parquet_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual Parquet file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the Parquet files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_parquet function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/visitor_center_processing_script.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_parquet_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual Parquet file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the Parquet files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_parquet function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame successfully written to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to write DataFrame to S3. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing"></a>
    <div class="doc doc-contents first">

        <p>Weather Data Sourcing</p>
<p>This script retrieves hourly weather data (Precipitation, Temperature, Wind Speed, Relative Humidity, and Sunshine Duration) for the Bavarian Forest region from the Meteostat API, and saves the processed data to a CSV file.</p>
<p>Usage:
- To run this script, simply execute it using Python:
  $ python src/weather_data_sourcing_and_processing.py
- The script will automatically fetch weather data for the specified date range, process it, and save it to a CSV file.
- Please change the AWS credentials, global variables (start and end time, latitude, and longitude), and the S3 bucket and folder name before running the script.</p>
<p>Output:
- The sourced and processed weather data is saved as '/sourced_weather_data_2016-24_non_imputed.csv' and '/processed_weather_data_2016-24_imputed.csv' in the 'preprocessed_data' folder 
    in the 'dssgx-munich-2024-bavarian-forest' AWS S3 bucket.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.get_hourly_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hourly_data</span><span class="p">(</span><span class="n">region</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetch hourly weather data for a specified region and date range.</p>
<p>This function retrieves hourly weather data from the Meteostat API or another defined source,
returning it as a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>region</code></td>
            <td>
                  <code><span title="meteostat.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>Point</code> object representing the geographical location (latitude, longitude).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>start_date</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start date for data retrieval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_date</code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end date for data retrieval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing hourly weather data with the following columns:
- time: Datetime of the record.
- temp: Temperature in degrees Celsius.
- dwpt: Dew point in degrees Celsius.
- prcp: Precipitation in millimeters.
- wdir: Wind direction in degrees.
- wspd: Wind speed in km/h.
- wpgt: Wind gust in km/h.
- pres: Sea-level air pressure in hPa.
- tsun: Sunshine duration in minutes.
- snow: Snowfall in millimeters.
- rhum: Relative humidity in percent.
- coco: Weather condition code.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_hourly_data</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch hourly weather data for a specified region and date range.</span>

<span class="sd">    This function retrieves hourly weather data from the Meteostat API or another defined source,</span>
<span class="sd">    returning it as a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (Point): A `Point` object representing the geographical location (latitude, longitude).</span>
<span class="sd">        start_date (datetime): The start date for data retrieval.</span>
<span class="sd">        end_date (datetime): The end date for data retrieval.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing hourly weather data with the following columns:</span>
<span class="sd">            - time: Datetime of the record.</span>
<span class="sd">            - temp: Temperature in degrees Celsius.</span>
<span class="sd">            - dwpt: Dew point in degrees Celsius.</span>
<span class="sd">            - prcp: Precipitation in millimeters.</span>
<span class="sd">            - wdir: Wind direction in degrees.</span>
<span class="sd">            - wspd: Wind speed in km/h.</span>
<span class="sd">            - wpgt: Wind gust in km/h.</span>
<span class="sd">            - pres: Sea-level air pressure in hPa.</span>
<span class="sd">            - tsun: Sunshine duration in minutes.</span>
<span class="sd">            - snow: Snowfall in millimeters.</span>
<span class="sd">            - rhum: Relative humidity in percent.</span>
<span class="sd">            - coco: Weather condition code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fetch hourly data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Hourly</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">START_TIME</span><span class="p">,</span> <span class="n">END_TIME</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>

    <span class="c1"># Reset the index</span>
    <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.load_csv_files_from_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Loads individual or multiple CSV files from an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the read_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The DataFrame containing the data from the CSV files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv_files_from_aws_s3</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads individual or multiple CSV files from an AWS S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the read_csv function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The DataFrame containing the data from the CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.process_hourly_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_hourly_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process raw hourly weather data by cleaning and formatting.</p>
<p>This function drops unnecessary columns, renames the remaining columns to more descriptive names,
and converts the 'time' column to a datetime format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing raw hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: A DataFrame containing the processed hourly weather data with the following columns:
- Time: Datetime of the record.
- Temperature (°C): Temperature in degrees Celsius.
- Precipitation (mm): Precipitation in millimeters.
- Wind Speed (km/h): Wind speed in km/h.
- Sunshine Duration (min): Duration of sunshine in minutes.
- Relative Humidity (%): Relative humidity in percent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_hourly_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process raw hourly weather data by cleaning and formatting.</span>

<span class="sd">    This function drops unnecessary columns, renames the remaining columns to more descriptive names,</span>
<span class="sd">    and converts the &#39;time&#39; column to a datetime format.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): A DataFrame containing raw hourly weather data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing the processed hourly weather data with the following columns:</span>
<span class="sd">            - Time: Datetime of the record.</span>
<span class="sd">            - Temperature (°C): Temperature in degrees Celsius.</span>
<span class="sd">            - Precipitation (mm): Precipitation in millimeters.</span>
<span class="sd">            - Wind Speed (km/h): Wind speed in km/h.</span>
<span class="sd">            - Sunshine Duration (min): Duration of sunshine in minutes.</span>
<span class="sd">            - Relative Humidity (%): Relative humidity in percent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Drop unnecessary columns</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dwpt&#39;</span><span class="p">,</span> <span class="s1">&#39;snow&#39;</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">,</span> <span class="s1">&#39;wpgt&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="s1">&#39;coco&#39;</span><span class="p">])</span>

    <span class="c1"># Rename columns for clarity</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;prcp&#39;</span><span class="p">:</span> <span class="s1">&#39;Precipitation (mm)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;wspd&#39;</span><span class="p">:</span> <span class="s1">&#39;Wind Speed (km/h)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;tsun&#39;</span><span class="p">:</span> <span class="s1">&#39;Sunshine Duration (min)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rhum&#39;</span><span class="p">:</span> <span class="s1">&#39;Relative Humidity (%)&#39;</span>
    <span class="p">})</span>

    <span class="c1"># Convert the &#39;Time&#39; column to datetime format</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.save_data_to_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_data_to_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save processed weather data to a CSV file.</p>
<p>This function saves the processed DataFrame to a specified directory. If the directory does not exist,
it will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DataFrame containing the processed hourly weather data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory path where the CSV file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_data_to_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">save_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save processed weather data to a CSV file.</span>

<span class="sd">    This function saves the processed DataFrame to a specified directory. If the directory does not exist,</span>
<span class="sd">    it will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): A DataFrame containing the processed hourly weather data.</span>
<span class="sd">        save_path (str): The directory path where the CSV file will be saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create the directory if it doesn&#39;t exist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Save the data to CSV</span>
    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data saved successfully!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.source_and_process_weather_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_and_process_weather_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data
for the specified time period, processes the data to extract necessary weather parameters,
and saves the processed data to a CSV file.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source_and_process_weather_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a point over the Bavarian Forest National Park, retrieves hourly weather data</span>
<span class="sd">    for the specified time period, processes the data to extract necessary weather parameters,</span>
<span class="sd">    and saves the processed data to a CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a Point object for the Bavarian Forest National Park entry</span>
    <span class="n">bavarian_forest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">LATITUDE</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">LONGITUDE</span><span class="p">)</span>

    <span class="c1"># Fetch hourly data for the location</span>
    <span class="n">hourly_data</span> <span class="o">=</span> <span class="n">get_hourly_data</span><span class="p">(</span><span class="n">bavarian_forest</span><span class="p">)</span>

    <span class="c1"># Process the hourly data to extract and format necessary weather parameters</span>
    <span class="n">sourced_hourly_data</span> <span class="o">=</span> <span class="n">process_hourly_data</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>

    <span class="c1"># # Uncomment the following line to save the sourced data to a CSV file</span>

    <span class="c1"># # Save the processed data to a CSV file</span>
    <span class="c1"># save_data_to_csv(sourced_hourly_data, &#39;outputs/weather_data_final/weather_data_2016-24_non_imputed_forecasted.csv&#39;)</span>

    <span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">sourced_hourly_data</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">preprocessed_data_folder</span><span class="si">}</span><span class="s2">/sourced_weather_data_2016-24_forecasted_non_imputed.csv&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sourced hourly data saved successfully to AWS S3!&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing the sourced hourly data...&quot;</span><span class="p">)</span>

    <span class="n">load_sourced_weather_data</span> <span class="o">=</span> <span class="n">load_csv_files_from_aws_s3</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">preprocessed_data_folder</span><span class="si">}</span><span class="s2">/sourced_weather_data_2016-24_forecasted_non_imputed.csv&quot;</span><span class="p">,</span><span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get the list of columns to process</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">load_sourced_weather_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

    <span class="c1"># Fill missing values in the weather data</span>
    <span class="n">imputed_data</span> <span class="o">=</span> <span class="n">fill_missing_values</span><span class="p">(</span><span class="n">load_sourced_weather_data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">imputed_data</span>

    <span class="c1"># # Uncomment the following line to save the processed data to a CSV file</span>
    <span class="c1"># # Save the processed data to a CSV file</span>
    <span class="c1"># save_data_to_csv(imputed_data, &#39;outputs/weather_data_final/processed_weather_data_2016-24_forecasted_imputed.csv&#39;)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;write_csv_file_to_aws_s3(</span>
<span class="sd">    df=imputed_data,</span>
<span class="sd">    path=f&quot;s3://{bucket}/{preprocessed_data_folder}/processed_weather_data_2016-24_forecasted_imputed.csv&quot;,)&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.pre_processing.weather_data_sourcing_and_processing.write_csv_file_to_aws_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Writes an individual CSV file to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CSV files on AWS S3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the to_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/pre_processing/weather_data_sourcing_and_processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_csv_file_to_aws_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                             <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes an individual CSV file to AWS S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to write.</span>
<span class="sd">        path (str): The path to the CSV files on AWS S3.</span>
<span class="sd">        **kwargs: Additional arguments to pass to the to_csv function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wr</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- Sourcing Data -->



<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_historic_parking_data"></a>
    <div class="doc doc-contents first">

        <p>This script fetches historical parking data from the BayernCloud API for the parking sensors in the Bavarian Forest National Park.</p>
<p>The script fetches historical data for the following types of data:
- Occupancy
- Occupancy rate
- Capacity</p>
<p>The script fetches historical data for the following parking sensors:
- parkplatz-graupsaege-1
- p-r-spiegelau-1
- parkplatz-zwieslerwaldhaus-1
- parkplatz-zwieslerwaldhaus-nord-1
- parkplatz-nationalparkzentrum-falkenstein-2
- scheidt-bachmann-parkplatz-1
- parkplatz-nationalparkzentrum-lusen-p2
- parkplatz-waldhaeuser-kirche-1
- parkplatz-waldhaeuser-ausblick-1
- parkplatz-skisportzentrum-finsterau-1</p>
<p>To run the script, you need to set the Bayern Cloud API key as an environment variable named 'BAYERN_CLOUD_API_KEY' and run the script using the following command:</p>
<pre><code>python src/source_historic_parking_data.py

</code></pre>
<p>Output:
- The script saves the historical parking data for each location as a CSV file in the 'outputs/parking_data_final/' directory.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_historical_data_for_location</span><span class="p">(</span><span class="n">location_id</span><span class="p">,</span> <span class="n">location_slug</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">api_endpoint_suffix</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">save_file_path</span><span class="o">=</span><span class="s1">&#39;outputs&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fetch historical data from the BayernCloud API and save it as a CSV file.</p>
<h4 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.get_historical_data_for_location--parameters">Parameters:</h4>
<p>location_id : str
    The ID of the location for which the data is to be fetched.
location_slug : str
    A slug (a URL-friendly string) representing the location.
data_type : str
    The type of data being fetched (e.g., 'occupancy', 'occupancy_rate', 'capacity').
api_endpoint_suffix : str
    The specific suffix of the API endpoint for the data type (e.g., 'dcls_occupancy', 'dcls_occupancy_rate').
column_name : str
    The name of the column to store the fetched data in the DataFrame.
save_file_path : str, optional
    The base directory where the CSV file will be saved (default is 'outputs').</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_historic_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_historical_data_for_location</span><span class="p">(</span>
    <span class="n">location_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">location_slug</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_endpoint_suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">save_file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;outputs&#39;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch historical data from the BayernCloud API and save it as a CSV file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    location_id : str</span>
<span class="sd">        The ID of the location for which the data is to be fetched.</span>
<span class="sd">    location_slug : str</span>
<span class="sd">        A slug (a URL-friendly string) representing the location.</span>
<span class="sd">    data_type : str</span>
<span class="sd">        The type of data being fetched (e.g., &#39;occupancy&#39;, &#39;occupancy_rate&#39;, &#39;capacity&#39;).</span>
<span class="sd">    api_endpoint_suffix : str</span>
<span class="sd">        The specific suffix of the API endpoint for the data type (e.g., &#39;dcls_occupancy&#39;, &#39;dcls_occupancy_rate&#39;).</span>
<span class="sd">    column_name : str</span>
<span class="sd">        The name of the column to store the fetched data in the DataFrame.</span>
<span class="sd">    save_file_path : str, optional</span>
<span class="sd">        The base directory where the CSV file will be saved (default is &#39;outputs&#39;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Construct the API endpoint URL</span>
    <span class="n">API_endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://data.bayerncloud.digital/api/v4/things/</span><span class="si">{</span><span class="n">location_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">api_endpoint_suffix</span><span class="si">}</span><span class="s1">/&#39;</span>

    <span class="c1"># Set request parameters</span>
    <span class="n">request_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">BAYERN_CLOUD_API_KEY</span>
    <span class="p">}</span>

    <span class="c1"># Send the GET request to the API</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">API_endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_params</span><span class="p">)</span>
    <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="c1"># Convert the response to a Pandas DataFrame and preprocess it</span>
    <span class="n">historical_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">response_json</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">])</span>
    <span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
    <span class="c1"># historical_df.set_index(&quot;time&quot;, inplace=True)</span>

    <span class="k">return</span> <span class="n">historical_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_all_locations</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process and fetch all types of historical data for each location in the parking sensors dictionary.</p>
<h4 id="src.prediction_pipeline.sourcing_data.source_historic_parking_data.process_all_locations--parameters">Parameters:</h4>
<p>parking_sensors : dict
    Dictionary containing location slugs as keys and location IDs as values.</p>

            <details class="quote">
              <summary>Source code in <code>src/prediction_pipeline/sourcing_data/source_historic_parking_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_all_locations</span><span class="p">(</span><span class="n">parking_sensors</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process and fetch all types of historical data for each location in the parking sensors dictionary.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    parking_sensors : dict</span>
<span class="sd">        Dictionary containing location slugs as keys and location IDs as values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;occupancy_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_occupancy_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;occupancy_rate&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;dcls_capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;capacity&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parking_sensors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">historical_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">api_suffix</span><span class="p">,</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading historical </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2"> data for location: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> with location_id: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">parking_df</span>  <span class="o">=</span> <span class="n">get_historical_data_for_location</span><span class="p">(</span>
                <span class="n">location_id</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                <span class="n">location_slug</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
                <span class="n">api_endpoint_suffix</span><span class="o">=</span><span class="n">api_suffix</span><span class="p">,</span>
                <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span>
            <span class="p">)</span>
            <span class="n">historical_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parking_df</span><span class="p">)</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">),</span> <span class="n">historical_data</span><span class="p">)</span>

        <span class="c1"># Create a filename based on the location name</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_historical_parking_data.csv&quot;</span>

        <span class="c1"># make the output directory if it doesn&#39;t exist</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved historical parking data for location: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="src.prediction_pipeline.sourcing_data.source_real_time_parking_data"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">











  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>